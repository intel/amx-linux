
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Kernel driver w1-gpio &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1-wire Slave Drivers" href="../slaves/index.html" />
    <link rel="prev" title="Kernel driver for omap HDQ/1-wire module" href="omap-hdq.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="kernel-driver-w1-gpio">
<h1>Kernel driver w1-gpio<a class="headerlink" href="#kernel-driver-w1-gpio" title="Permalink to this headline">¶</a></h1>
<p>Author: Ville Syrjala &lt;<a class="reference external" href="mailto:syrjala&#37;&#52;&#48;sci&#46;fi">syrjala<span>&#64;</span>sci<span>&#46;</span>fi</a>&gt;</p>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>GPIO 1-wire bus master driver. The driver uses the GPIO API to control the
wire and the GPIO pin can be specified using GPIO machine descriptor tables.
It is also possible to define the master using device tree, see
Documentation/devicetree/bindings/w1/w1-gpio.yaml</p>
</section>
<section id="example-mach-at91">
<h2>Example (mach-at91)<a class="headerlink" href="#example-mach-at91" title="Permalink to this headline">¶</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#include &lt;linux/gpio/machine.h&gt;
#include &lt;linux/w1-gpio.h&gt;

static struct gpiod_lookup_table foo_w1_gpiod_table = {
      .dev_id = &quot;w1-gpio&quot;,
      .table = {
              GPIO_LOOKUP_IDX(&quot;at91-gpio&quot;, AT91_PIN_PB20, NULL, 0,
                      GPIO_ACTIVE_HIGH|GPIO_OPEN_DRAIN),
      },
};

static struct w1_gpio_platform_data foo_w1_gpio_pdata = {
      .ext_pullup_enable_pin  = -EINVAL,
};

static struct platform_device foo_w1_device = {
      .name                   = &quot;w1-gpio&quot;,
      .id                     = -1,
      .dev.platform_data      = &amp;foo_w1_gpio_pdata,
};

...
      at91_set_GPIO_periph(foo_w1_gpio_pdata.pin, 1);
      at91_set_multi_drive(foo_w1_gpio_pdata.pin, 1);
      gpiod_add_lookup_table(&amp;foo_w1_gpiod_table);
      platform_device_register(&amp;foo_w1_device);
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Kernel driver w1-gpio</a><ul>
<li><a class="reference internal" href="#description">Description</a></li>
<li><a class="reference internal" href="#example-mach-at91">Example (mach-at91)</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/w1/masters/w1-gpio.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/w1/masters/w1-gpio.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>