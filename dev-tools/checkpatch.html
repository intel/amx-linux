
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Checkpatch &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Coccinelle" href="coccinelle.html" />
    <link rel="prev" title="Kernel Testing Guide" href="testing-overview.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="checkpatch">
<h1>Checkpatch<a class="headerlink" href="#checkpatch" title="Permalink to this headline">¶</a></h1>
<p>Checkpatch (scripts/checkpatch.pl) is a perl script which checks for trivial
style violations in patches and optionally corrects them.  Checkpatch can
also be run on file contexts and without the kernel tree.</p>
<p>Checkpatch is not always right. Your judgement takes precedence over checkpatch
messages.  If your code looks better with the violations, then its probably
best left alone.</p>
<section id="options">
<h2>Options<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h2>
<p>This section will describe the options checkpatch can be run with.</p>
<p>Usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>./scripts/checkpatch.pl [OPTION]... [FILE]...
</pre></div>
</div>
<p>Available options:</p>
<blockquote>
<div><ul>
<li><p>-q,  –quiet</p>
<p>Enable quiet mode.</p>
</li>
<li><p>-v,  –verbose
Enable verbose mode.  Additional verbose test descriptions are output
so as to provide information on why that particular message is shown.</p></li>
<li><p>–no-tree</p>
<p>Run checkpatch without the kernel tree.</p>
</li>
<li><p>–no-signoff</p>
<p>Disable the ‘Signed-off-by’ line check.  The sign-off is a simple line at
the end of the explanation for the patch, which certifies that you wrote it
or otherwise have the right to pass it on as an open-source patch.</p>
<p>Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Signed-off-by: Random J Developer &lt;random@developer.example.org&gt;
</pre></div>
</div>
<p>Setting this flag effectively stops a message for a missing signed-off-by
line in a patch context.</p>
</li>
<li><p>–patch</p>
<p>Treat FILE as a patch.  This is the default option and need not be
explicitly specified.</p>
</li>
<li><p>–emacs</p>
<p>Set output to emacs compile window format.  This allows emacs users to jump
from the error in the compile window directly to the offending line in the
patch.</p>
</li>
<li><p>–terse</p>
<p>Output only one line per report.</p>
</li>
<li><p>–showfile</p>
<p>Show the diffed file position instead of the input file position.</p>
</li>
<li><p>-g,  –git</p>
<p>Treat FILE as a single commit or a git revision range.</p>
<p>Single commit with:</p>
<ul class="simple">
<li><p>&lt;rev&gt;</p></li>
<li><p>&lt;rev&gt;^</p></li>
<li><p>&lt;rev&gt;~n</p></li>
</ul>
<p>Multiple commits with:</p>
<ul class="simple">
<li><p>&lt;rev1&gt;..&lt;rev2&gt;</p></li>
<li><p>&lt;rev1&gt;…&lt;rev2&gt;</p></li>
<li><p>&lt;rev&gt;-&lt;count&gt;</p></li>
</ul>
</li>
<li><p>-f,  –file</p>
<p>Treat FILE as a regular source file.  This option must be used when running
checkpatch on source files in the kernel.</p>
</li>
<li><p>–subjective,  –strict</p>
<p>Enable stricter tests in checkpatch.  By default the tests emitted as CHECK
do not activate by default.  Use this flag to activate the CHECK tests.</p>
</li>
<li><p>–list-types</p>
<p>Every message emitted by checkpatch has an associated TYPE.  Add this flag
to display all the types in checkpatch.</p>
<p>Note that when this flag is active, checkpatch does not read the input FILE,
and no message is emitted.  Only a list of types in checkpatch is output.</p>
</li>
<li><p>–types TYPE(,TYPE2…)</p>
<p>Only display messages with the given types.</p>
<p>Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>./scripts/checkpatch.pl mypatch.patch --types EMAIL_SUBJECT,BRACES
</pre></div>
</div>
</li>
<li><p>–ignore TYPE(,TYPE2…)</p>
<p>Checkpatch will not emit messages for the specified types.</p>
<p>Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>./scripts/checkpatch.pl mypatch.patch --ignore EMAIL_SUBJECT,BRACES
</pre></div>
</div>
</li>
<li><p>–show-types</p>
<p>By default checkpatch doesn’t display the type associated with the messages.
Set this flag to show the message type in the output.</p>
</li>
<li><p>–max-line-length=n</p>
<p>Set the max line length (default 100).  If a line exceeds the specified
length, a LONG_LINE message is emitted.</p>
<p>The message level is different for patch and file contexts.  For patches,
a WARNING is emitted.  While a milder CHECK is emitted for files.  So for
file contexts, the –strict flag must also be enabled.</p>
</li>
<li><p>–min-conf-desc-length=n</p>
<p>Set the Kconfig entry minimum description length, if shorter, warn.</p>
</li>
<li><p>–tab-size=n</p>
<p>Set the number of spaces for tab (default 8).</p>
</li>
<li><p>–root=PATH</p>
<p>PATH to the kernel tree root.</p>
<p>This option must be specified when invoking checkpatch from outside
the kernel root.</p>
</li>
<li><p>–no-summary</p>
<p>Suppress the per file summary.</p>
</li>
<li><p>–mailback</p>
<p>Only produce a report in case of Warnings or Errors.  Milder Checks are
excluded from this.</p>
</li>
<li><p>–summary-file</p>
<p>Include the filename in summary.</p>
</li>
<li><p>–debug KEY=[0|1]</p>
<p>Turn on/off debugging of KEY, where KEY is one of ‘values’, ‘possible’,
‘type’, and ‘attr’ (default is all off).</p>
</li>
<li><p>–fix</p>
<p>This is an EXPERIMENTAL feature.  If correctable errors exists, a file
&lt;inputfile&gt;.EXPERIMENTAL-checkpatch-fixes is created which has the
automatically fixable errors corrected.</p>
</li>
<li><p>–fix-inplace</p>
<p>EXPERIMENTAL - Similar to –fix but input file is overwritten with fixes.</p>
<p>DO NOT USE this flag unless you are absolutely sure and you have a backup
in place.</p>
</li>
<li><p>–ignore-perl-version</p>
<p>Override checking of perl version.  Runtime errors maybe encountered after
enabling this flag if the perl version does not meet the minimum specified.</p>
</li>
<li><p>–codespell</p>
<p>Use the codespell dictionary for checking spelling errors.</p>
</li>
<li><p>–codespellfile</p>
<p>Use the specified codespell file.
Default is ‘/usr/share/codespell/dictionary.txt’.</p>
</li>
<li><p>–typedefsfile</p>
<p>Read additional types from this file.</p>
</li>
<li><p>–color[=WHEN]</p>
<p>Use colors ‘always’, ‘never’, or only when output is a terminal (‘auto’).
Default is ‘auto’.</p>
</li>
<li><p>–kconfig-prefix=WORD</p>
<p>Use WORD as a prefix for Kconfig symbols (default is <cite>CONFIG_</cite>).</p>
</li>
<li><p>-h, –help, –version</p>
<p>Display the help text.</p>
</li>
</ul>
</div></blockquote>
</section>
<section id="message-levels">
<h2>Message Levels<a class="headerlink" href="#message-levels" title="Permalink to this headline">¶</a></h2>
<p>Messages in checkpatch are divided into three levels. The levels of messages
in checkpatch denote the severity of the error. They are:</p>
<blockquote>
<div><ul>
<li><p>ERROR</p>
<p>This is the most strict level.  Messages of type ERROR must be taken
seriously as they denote things that are very likely to be wrong.</p>
</li>
<li><p>WARNING</p>
<p>This is the next stricter level.  Messages of type WARNING requires a
more careful review.  But it is milder than an ERROR.</p>
</li>
<li><p>CHECK</p>
<p>This is the mildest level.  These are things which may require some thought.</p>
</li>
</ul>
</div></blockquote>
</section>
<section id="type-descriptions">
<h2>Type Descriptions<a class="headerlink" href="#type-descriptions" title="Permalink to this headline">¶</a></h2>
<p>This section contains a description of all the message types in checkpatch.</p>
<section id="allocation-style">
<h3>Allocation style<a class="headerlink" href="#allocation-style" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><dl>
<dt><strong>ALLOC_ARRAY_ARGS</strong></dt><dd><p>The first argument for kcalloc or kmalloc_array should be the
number of elements.  sizeof() as the first argument is generally
wrong.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/core-api/memory-allocation.html">https://www.kernel.org/doc/html/latest/core-api/memory-allocation.html</a></p>
</dd>
<dt><strong>ALLOC_SIZEOF_STRUCT</strong></dt><dd><p>The allocation style is bad.  In general for family of
allocation functions using sizeof() to get memory size,
constructs like:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>p = alloc(sizeof(struct foo), ...)
</pre></div>
</div>
<p>should be:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>p = alloc(sizeof(*p), ...)
</pre></div>
</div>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/coding-style.html#allocating-memory">https://www.kernel.org/doc/html/latest/process/coding-style.html#allocating-memory</a></p>
</dd>
<dt><strong>ALLOC_WITH_MULTIPLY</strong></dt><dd><p>Prefer kmalloc_array/kcalloc over kmalloc/kzalloc with a
sizeof multiply.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/core-api/memory-allocation.html">https://www.kernel.org/doc/html/latest/core-api/memory-allocation.html</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="api-usage">
<h3>API usage<a class="headerlink" href="#api-usage" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><dl>
<dt><strong>ARCH_DEFINES</strong></dt><dd><p>Architecture specific defines should be avoided wherever
possible.</p>
</dd>
<dt><strong>ARCH_INCLUDE_LINUX</strong></dt><dd><p>Whenever asm/file.h is included and linux/file.h exists, a
conversion can be made when linux/file.h includes asm/file.h.
However this is not always the case (See signal.h).
This message type is emitted only for includes from arch/.</p>
</dd>
<dt><strong>AVOID_BUG</strong></dt><dd><p>BUG() or BUG_ON() should be avoided totally.
Use WARN() and WARN_ON() instead, and handle the “impossible”
error condition as gracefully as possible.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/deprecated.html#bug-and-bug-on">https://www.kernel.org/doc/html/latest/process/deprecated.html#bug-and-bug-on</a></p>
</dd>
<dt><strong>CONSIDER_KSTRTO</strong></dt><dd><p>The <a class="reference internal" href="../core-api/kernel-api.html#c.simple_strtol" title="simple_strtol"><code class="xref c c-func docutils literal notranslate"><span class="pre">simple_strtol()</span></code></a>, <a class="reference internal" href="../core-api/kernel-api.html#c.simple_strtoll" title="simple_strtoll"><code class="xref c c-func docutils literal notranslate"><span class="pre">simple_strtoll()</span></code></a>, <a class="reference internal" href="../core-api/kernel-api.html#c.simple_strtoul" title="simple_strtoul"><code class="xref c c-func docutils literal notranslate"><span class="pre">simple_strtoul()</span></code></a>, and
<a class="reference internal" href="../core-api/kernel-api.html#c.simple_strtoull" title="simple_strtoull"><code class="xref c c-func docutils literal notranslate"><span class="pre">simple_strtoull()</span></code></a> functions explicitly ignore overflows, which
may lead to unexpected results in callers.  The respective <a class="reference internal" href="../core-api/kernel-api.html#c.kstrtol" title="kstrtol"><code class="xref c c-func docutils literal notranslate"><span class="pre">kstrtol()</span></code></a>,
<a class="reference internal" href="../core-api/kernel-api.html#c.kstrtoll" title="kstrtoll"><code class="xref c c-func docutils literal notranslate"><span class="pre">kstrtoll()</span></code></a>, <a class="reference internal" href="../core-api/kernel-api.html#c.kstrtoul" title="kstrtoul"><code class="xref c c-func docutils literal notranslate"><span class="pre">kstrtoul()</span></code></a>, and <a class="reference internal" href="../core-api/kernel-api.html#c.kstrtoull" title="kstrtoull"><code class="xref c c-func docutils literal notranslate"><span class="pre">kstrtoull()</span></code></a> functions tend to be the
correct replacements.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/deprecated.html#simple-strtol-simple-strtoll-simple-strtoul-simple-strtoull">https://www.kernel.org/doc/html/latest/process/deprecated.html#simple-strtol-simple-strtoll-simple-strtoul-simple-strtoull</a></p>
</dd>
<dt><strong>CONSTANT_CONVERSION</strong></dt><dd><p>Use of __constant_&lt;foo&gt; form is discouraged for the following functions:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>__constant_cpu_to_be[x]
__constant_cpu_to_le[x]
__constant_be[x]_to_cpu
__constant_le[x]_to_cpu
__constant_htons
__constant_ntohs
</pre></div>
</div>
<p>Using any of these outside of include/uapi/ is not preferred as using the
function without __constant_ is identical when the argument is a
constant.</p>
<p>In big endian systems, the macros like __constant_cpu_to_be32(x) and
cpu_to_be32(x) expand to the same expression:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#define __constant_cpu_to_be32(x) ((__force __be32)(__u32)(x))
#define __cpu_to_be32(x)          ((__force __be32)(__u32)(x))
</pre></div>
</div>
<p>In little endian systems, the macros __constant_cpu_to_be32(x) and
cpu_to_be32(x) expand to __constant_swab32 and __swab32.  __swab32
has a __builtin_constant_p check:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#define __swab32(x)                               \
  (__builtin_constant_p((__u32)(x)) ?     \
  ___constant_swab32(x) :                 \
  __fswab32(x))
</pre></div>
</div>
<p>So ultimately they have a special case for constants.
Similar is the case with all of the macros in the list.  Thus
using the __constant_… forms are unnecessarily verbose and
not preferred outside of include/uapi.</p>
<p>See: <a class="reference external" href="https://lore.kernel.org/lkml/1400106425.12666.6.camel&#64;joe-AO725/">https://lore.kernel.org/lkml/1400106425.12666.6.camel&#64;joe-AO725/</a></p>
</dd>
<dt><strong>DEPRECATED_API</strong></dt><dd><p>Usage of a deprecated RCU API is detected.  It is recommended to replace
old flavourful RCU APIs by their new vanilla-RCU counterparts.</p>
<p>The full list of available RCU APIs can be viewed from the kernel docs.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/RCU/whatisRCU.html#full-list-of-rcu-apis">https://www.kernel.org/doc/html/latest/RCU/whatisRCU.html#full-list-of-rcu-apis</a></p>
</dd>
<dt><strong>DEPRECATED_VARIABLE</strong></dt><dd><p>EXTRA_{A,C,CPP,LD}FLAGS are deprecated and should be replaced by the new
flags added via commit f77bf01425b1 (“kbuild: introduce ccflags-y,
asflags-y and ldflags-y”).</p>
<p>The following conversion scheme maybe used:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>EXTRA_AFLAGS    -&gt;  asflags-y
EXTRA_CFLAGS    -&gt;  ccflags-y
EXTRA_CPPFLAGS  -&gt;  cppflags-y
EXTRA_LDFLAGS   -&gt;  ldflags-y
</pre></div>
</div>
<p>See:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><a class="reference external" href="https://lore.kernel.org/lkml/20070930191054.GA15876&#64;uranus.ravnborg.org/">https://lore.kernel.org/lkml/20070930191054.GA15876&#64;uranus.ravnborg.org/</a></p></li>
<li><p><a class="reference external" href="https://lore.kernel.org/lkml/1313384834-24433-12-git-send-email-lacombar&#64;gmail.com/">https://lore.kernel.org/lkml/1313384834-24433-12-git-send-email-lacombar&#64;gmail.com/</a></p></li>
<li><p><a class="reference external" href="https://www.kernel.org/doc/html/latest/kbuild/makefiles.html#compilation-flags">https://www.kernel.org/doc/html/latest/kbuild/makefiles.html#compilation-flags</a></p></li>
</ol>
</div></blockquote>
</dd>
<dt><strong>DEVICE_ATTR_FUNCTIONS</strong></dt><dd><p>The function names used in DEVICE_ATTR is unusual.
Typically, the store and show functions are used with &lt;attr&gt;_store and
&lt;attr&gt;_show, where &lt;attr&gt; is a named attribute variable of the device.</p>
<p>Consider the following examples:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>static DEVICE_ATTR(type, 0444, type_show, NULL);
static DEVICE_ATTR(power, 0644, power_show, power_store);
</pre></div>
</div>
<p>The function names should preferably follow the above pattern.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/driver-api/driver-model/device.html#attributes">https://www.kernel.org/doc/html/latest/driver-api/driver-model/device.html#attributes</a></p>
</dd>
<dt><strong>DEVICE_ATTR_RO</strong></dt><dd><p>The DEVICE_ATTR_RO(name) helper macro can be used instead of
DEVICE_ATTR(name, 0444, name_show, NULL);</p>
<p>Note that the macro automatically appends _show to the named
attribute variable of the device for the show method.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/driver-api/driver-model/device.html#attributes">https://www.kernel.org/doc/html/latest/driver-api/driver-model/device.html#attributes</a></p>
</dd>
<dt><strong>DEVICE_ATTR_RW</strong></dt><dd><p>The DEVICE_ATTR_RW(name) helper macro can be used instead of
DEVICE_ATTR(name, 0644, name_show, name_store);</p>
<p>Note that the macro automatically appends _show and _store to the
named attribute variable of the device for the show and store methods.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/driver-api/driver-model/device.html#attributes">https://www.kernel.org/doc/html/latest/driver-api/driver-model/device.html#attributes</a></p>
</dd>
<dt><strong>DEVICE_ATTR_WO</strong></dt><dd><p>The DEVICE_AATR_WO(name) helper macro can be used instead of
DEVICE_ATTR(name, 0200, NULL, name_store);</p>
<p>Note that the macro automatically appends _store to the
named attribute variable of the device for the store method.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/driver-api/driver-model/device.html#attributes">https://www.kernel.org/doc/html/latest/driver-api/driver-model/device.html#attributes</a></p>
</dd>
<dt><strong>DUPLICATED_SYSCTL_CONST</strong></dt><dd><p>Commit d91bff3011cf (“proc/sysctl: add shared variables for range
check”) added some shared const variables to be used instead of a local
copy in each source file.</p>
<p>Consider replacing the sysctl range checking value with the shared
one in include/linux/sysctl.h.  The following conversion scheme may
be used:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&amp;zero     -&gt;  SYSCTL_ZERO
&amp;one      -&gt;  SYSCTL_ONE
&amp;int_max  -&gt;  SYSCTL_INT_MAX
</pre></div>
</div>
<p>See:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><a class="reference external" href="https://lore.kernel.org/lkml/20190430180111.10688-1-mcroce&#64;redhat.com/">https://lore.kernel.org/lkml/20190430180111.10688-1-mcroce&#64;redhat.com/</a></p></li>
<li><p><a class="reference external" href="https://lore.kernel.org/lkml/20190531131422.14970-1-mcroce&#64;redhat.com/">https://lore.kernel.org/lkml/20190531131422.14970-1-mcroce&#64;redhat.com/</a></p></li>
</ol>
</div></blockquote>
</dd>
<dt><strong>ENOSYS</strong></dt><dd><p>ENOSYS means that a nonexistent system call was called.
Earlier, it was wrongly used for things like invalid operations on
otherwise valid syscalls.  This should be avoided in new code.</p>
<p>See: <a class="reference external" href="https://lore.kernel.org/lkml/5eb299021dec23c1a48fa7d9f2c8b794e967766d.1408730669.git.luto&#64;amacapital.net/">https://lore.kernel.org/lkml/5eb299021dec23c1a48fa7d9f2c8b794e967766d.1408730669.git.luto&#64;amacapital.net/</a></p>
</dd>
<dt><strong>ENOTSUPP</strong></dt><dd><p>ENOTSUPP is not a standard error code and should be avoided in new patches.
EOPNOTSUPP should be used instead.</p>
<p>See: <a class="reference external" href="https://lore.kernel.org/netdev/20200510182252.GA411829&#64;lunn.ch/">https://lore.kernel.org/netdev/20200510182252.GA411829&#64;lunn.ch/</a></p>
</dd>
<dt><strong>EXPORT_SYMBOL</strong></dt><dd><p>EXPORT_SYMBOL should immediately follow the symbol to be exported.</p>
</dd>
<dt><strong>IN_ATOMIC</strong></dt><dd><p>in_atomic() is not for driver use so any such use is reported as an ERROR.
Also in_atomic() is often used to determine if sleeping is permitted,
but it is not reliable in this use model.  Therefore its use is
strongly discouraged.</p>
<p>However, in_atomic() is ok for core kernel use.</p>
<p>See: <a class="reference external" href="https://lore.kernel.org/lkml/20080320201723.b87b3732.akpm&#64;linux-foundation.org/">https://lore.kernel.org/lkml/20080320201723.b87b3732.akpm&#64;linux-foundation.org/</a></p>
</dd>
<dt><strong>LOCKDEP</strong></dt><dd><p>The lockdep_no_validate class was added as a temporary measure to
prevent warnings on conversion of device-&gt;sem to device-&gt;mutex.
It should not be used for any other purpose.</p>
<p>See: <a class="reference external" href="https://lore.kernel.org/lkml/1268959062.9440.467.camel&#64;laptop/">https://lore.kernel.org/lkml/1268959062.9440.467.camel&#64;laptop/</a></p>
</dd>
<dt><strong>MALFORMED_INCLUDE</strong></dt><dd><p>The #include statement has a malformed path.  This has happened
because the author has included a double slash “//” in the pathname
accidentally.</p>
</dd>
<dt><strong>USE_LOCKDEP</strong></dt><dd><p>lockdep_assert_held() annotations should be preferred over
assertions based on spin_is_locked()</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/locking/lockdep-design.html#annotations">https://www.kernel.org/doc/html/latest/locking/lockdep-design.html#annotations</a></p>
</dd>
<dt><strong>UAPI_INCLUDE</strong></dt><dd><p>No #include statements in include/uapi should use a uapi/ path.</p>
</dd>
<dt><strong>USLEEP_RANGE</strong></dt><dd><p>usleep_range() should be preferred over udelay(). The proper way of
using usleep_range() is mentioned in the kernel docs.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/timers/timers-howto.html#delays-information-on-the-various-kernel-delay-sleep-mechanisms">https://www.kernel.org/doc/html/latest/timers/timers-howto.html#delays-information-on-the-various-kernel-delay-sleep-mechanisms</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="comments">
<h3>Comments<a class="headerlink" href="#comments" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><dl>
<dt><strong>BLOCK_COMMENT_STYLE</strong></dt><dd><p>The comment style is incorrect.  The preferred style for multi-
line comments is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/*
* This is the preferred style
* for multi line comments.
*/
</pre></div>
</div>
<p>The networking comment style is a bit different, with the first line
not empty like the former:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/* This is the preferred comment style
* for files in net/ and drivers/net/
*/
</pre></div>
</div>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/coding-style.html#commenting">https://www.kernel.org/doc/html/latest/process/coding-style.html#commenting</a></p>
</dd>
<dt><strong>C99_COMMENTS</strong></dt><dd><p>C99 style single line comments (//) should not be used.
Prefer the block comment style instead.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/coding-style.html#commenting">https://www.kernel.org/doc/html/latest/process/coding-style.html#commenting</a></p>
</dd>
<dt><strong>DATA_RACE</strong></dt><dd><p>Applications of data_race() should have a comment so as to document the
reasoning behind why it was deemed safe.</p>
<p>See: <a class="reference external" href="https://lore.kernel.org/lkml/20200401101714.44781-1-elver&#64;google.com/">https://lore.kernel.org/lkml/20200401101714.44781-1-elver&#64;google.com/</a></p>
</dd>
<dt><strong>FSF_MAILING_ADDRESS</strong></dt><dd><p>Kernel maintainers reject new instances of the GPL boilerplate paragraph
directing people to write to the FSF for a copy of the GPL, since the
FSF has moved in the past and may do so again.
So do not write paragraphs about writing to the Free Software Foundation’s
mailing address.</p>
<p>See: <a class="reference external" href="https://lore.kernel.org/lkml/20131006222342.GT19510&#64;leaf/">https://lore.kernel.org/lkml/20131006222342.GT19510&#64;leaf/</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="commit-message">
<h3>Commit message<a class="headerlink" href="#commit-message" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><dl>
<dt><strong>BAD_SIGN_OFF</strong></dt><dd><p>The signed-off-by line does not fall in line with the standards
specified by the community.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/submitting-patches.html#developer-s-certificate-of-origin-1-1">https://www.kernel.org/doc/html/latest/process/submitting-patches.html#developer-s-certificate-of-origin-1-1</a></p>
</dd>
<dt><strong>BAD_STABLE_ADDRESS_STYLE</strong></dt><dd><p>The email format for stable is incorrect.
Some valid options for stable address are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1. stable@vger.kernel.org
2. stable@kernel.org
</pre></div>
</div>
<p>For adding version info, the following comment style should be used:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>stable@vger.kernel.org # version info
</pre></div>
</div>
</dd>
<dt><strong>COMMIT_COMMENT_SYMBOL</strong></dt><dd><p>Commit log lines starting with a ‘#’ are ignored by git as
comments.  To solve this problem addition of a single space
infront of the log line is enough.</p>
</dd>
<dt><strong>COMMIT_MESSAGE</strong></dt><dd><p>The patch is missing a commit description.  A brief
description of the changes made by the patch should be added.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/submitting-patches.html#describe-your-changes">https://www.kernel.org/doc/html/latest/process/submitting-patches.html#describe-your-changes</a></p>
</dd>
<dt><strong>EMAIL_SUBJECT</strong></dt><dd><p>Naming the tool that found the issue is not very useful in the
subject line.  A good subject line summarizes the change that
the patch brings.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/submitting-patches.html#describe-your-changes">https://www.kernel.org/doc/html/latest/process/submitting-patches.html#describe-your-changes</a></p>
</dd>
<dt><strong>FROM_SIGN_OFF_MISMATCH</strong></dt><dd><p>The author’s email does not match with that in the Signed-off-by:
line(s). This can be sometimes caused due to an improperly configured
email client.</p>
<p>This message is emitted due to any of the following reasons:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>- The email names do not match.
- The email addresses do not match.
- The email subaddresses do not match.
- The email comments do not match.
</pre></div>
</div>
</dd>
<dt><strong>MISSING_SIGN_OFF</strong></dt><dd><p>The patch is missing a Signed-off-by line.  A signed-off-by
line should be added according to Developer’s certificate of
Origin.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/submitting-patches.html#sign-your-work-the-developer-s-certificate-of-origin">https://www.kernel.org/doc/html/latest/process/submitting-patches.html#sign-your-work-the-developer-s-certificate-of-origin</a></p>
</dd>
<dt><strong>NO_AUTHOR_SIGN_OFF</strong></dt><dd><p>The author of the patch has not signed off the patch.  It is
required that a simple sign off line should be present at the
end of explanation of the patch to denote that the author has
written it or otherwise has the rights to pass it on as an open
source patch.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/submitting-patches.html#sign-your-work-the-developer-s-certificate-of-origin">https://www.kernel.org/doc/html/latest/process/submitting-patches.html#sign-your-work-the-developer-s-certificate-of-origin</a></p>
</dd>
<dt><strong>DIFF_IN_COMMIT_MSG</strong></dt><dd><p>Avoid having diff content in commit message.
This causes problems when one tries to apply a file containing both
the changelog and the diff because patch(1) tries to apply the diff
which it found in the changelog.</p>
<p>See: <a class="reference external" href="https://lore.kernel.org/lkml/20150611134006.9df79a893e3636019ad2759e&#64;linux-foundation.org/">https://lore.kernel.org/lkml/20150611134006.9df79a893e3636019ad2759e&#64;linux-foundation.org/</a></p>
</dd>
<dt><strong>GERRIT_CHANGE_ID</strong></dt><dd><p>To be picked up by gerrit, the footer of the commit message might
have a Change-Id like:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Change-Id: Ic8aaa0728a43936cd4c6e1ed590e01ba8f0fbf5b
Signed-off-by: A. U. Thor &lt;author@example.com&gt;
</pre></div>
</div>
<p>The Change-Id line must be removed before submitting.</p>
</dd>
<dt><strong>GIT_COMMIT_ID</strong></dt><dd><p>The proper way to reference a commit id is:
commit &lt;12+ chars of sha1&gt; (“&lt;title line&gt;”)</p>
<p>An example may be:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Commit e21d2170f36602ae2708 (&quot;video: remove unnecessary
platform_set_drvdata()&quot;) removed the unnecessary
platform_set_drvdata(), but left the variable &quot;dev&quot; unused,
delete it.
</pre></div>
</div>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/submitting-patches.html#describe-your-changes">https://www.kernel.org/doc/html/latest/process/submitting-patches.html#describe-your-changes</a></p>
</dd>
<dt><strong>BAD_FIXES_TAG</strong></dt><dd><p>The Fixes: tag is malformed or does not follow the community conventions.
This can occur if the tag have been split into multiple lines (e.g., when
pasted in an email program with word wrapping enabled).</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/submitting-patches.html#describe-your-changes">https://www.kernel.org/doc/html/latest/process/submitting-patches.html#describe-your-changes</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="comparison-style">
<h3>Comparison style<a class="headerlink" href="#comparison-style" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><dl>
<dt><strong>ASSIGN_IN_IF</strong></dt><dd><p>Do not use assignments in if condition.
Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>if ((foo = bar(...)) &lt; BAZ) {
</pre></div>
</div>
<p>should be written as:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>foo = bar(...);
if (foo &lt; BAZ) {
</pre></div>
</div>
</dd>
<dt><strong>BOOL_COMPARISON</strong></dt><dd><p>Comparisons of A to true and false are better written
as A and !A.</p>
<p>See: <a class="reference external" href="https://lore.kernel.org/lkml/1365563834.27174.12.camel&#64;joe-AO722/">https://lore.kernel.org/lkml/1365563834.27174.12.camel&#64;joe-AO722/</a></p>
</dd>
<dt><strong>COMPARISON_TO_NULL</strong></dt><dd><p>Comparisons to NULL in the form (foo == NULL) or (foo != NULL)
are better written as (!foo) and (foo).</p>
</dd>
<dt><strong>CONSTANT_COMPARISON</strong></dt><dd><p>Comparisons with a constant or upper case identifier on the left
side of the test should be avoided.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="indentation-and-line-breaks">
<h3>Indentation and Line Breaks<a class="headerlink" href="#indentation-and-line-breaks" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><dl>
<dt><strong>CODE_INDENT</strong></dt><dd><p>Code indent should use tabs instead of spaces.
Outside of comments, documentation and Kconfig,
spaces are never used for indentation.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/coding-style.html#indentation">https://www.kernel.org/doc/html/latest/process/coding-style.html#indentation</a></p>
</dd>
<dt><strong>DEEP_INDENTATION</strong></dt><dd><p>Indentation with 6 or more tabs usually indicate overly indented
code.</p>
<p>It is suggested to refactor excessive indentation of
if/else/for/do/while/switch statements.</p>
<p>See: <a class="reference external" href="https://lore.kernel.org/lkml/1328311239.21255.24.camel&#64;joe2Laptop/">https://lore.kernel.org/lkml/1328311239.21255.24.camel&#64;joe2Laptop/</a></p>
</dd>
<dt><strong>SWITCH_CASE_INDENT_LEVEL</strong></dt><dd><p>switch should be at the same indent as case.
Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>switch (suffix) {
case &#39;G&#39;:
case &#39;g&#39;:
        mem &lt;&lt;= 30;
        break;
case &#39;M&#39;:
case &#39;m&#39;:
        mem &lt;&lt;= 20;
        break;
case &#39;K&#39;:
case &#39;k&#39;:
        mem &lt;&lt;= 10;
        fallthrough;
default:
        break;
}
</pre></div>
</div>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/coding-style.html#indentation">https://www.kernel.org/doc/html/latest/process/coding-style.html#indentation</a></p>
</dd>
<dt><strong>LONG_LINE</strong></dt><dd><p>The line has exceeded the specified maximum length.
To use a different maximum line length, the –max-line-length=n option
may be added while invoking checkpatch.</p>
<p>Earlier, the default line length was 80 columns.  Commit bdc48fa11e46
(“checkpatch/coding-style: deprecate 80-column warning”) increased the
limit to 100 columns.  This is not a hard limit either and it’s
preferable to stay within 80 columns whenever possible.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/coding-style.html#breaking-long-lines-and-strings">https://www.kernel.org/doc/html/latest/process/coding-style.html#breaking-long-lines-and-strings</a></p>
</dd>
<dt><strong>LONG_LINE_STRING</strong></dt><dd><p>A string starts before but extends beyond the maximum line length.
To use a different maximum line length, the –max-line-length=n option
may be added while invoking checkpatch.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/coding-style.html#breaking-long-lines-and-strings">https://www.kernel.org/doc/html/latest/process/coding-style.html#breaking-long-lines-and-strings</a></p>
</dd>
<dt><strong>LONG_LINE_COMMENT</strong></dt><dd><p>A comment starts before but extends beyond the maximum line length.
To use a different maximum line length, the –max-line-length=n option
may be added while invoking checkpatch.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/coding-style.html#breaking-long-lines-and-strings">https://www.kernel.org/doc/html/latest/process/coding-style.html#breaking-long-lines-and-strings</a></p>
</dd>
<dt><strong>SPLIT_STRING</strong></dt><dd><p>Quoted strings that appear as messages in userspace and can be
grepped, should not be split across multiple lines.</p>
<p>See: <a class="reference external" href="https://lore.kernel.org/lkml/20120203052727.GA15035&#64;leaf/">https://lore.kernel.org/lkml/20120203052727.GA15035&#64;leaf/</a></p>
</dd>
<dt><strong>MULTILINE_DEREFERENCE</strong></dt><dd><p>A single dereferencing identifier spanned on multiple lines like:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct_identifier-&gt;member[index].
member = &lt;foo&gt;;
</pre></div>
</div>
<p>is generally hard to follow. It can easily lead to typos and so makes
the code vulnerable to bugs.</p>
<p>If fixing the multiple line dereferencing leads to an 80 column
violation, then either rewrite the code in a more simple way or if the
starting part of the dereferencing identifier is the same and used at
multiple places then store it in a temporary variable, and use that
temporary variable only at all the places. For example, if there are
two dereferencing identifiers:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>member1-&gt;member2-&gt;member3.foo1;
member1-&gt;member2-&gt;member3.foo2;
</pre></div>
</div>
<p>then store the member1-&gt;member2-&gt;member3 part in a temporary variable.
It not only helps to avoid the 80 column violation but also reduces
the program size by removing the unnecessary dereferences.</p>
<p>But if none of the above methods work then ignore the 80 column
violation because it is much easier to read a dereferencing identifier
on a single line.</p>
</dd>
<dt><strong>TRAILING_STATEMENTS</strong></dt><dd><p>Trailing statements (for example after any conditional) should be
on the next line.
Statements, such as:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>if (x == y) break;
</pre></div>
</div>
<p>should be:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>if (x == y)
        break;
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
</section>
<section id="macros-attributes-and-symbols">
<h3>Macros, Attributes and Symbols<a class="headerlink" href="#macros-attributes-and-symbols" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><dl>
<dt><strong>ARRAY_SIZE</strong></dt><dd><p>The ARRAY_SIZE(foo) macro should be preferred over
sizeof(foo)/sizeof(foo[0]) for finding number of elements in an
array.</p>
<p>The macro is defined in include/linux/kernel.h:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#define ARRAY_SIZE(x) (sizeof(x) / sizeof((x)[0]))
</pre></div>
</div>
</dd>
<dt><strong>AVOID_EXTERNS</strong></dt><dd><p>Function prototypes don’t need to be declared extern in .h
files.  It’s assumed by the compiler and is unnecessary.</p>
</dd>
<dt><strong>AVOID_L_PREFIX</strong></dt><dd><p>Local symbol names that are prefixed with <cite>.L</cite> should be avoided,
as this has special meaning for the assembler; a symbol entry will
not be emitted into the symbol table.  This can prevent <cite>objtool</cite>
from generating correct unwind info.</p>
<p>Symbols with STB_LOCAL binding may still be used, and <cite>.L</cite> prefixed
local symbol names are still generally usable within a function,
but <cite>.L</cite> prefixed local symbol names should not be used to denote
the beginning or end of code regions via
<cite>SYM_CODE_START_LOCAL</cite>/<cite>SYM_CODE_END</cite></p>
</dd>
<dt><strong>BIT_MACRO</strong></dt><dd><p>Defines like: 1 &lt;&lt; &lt;digit&gt; could be BIT(digit).
The BIT() macro is defined via include/linux/bits.h:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#define BIT(nr)         (1UL &lt;&lt; (nr))
</pre></div>
</div>
</dd>
<dt><strong>CONST_READ_MOSTLY</strong></dt><dd><p>When a variable is tagged with the __read_mostly annotation, it is a
signal to the compiler that accesses to the variable will be mostly
reads and rarely(but NOT never) a write.</p>
<p>const __read_mostly does not make any sense as const data is already
read-only.  The __read_mostly annotation thus should be removed.</p>
</dd>
<dt><strong>DATE_TIME</strong></dt><dd><p>It is generally desirable that building the same source code with
the same set of tools is reproducible, i.e. the output is always
exactly the same.</p>
<p>The kernel does <em>not</em> use the <code class="docutils literal notranslate"><span class="pre">__DATE__</span></code> and <code class="docutils literal notranslate"><span class="pre">__TIME__</span></code> macros,
and enables warnings if they are used as they can lead to
non-deterministic builds.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/kbuild/reproducible-builds.html#timestamps">https://www.kernel.org/doc/html/latest/kbuild/reproducible-builds.html#timestamps</a></p>
</dd>
<dt><strong>DEFINE_ARCH_HAS</strong></dt><dd><p>The ARCH_HAS_xyz and ARCH_HAVE_xyz patterns are wrong.</p>
<p>For big conceptual features use Kconfig symbols instead.  And for
smaller things where we have compatibility fallback functions but
want architectures able to override them with optimized ones, we
should either use weak functions (appropriate for some cases), or
the symbol that protects them should be the same symbol we use.</p>
<p>See: <a class="reference external" href="https://lore.kernel.org/lkml/CA+55aFycQ9XJvEOsiM3txHL5bjUc8CeKWJNR_H+MiicaddB42Q&#64;mail.gmail.com/">https://lore.kernel.org/lkml/CA+55aFycQ9XJvEOsiM3txHL5bjUc8CeKWJNR_H+MiicaddB42Q&#64;mail.gmail.com/</a></p>
</dd>
<dt><strong>DO_WHILE_MACRO_WITH_TRAILING_SEMICOLON</strong></dt><dd><p>do {} while(0) macros should not have a trailing semicolon.</p>
</dd>
<dt><strong>INIT_ATTRIBUTE</strong></dt><dd><p>Const init definitions should use __initconst instead of
__initdata.</p>
<p>Similarly init definitions without const require a separate
use of const.</p>
</dd>
<dt><strong>INLINE_LOCATION</strong></dt><dd><p>The inline keyword should sit between storage class and type.</p>
<p>For example, the following segment:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>inline static int example_function(void)
{
        ...
}
</pre></div>
</div>
<p>should be:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>static inline int example_function(void)
{
        ...
}
</pre></div>
</div>
</dd>
<dt><strong>MISPLACED_INIT</strong></dt><dd><p>It is possible to use section markers on variables in a way
which gcc doesn’t understand (or at least not the way the
developer intended):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>static struct __initdata samsung_pll_clock exynos4_plls[nr_plls] = {
</pre></div>
</div>
<p>does not put exynos4_plls in the .initdata section. The __initdata
marker can be virtually anywhere on the line, except right after
“struct”. The preferred location is before the “=” sign if there is
one, or before the trailing “;” otherwise.</p>
<p>See: <a class="reference external" href="https://lore.kernel.org/lkml/1377655732.3619.19.camel&#64;joe-AO722/">https://lore.kernel.org/lkml/1377655732.3619.19.camel&#64;joe-AO722/</a></p>
</dd>
<dt><strong>MULTISTATEMENT_MACRO_USE_DO_WHILE</strong></dt><dd><p>Macros with multiple statements should be enclosed in a
do - while block.  Same should also be the case for macros
starting with <cite>if</cite> to avoid logic defects:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#define macrofun(a, b, c)                 \
  do {                                    \
          if (a == 5)                     \
                  do_this(b, c);          \
  } while (0)
</pre></div>
</div>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/coding-style.html#macros-enums-and-rtl">https://www.kernel.org/doc/html/latest/process/coding-style.html#macros-enums-and-rtl</a></p>
</dd>
<dt><strong>PREFER_FALLTHROUGH</strong></dt><dd><p>Use the <cite>fallthrough;</cite> pseudo keyword instead of
<cite>/* fallthrough */</cite> like comments.</p>
</dd>
<dt><strong>TRAILING_SEMICOLON</strong></dt><dd><p>Macro definition should not end with a semicolon. The macro
invocation style should be consistent with function calls.
This can prevent any unexpected code paths:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#define MAC do_something;
</pre></div>
</div>
<p>If this macro is used within a if else statement, like:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>if (some_condition)
        MAC;

else
        do_something;
</pre></div>
</div>
<p>Then there would be a compilation error, because when the macro is
expanded there are two trailing semicolons, so the else branch gets
orphaned.</p>
<p>See: <a class="reference external" href="https://lore.kernel.org/lkml/1399671106.2912.21.camel&#64;joe-AO725/">https://lore.kernel.org/lkml/1399671106.2912.21.camel&#64;joe-AO725/</a></p>
</dd>
<dt><strong>SINGLE_STATEMENT_DO_WHILE_MACRO</strong></dt><dd><p>For the multi-statement macros, it is necessary to use the do-while
loop to avoid unpredictable code paths. The do-while loop helps to
group the multiple statements into a single one so that a
function-like macro can be used as a function only.</p>
<p>But for the single statement macros, it is unnecessary to use the
do-while loop. Although the code is syntactically correct but using
the do-while loop is redundant. So remove the do-while loop for single
statement macros.</p>
</dd>
<dt><strong>WEAK_DECLARATION</strong></dt><dd><p>Using weak declarations like __attribute__((weak)) or __weak
can have unintended link defects.  Avoid using them.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="functions-and-variables">
<h3>Functions and Variables<a class="headerlink" href="#functions-and-variables" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><dl>
<dt><strong>CAMELCASE</strong></dt><dd><p>Avoid CamelCase Identifiers.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/coding-style.html#naming">https://www.kernel.org/doc/html/latest/process/coding-style.html#naming</a></p>
</dd>
<dt><strong>CONST_CONST</strong></dt><dd><p>Using <cite>const &lt;type&gt; const *</cite> is generally meant to be
written <cite>const &lt;type&gt; * const</cite>.</p>
</dd>
<dt><strong>CONST_STRUCT</strong></dt><dd><p>Using const is generally a good idea.  Checkpatch reads
a list of frequently used structs that are always or
almost always constant.</p>
<p>The existing structs list can be viewed from
<cite>scripts/const_structs.checkpatch</cite>.</p>
<p>See: <a class="reference external" href="https://lore.kernel.org/lkml/alpine.DEB.2.10.1608281509480.3321&#64;hadrien/">https://lore.kernel.org/lkml/alpine.DEB.2.10.1608281509480.3321&#64;hadrien/</a></p>
</dd>
<dt><strong>EMBEDDED_FUNCTION_NAME</strong></dt><dd><p>Embedded function names are less appropriate to use as
refactoring can cause function renaming.  Prefer the use of
“%s”, __func__ to embedded function names.</p>
<p>Note that this does not work with -f (–file) checkpatch option
as it depends on patch context providing the function name.</p>
</dd>
<dt><strong>FUNCTION_ARGUMENTS</strong></dt><dd><p>This warning is emitted due to any of the following reasons:</p>
<blockquote>
<div><ol class="arabic">
<li><p>Arguments for the function declaration do not follow
the identifier name.  Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>void foo
(int bar, int baz)
</pre></div>
</div>
<p>This should be corrected to:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>void foo(int bar, int baz)
</pre></div>
</div>
</li>
<li><p>Some arguments for the function definition do not
have an identifier name.  Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>void foo(int)
</pre></div>
</div>
<p>All arguments should have identifier names.</p>
</li>
</ol>
</div></blockquote>
</dd>
<dt><strong>FUNCTION_WITHOUT_ARGS</strong></dt><dd><p>Function declarations without arguments like:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>int foo()
</pre></div>
</div>
<p>should be:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>int foo(void)
</pre></div>
</div>
</dd>
<dt><strong>GLOBAL_INITIALISERS</strong></dt><dd><p>Global variables should not be initialized explicitly to
0 (or NULL, false, etc.).  Your compiler (or rather your
loader, which is responsible for zeroing out the relevant
sections) automatically does it for you.</p>
</dd>
<dt><strong>INITIALISED_STATIC</strong></dt><dd><p>Static variables should not be initialized explicitly to zero.
Your compiler (or rather your loader) automatically does
it for you.</p>
</dd>
<dt><strong>MULTIPLE_ASSIGNMENTS</strong></dt><dd><p>Multiple assignments on a single line makes the code unnecessarily
complicated. So on a single line assign value to a single variable
only, this makes the code more readable and helps avoid typos.</p>
</dd>
<dt><strong>RETURN_PARENTHESES</strong></dt><dd><p>return is not a function and as such doesn’t need parentheses:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>return (bar);
</pre></div>
</div>
<p>can simply be:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>return bar;
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
</section>
<section id="permissions">
<h3>Permissions<a class="headerlink" href="#permissions" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><dl>
<dt><strong>DEVICE_ATTR_PERMS</strong></dt><dd><p>The permissions used in DEVICE_ATTR are unusual.
Typically only three permissions are used - 0644 (RW), 0444 (RO)
and 0200 (WO).</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/filesystems/sysfs.html#attributes">https://www.kernel.org/doc/html/latest/filesystems/sysfs.html#attributes</a></p>
</dd>
<dt><strong>EXECUTE_PERMISSIONS</strong></dt><dd><p>There is no reason for source files to be executable.  The executable
bit can be removed safely.</p>
</dd>
<dt><strong>EXPORTED_WORLD_WRITABLE</strong></dt><dd><p>Exporting world writable sysfs/debugfs files is usually a bad thing.
When done arbitrarily they can introduce serious security bugs.
In the past, some of the debugfs vulnerabilities would seemingly allow
any local user to write arbitrary values into device registers - a
situation from which little good can be expected to emerge.</p>
<p>See: <a class="reference external" href="https://lore.kernel.org/linux-arm-kernel/cover.1296818921.git.segoon&#64;openwall.com/">https://lore.kernel.org/linux-arm-kernel/cover.1296818921.git.segoon&#64;openwall.com/</a></p>
</dd>
<dt><strong>NON_OCTAL_PERMISSIONS</strong></dt><dd><p>Permission bits should use 4 digit octal permissions (like 0700 or 0444).
Avoid using any other base like decimal.</p>
</dd>
<dt><strong>SYMBOLIC_PERMS</strong></dt><dd><p>Permission bits in the octal form are more readable and easier to
understand than their symbolic counterparts because many command-line
tools use this notation. Experienced kernel developers have been using
these traditional Unix permission bits for decades and so they find it
easier to understand the octal notation than the symbolic macros.
For example, it is harder to read S_IWUSR|S_IRUGO than 0644, which
obscures the developer’s intent rather than clarifying it.</p>
<p>See: <a class="reference external" href="https://lore.kernel.org/lkml/CA+55aFw5v23T-zvDZp-MmD_EYxF8WbafwwB59934FV7g21uMGQ&#64;mail.gmail.com/">https://lore.kernel.org/lkml/CA+55aFw5v23T-zvDZp-MmD_EYxF8WbafwwB59934FV7g21uMGQ&#64;mail.gmail.com/</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="spacing-and-brackets">
<h3>Spacing and Brackets<a class="headerlink" href="#spacing-and-brackets" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><dl>
<dt><strong>ASSIGNMENT_CONTINUATIONS</strong></dt><dd><p>Assignment operators should not be written at the start of a
line but should follow the operand at the previous line.</p>
</dd>
<dt><strong>BRACES</strong></dt><dd><p>The placement of braces is stylistically incorrect.
The preferred way is to put the opening brace last on the line,
and put the closing brace first:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>if (x is true) {
        we do y
}
</pre></div>
</div>
<p>This applies for all non-functional blocks.
However, there is one special case, namely functions: they have the
opening brace at the beginning of the next line, thus:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>int function(int x)
{
        body of function
}
</pre></div>
</div>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces">https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces</a></p>
</dd>
<dt><strong>BRACKET_SPACE</strong></dt><dd><p>Whitespace before opening bracket ‘[’ is prohibited.
There are some exceptions:</p>
<ol class="arabic">
<li><p>With a type on the left:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>int [] a;
</pre></div>
</div>
</li>
<li><p>At the beginning of a line for slice initialisers:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[0...10] = 5,
</pre></div>
</div>
</li>
<li><p>Inside a curly brace:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>= { [0...10] = 5 }
</pre></div>
</div>
</li>
</ol>
</dd>
<dt><strong>CONCATENATED_STRING</strong></dt><dd><p>Concatenated elements should have a space in between.
Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>printk(KERN_INFO&quot;bar&quot;);
</pre></div>
</div>
<p>should be:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>printk(KERN_INFO &quot;bar&quot;);
</pre></div>
</div>
</dd>
<dt><strong>ELSE_AFTER_BRACE</strong></dt><dd><p><cite>else {</cite> should follow the closing block <cite>}</cite> on the same line.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces">https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces</a></p>
</dd>
<dt><strong>LINE_SPACING</strong></dt><dd><p>Vertical space is wasted given the limited number of lines an
editor window can display when multiple blank lines are used.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces">https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces</a></p>
</dd>
<dt><strong>OPEN_BRACE</strong></dt><dd><p>The opening brace should be following the function definitions on the
next line.  For any non-functional block it should be on the same line
as the last construct.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces">https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces</a></p>
</dd>
<dt><strong>POINTER_LOCATION</strong></dt><dd><p>When using pointer data or a function that returns a pointer type,
the preferred use of * is adjacent to the data name or function name
and not adjacent to the type name.
Examples:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>char *linux_banner;
unsigned long long memparse(char *ptr, char **retptr);
char *match_strdup(substring_t *s);
</pre></div>
</div>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces">https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces</a></p>
</dd>
<dt><strong>SPACING</strong></dt><dd><p>Whitespace style used in the kernel sources is described in kernel docs.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces">https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces</a></p>
</dd>
<dt><strong>TRAILING_WHITESPACE</strong></dt><dd><p>Trailing whitespace should always be removed.
Some editors highlight the trailing whitespace and cause visual
distractions when editing files.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces">https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces</a></p>
</dd>
<dt><strong>UNNECESSARY_PARENTHESES</strong></dt><dd><p>Parentheses are not required in the following cases:</p>
<blockquote>
<div><ol class="arabic">
<li><p>Function pointer uses:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(foo-&gt;bar)();
</pre></div>
</div>
</li>
</ol>
<blockquote>
<div><p>could be:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>foo-&gt;bar();
</pre></div>
</div>
</div></blockquote>
<ol class="arabic" start="2">
<li><p>Comparisons in if:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>if ((foo-&gt;bar) &amp;&amp; (foo-&gt;baz))
if ((foo == bar))
</pre></div>
</div>
</li>
</ol>
<blockquote>
<div><p>could be:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>if (foo-&gt;bar &amp;&amp; foo-&gt;baz)
if (foo == bar)
</pre></div>
</div>
</div></blockquote>
<ol class="arabic" start="3">
<li><p>addressof/dereference single Lvalues:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&amp;(foo-&gt;bar)
*(foo-&gt;bar)
</pre></div>
</div>
</li>
</ol>
<blockquote>
<div><p>could be:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&amp;foo-&gt;bar
*foo-&gt;bar
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
</dd>
<dt><strong>WHILE_AFTER_BRACE</strong></dt><dd><p>while should follow the closing bracket on the same line:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>do {
        ...
} while(something);
</pre></div>
</div>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces">https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="others">
<h3>Others<a class="headerlink" href="#others" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><dl>
<dt><strong>CONFIG_DESCRIPTION</strong></dt><dd><p>Kconfig symbols should have a help text which fully describes
it.</p>
</dd>
<dt><strong>CORRUPTED_PATCH</strong></dt><dd><p>The patch seems to be corrupted or lines are wrapped.
Please regenerate the patch file before sending it to the maintainer.</p>
</dd>
<dt><strong>CVS_KEYWORD</strong></dt><dd><p>Since linux moved to git, the CVS markers are no longer used.
So, CVS style keywords ($Id$, $Revision$, $Log$) should not be
added.</p>
</dd>
<dt><strong>DEFAULT_NO_BREAK</strong></dt><dd><p>switch default case is sometimes written as “default:;”.  This can
cause new cases added below default to be defective.</p>
<p>A “break;” should be added after empty default statement to avoid
unwanted fallthrough.</p>
</dd>
<dt><strong>DOS_LINE_ENDINGS</strong></dt><dd><p>For DOS-formatted patches, there are extra ^M symbols at the end of
the line.  These should be removed.</p>
</dd>
<dt><strong>DT_SCHEMA_BINDING_PATCH</strong></dt><dd><p>DT bindings moved to a json-schema based format instead of
freeform text.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/devicetree/bindings/writing-schema.html">https://www.kernel.org/doc/html/latest/devicetree/bindings/writing-schema.html</a></p>
</dd>
<dt><strong>DT_SPLIT_BINDING_PATCH</strong></dt><dd><p>Devicetree bindings should be their own patch.  This is because
bindings are logically independent from a driver implementation,
they have a different maintainer (even though they often
are applied via the same tree), and it makes for a cleaner history in the
DT only tree created with git-filter-branch.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/devicetree/bindings/submitting-patches.html#i-for-patch-submitters">https://www.kernel.org/doc/html/latest/devicetree/bindings/submitting-patches.html#i-for-patch-submitters</a></p>
</dd>
<dt><strong>EMBEDDED_FILENAME</strong></dt><dd><p>Embedding the complete filename path inside the file isn’t particularly
useful as often the path is moved around and becomes incorrect.</p>
</dd>
<dt><strong>FILE_PATH_CHANGES</strong></dt><dd><p>Whenever files are added, moved, or deleted, the MAINTAINERS file
patterns can be out of sync or outdated.</p>
<p>So MAINTAINERS might need updating in these cases.</p>
</dd>
<dt><strong>MEMSET</strong></dt><dd><p>The memset use appears to be incorrect.  This may be caused due to
badly ordered parameters.  Please recheck the usage.</p>
</dd>
<dt><strong>NOT_UNIFIED_DIFF</strong></dt><dd><p>The patch file does not appear to be in unified-diff format.  Please
regenerate the patch file before sending it to the maintainer.</p>
</dd>
<dt><strong>PRINTF_0XDECIMAL</strong></dt><dd><p>Prefixing 0x with decimal output is defective and should be corrected.</p>
</dd>
<dt><strong>SPDX_LICENSE_TAG</strong></dt><dd><p>The source file is missing or has an improper SPDX identifier tag.
The Linux kernel requires the precise SPDX identifier in all source files,
and it is thoroughly documented in the kernel docs.</p>
<p>See: <a class="reference external" href="https://www.kernel.org/doc/html/latest/process/license-rules.html">https://www.kernel.org/doc/html/latest/process/license-rules.html</a></p>
</dd>
<dt><strong>TYPO_SPELLING</strong></dt><dd><p>Some words may have been misspelled.  Consider reviewing them.</p>
</dd>
</dl>
</div></blockquote>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Checkpatch</a><ul>
<li><a class="reference internal" href="#options">Options</a></li>
<li><a class="reference internal" href="#message-levels">Message Levels</a></li>
<li><a class="reference internal" href="#type-descriptions">Type Descriptions</a><ul>
<li><a class="reference internal" href="#allocation-style">Allocation style</a></li>
<li><a class="reference internal" href="#api-usage">API usage</a></li>
<li><a class="reference internal" href="#comments">Comments</a></li>
<li><a class="reference internal" href="#commit-message">Commit message</a></li>
<li><a class="reference internal" href="#comparison-style">Comparison style</a></li>
<li><a class="reference internal" href="#indentation-and-line-breaks">Indentation and Line Breaks</a></li>
<li><a class="reference internal" href="#macros-attributes-and-symbols">Macros, Attributes and Symbols</a></li>
<li><a class="reference internal" href="#functions-and-variables">Functions and Variables</a></li>
<li><a class="reference internal" href="#permissions">Permissions</a></li>
<li><a class="reference internal" href="#spacing-and-brackets">Spacing and Brackets</a></li>
<li><a class="reference internal" href="#others">Others</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/dev-tools/checkpatch.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/dev-tools/checkpatch.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>