
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Xilinx SD-FEC Driver &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Linux Scheduler" href="../scheduler/index.html" />
    <link rel="prev" title="Introduction of Uacce" href="uacce.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="xilinx-sd-fec-driver">
<h1>Xilinx SD-FEC Driver<a class="headerlink" href="#xilinx-sd-fec-driver" title="Permalink to this headline">¶</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This driver supports SD-FEC Integrated Block for Zynq Ultrascale+™ RFSoCs.</p>
<p>For a full description of SD-FEC core features, see the <a class="reference external" href="https://www.xilinx.com/cgi-bin/docs/ipdoc?c=sd_fec;v=latest;d=pg256-sdfec-integrated-block.pdf">SD-FEC Product Guide (PG256)</a></p>
<p>This driver supports the following features:</p>
<blockquote>
<div><ul class="simple">
<li><p>Retrieval of the Integrated Block configuration and status information</p></li>
<li><p>Configuration of LDPC codes</p></li>
<li><p>Configuration of Turbo decoding</p></li>
<li><p>Monitoring errors</p></li>
</ul>
</div></blockquote>
<p>Missing features, known issues, and limitations of the SD-FEC driver are as
follows:</p>
<blockquote>
<div><ul class="simple">
<li><p>Only allows a single open file handler to any instance of the driver at any time</p></li>
<li><p>Reset of the SD-FEC Integrated Block is not controlled by this driver</p></li>
<li><p>Does not support shared LDPC code table wraparound</p></li>
</ul>
</div></blockquote>
<p>The device tree entry is described in:
<a class="reference external" href="https://github.com/Xilinx/linux-xlnx/blob/master/Documentation/devicetree/bindings/misc/xlnx%2Csd-fec.txt">linux-xlnx/Documentation/devicetree/bindings/misc/xlnx,sd-fec.txt</a></p>
<section id="modes-of-operation">
<h3>Modes of Operation<a class="headerlink" href="#modes-of-operation" title="Permalink to this headline">¶</a></h3>
<p>The driver works with the SD-FEC core in two modes of operation:</p>
<blockquote>
<div><ul class="simple">
<li><p>Run-time configuration</p></li>
<li><p>Programmable Logic (PL) initialization</p></li>
</ul>
</div></blockquote>
<section id="run-time-configuration">
<h4>Run-time Configuration<a class="headerlink" href="#run-time-configuration" title="Permalink to this headline">¶</a></h4>
<p>For Run-time configuration the role of driver is to allow the software application to do the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>Load the configuration parameters for either Turbo decode or LDPC encode or decode</p></li>
<li><p>Activate the SD-FEC core</p></li>
<li><p>Monitor the SD-FEC core for errors</p></li>
<li><p>Retrieve the status and configuration of the SD-FEC core</p></li>
</ul>
</div></blockquote>
</section>
<section id="programmable-logic-pl-initialization">
<h4>Programmable Logic (PL) Initialization<a class="headerlink" href="#programmable-logic-pl-initialization" title="Permalink to this headline">¶</a></h4>
<p>For PL initialization, supporting logic loads configuration parameters for either
the Turbo decode or LDPC encode or decode.  The role of the driver is to allow
the software application to do the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>Activate the SD-FEC core</p></li>
<li><p>Monitor the SD-FEC core for errors</p></li>
<li><p>Retrieve the status and configuration of the SD-FEC core</p></li>
</ul>
</div></blockquote>
</section>
</section>
</section>
<section id="driver-structure">
<h2>Driver Structure<a class="headerlink" href="#driver-structure" title="Permalink to this headline">¶</a></h2>
<p>The driver provides a platform device where the <code class="docutils literal notranslate"><span class="pre">probe</span></code> and <code class="docutils literal notranslate"><span class="pre">remove</span></code>
operations are provided.</p>
<blockquote>
<div><ul class="simple">
<li><p>probe: Updates configuration register with device-tree entries plus determines the current activate state of the core, for example, is the core bypassed or has the core been started.</p></li>
</ul>
</div></blockquote>
<p>The driver defines the following driver file operations to provide user
application interfaces:</p>
<blockquote>
<div><ul>
<li><p>open: Implements restriction that only a single file descriptor can be open per SD-FEC instance at any time</p></li>
<li><p>release: Allows another file descriptor to be open, that is after current file descriptor is closed</p></li>
<li><p>poll: Provides a method to monitor for SD-FEC Error events</p></li>
<li><p>unlocked_ioctl: Provides the following ioctl commands that allows the application configure the SD-FEC core:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#c.XSDFEC_START_DEV" title="XSDFEC_START_DEV"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_START_DEV</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.XSDFEC_STOP_DEV" title="XSDFEC_STOP_DEV"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_STOP_DEV</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.XSDFEC_GET_STATUS" title="XSDFEC_GET_STATUS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_GET_STATUS</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.XSDFEC_SET_IRQ" title="XSDFEC_SET_IRQ"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_SET_IRQ</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.XSDFEC_SET_TURBO" title="XSDFEC_SET_TURBO"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_SET_TURBO</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.XSDFEC_ADD_LDPC_CODE_PARAMS" title="XSDFEC_ADD_LDPC_CODE_PARAMS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_ADD_LDPC_CODE_PARAMS</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.XSDFEC_GET_CONFIG" title="XSDFEC_GET_CONFIG"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_GET_CONFIG</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.XSDFEC_SET_ORDER" title="XSDFEC_SET_ORDER"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_SET_ORDER</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.XSDFEC_SET_BYPASS" title="XSDFEC_SET_BYPASS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_SET_BYPASS</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.XSDFEC_IS_ACTIVE" title="XSDFEC_IS_ACTIVE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_IS_ACTIVE</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.XSDFEC_CLEAR_STATS" title="XSDFEC_CLEAR_STATS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_CLEAR_STATS</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.XSDFEC_SET_DEFAULT_CONFIG" title="XSDFEC_SET_DEFAULT_CONFIG"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_SET_DEFAULT_CONFIG</span></code></a></p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</section>
<section id="driver-usage">
<h2>Driver Usage<a class="headerlink" href="#driver-usage" title="Permalink to this headline">¶</a></h2>
<section id="id1">
<h3>Overview<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>After opening the driver, the user should find out what operations need to be
performed to configure and activate the SD-FEC core and determine the
configuration of the driver.
The following outlines the flow the user should perform:</p>
<blockquote>
<div><ul class="simple">
<li><p>Determine Configuration</p></li>
<li><p>Set the order, if not already configured as desired</p></li>
<li><p>Set Turbo decode, LPDC encode or decode parameters, depending on how the
SD-FEC core is configured plus if the SD-FEC has not been configured for PL
initialization</p></li>
<li><p>Enable interrupts, if not already enabled</p></li>
<li><p>Bypass the SD-FEC core, if required</p></li>
<li><p>Start the SD-FEC core if not already started</p></li>
<li><p>Get the SD-FEC core status</p></li>
<li><p>Monitor for interrupts</p></li>
<li><p>Stop the SD-FEC core</p></li>
</ul>
</div></blockquote>
<p>Note: When monitoring for interrupts if a critical error is detected where a reset is required, the driver will be required to load the default configuration.</p>
</section>
<section id="determine-configuration">
<h3>Determine Configuration<a class="headerlink" href="#determine-configuration" title="Permalink to this headline">¶</a></h3>
<p>Determine the configuration of the SD-FEC core by using the ioctl
<a class="reference internal" href="#c.XSDFEC_GET_CONFIG" title="XSDFEC_GET_CONFIG"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_GET_CONFIG</span></code></a>.</p>
</section>
<section id="set-the-order">
<h3>Set the Order<a class="headerlink" href="#set-the-order" title="Permalink to this headline">¶</a></h3>
<p>Setting the order determines how the order of Blocks can change from input to output.</p>
<p>Setting the order is done by using the ioctl <a class="reference internal" href="#c.XSDFEC_SET_ORDER" title="XSDFEC_SET_ORDER"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_SET_ORDER</span></code></a></p>
<p>Setting the order can only be done if the following restrictions are met:</p>
<blockquote>
<div><ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">state</span></code> member of struct <a class="reference internal" href="#c.xsdfec_status" title="xsdfec_status"><code class="xref c c-type docutils literal notranslate"><span class="pre">xsdfec_status</span></code></a> filled by the ioctl <a class="reference internal" href="#c.XSDFEC_GET_STATUS" title="XSDFEC_GET_STATUS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_GET_STATUS</span></code></a> indicates the SD-FEC core has not STARTED</p></li>
</ul>
</div></blockquote>
</section>
<section id="add-ldpc-codes">
<h3>Add LDPC Codes<a class="headerlink" href="#add-ldpc-codes" title="Permalink to this headline">¶</a></h3>
<p>The following steps indicate how to add LDPC codes to the SD-FEC core:</p>
<blockquote>
<div><ul class="simple">
<li><p>Use the auto-generated parameters to fill the <a class="reference internal" href="#c.xsdfec_ldpc_params" title="xsdfec_ldpc_params"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xsdfec_ldpc_params</span></code></a> for the desired LDPC code.</p></li>
<li><p>Set the SC, QA, and LA table offsets for the LPDC parameters and the parameters in the structure <a class="reference internal" href="#c.xsdfec_ldpc_params" title="xsdfec_ldpc_params"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xsdfec_ldpc_params</span></code></a></p></li>
<li><p>Set the desired Code Id value in the structure <a class="reference internal" href="#c.xsdfec_ldpc_params" title="xsdfec_ldpc_params"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xsdfec_ldpc_params</span></code></a></p></li>
<li><p>Add the LPDC Code Parameters using the ioctl <a class="reference internal" href="#c.XSDFEC_ADD_LDPC_CODE_PARAMS" title="XSDFEC_ADD_LDPC_CODE_PARAMS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_ADD_LDPC_CODE_PARAMS</span></code></a></p></li>
<li><p>For the applied LPDC Code Parameter use the function <code class="xref c c-func docutils literal notranslate"><span class="pre">xsdfec_calculate_shared_ldpc_table_entry_size()</span></code> to calculate the size of shared LPDC code tables. This allows the user to determine the shared table usage so when selecting the table offsets for the next LDPC code parameters unused table areas can be selected.</p></li>
<li><p>Repeat for each LDPC code parameter.</p></li>
</ul>
</div></blockquote>
<p>Adding LDPC codes can only be done if the following restrictions are met:</p>
<blockquote>
<div><ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">code</span></code> member of <a class="reference internal" href="#c.xsdfec_config" title="xsdfec_config"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xsdfec_config</span></code></a> filled by the ioctl <a class="reference internal" href="#c.XSDFEC_GET_CONFIG" title="XSDFEC_GET_CONFIG"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_GET_CONFIG</span></code></a> indicates the SD-FEC core is configured as LDPC</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">code_wr_protect</span></code> of <a class="reference internal" href="#c.xsdfec_config" title="xsdfec_config"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xsdfec_config</span></code></a> filled by the ioctl <a class="reference internal" href="#c.XSDFEC_GET_CONFIG" title="XSDFEC_GET_CONFIG"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_GET_CONFIG</span></code></a> indicates that write protection is not enabled</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">state</span></code> member of struct <a class="reference internal" href="#c.xsdfec_status" title="xsdfec_status"><code class="xref c c-type docutils literal notranslate"><span class="pre">xsdfec_status</span></code></a> filled by the ioctl <a class="reference internal" href="#c.XSDFEC_GET_STATUS" title="XSDFEC_GET_STATUS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_GET_STATUS</span></code></a> indicates the SD-FEC core has not started</p></li>
</ul>
</div></blockquote>
</section>
<section id="set-turbo-decode">
<h3>Set Turbo Decode<a class="headerlink" href="#set-turbo-decode" title="Permalink to this headline">¶</a></h3>
<p>Configuring the Turbo decode parameters is done by using the ioctl <a class="reference internal" href="#c.XSDFEC_SET_TURBO" title="XSDFEC_SET_TURBO"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_SET_TURBO</span></code></a> using auto-generated parameters to fill the <a class="reference internal" href="#c.xsdfec_turbo" title="xsdfec_turbo"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xsdfec_turbo</span></code></a> for the desired Turbo code.</p>
<p>Adding Turbo decode can only be done if the following restrictions are met:</p>
<blockquote>
<div><ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">code</span></code> member of <a class="reference internal" href="#c.xsdfec_config" title="xsdfec_config"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xsdfec_config</span></code></a> filled by the ioctl <a class="reference internal" href="#c.XSDFEC_GET_CONFIG" title="XSDFEC_GET_CONFIG"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_GET_CONFIG</span></code></a> indicates the SD-FEC core is configured as TURBO</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">state</span></code> member of struct <a class="reference internal" href="#c.xsdfec_status" title="xsdfec_status"><code class="xref c c-type docutils literal notranslate"><span class="pre">xsdfec_status</span></code></a> filled by the ioctl <a class="reference internal" href="#c.XSDFEC_GET_STATUS" title="XSDFEC_GET_STATUS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_GET_STATUS</span></code></a> indicates the SD-FEC core has not STARTED</p></li>
</ul>
</div></blockquote>
</section>
<section id="enable-interrupts">
<h3>Enable Interrupts<a class="headerlink" href="#enable-interrupts" title="Permalink to this headline">¶</a></h3>
<p>Enabling or disabling interrupts is done by using the ioctl <a class="reference internal" href="#c.XSDFEC_SET_IRQ" title="XSDFEC_SET_IRQ"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_SET_IRQ</span></code></a>. The members of the parameter passed, <a class="reference internal" href="#c.xsdfec_irq" title="xsdfec_irq"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xsdfec_irq</span></code></a>, to the ioctl are used to set and clear different categories of interrupts. The category of interrupt is controlled as following:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">enable_isr</span></code> controls the <code class="docutils literal notranslate"><span class="pre">tlast</span></code> interrupts</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">enable_ecc_isr</span></code> controls the ECC interrupts</p></li>
</ul>
</div></blockquote>
<p>If the <code class="docutils literal notranslate"><span class="pre">code</span></code> member of <a class="reference internal" href="#c.xsdfec_config" title="xsdfec_config"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xsdfec_config</span></code></a> filled by the ioctl <a class="reference internal" href="#c.XSDFEC_GET_CONFIG" title="XSDFEC_GET_CONFIG"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_GET_CONFIG</span></code></a> indicates the SD-FEC core is configured as TURBO then the enabling ECC errors is not required.</p>
</section>
<section id="bypass-the-sd-fec">
<h3>Bypass the SD-FEC<a class="headerlink" href="#bypass-the-sd-fec" title="Permalink to this headline">¶</a></h3>
<p>Bypassing the SD-FEC is done by using the ioctl <a class="reference internal" href="#c.XSDFEC_SET_BYPASS" title="XSDFEC_SET_BYPASS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_SET_BYPASS</span></code></a></p>
<p>Bypassing the SD-FEC can only be done if the following restrictions are met:</p>
<blockquote>
<div><ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">state</span></code> member of <a class="reference internal" href="#c.xsdfec_status" title="xsdfec_status"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xsdfec_status</span></code></a> filled by the ioctl <a class="reference internal" href="#c.XSDFEC_GET_STATUS" title="XSDFEC_GET_STATUS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_GET_STATUS</span></code></a> indicates the SD-FEC core has not STARTED</p></li>
</ul>
</div></blockquote>
</section>
<section id="start-the-sd-fec-core">
<h3>Start the SD-FEC core<a class="headerlink" href="#start-the-sd-fec-core" title="Permalink to this headline">¶</a></h3>
<p>Start the SD-FEC core by using the ioctl <a class="reference internal" href="#c.XSDFEC_START_DEV" title="XSDFEC_START_DEV"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_START_DEV</span></code></a></p>
</section>
<section id="get-sd-fec-status">
<h3>Get SD-FEC Status<a class="headerlink" href="#get-sd-fec-status" title="Permalink to this headline">¶</a></h3>
<p>Get the SD-FEC status of the device by using the ioctl <a class="reference internal" href="#c.XSDFEC_GET_STATUS" title="XSDFEC_GET_STATUS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_GET_STATUS</span></code></a>, which will fill the <a class="reference internal" href="#c.xsdfec_status" title="xsdfec_status"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xsdfec_status</span></code></a></p>
</section>
<section id="monitor-for-interrupts">
<h3>Monitor for Interrupts<a class="headerlink" href="#monitor-for-interrupts" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>Use the poll system call to monitor for an interrupt. The poll system call waits for an interrupt to wake it up or times out if no interrupt occurs.</p></li>
<li><dl class="simple">
<dt>On return Poll <code class="docutils literal notranslate"><span class="pre">revents</span></code> will indicate whether stats and/or state have been updated</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">POLLPRI</span></code> indicates a critical error and the user should use <a class="reference internal" href="#c.XSDFEC_GET_STATUS" title="XSDFEC_GET_STATUS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_GET_STATUS</span></code></a> and <a class="reference internal" href="#c.XSDFEC_GET_STATS" title="XSDFEC_GET_STATS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_GET_STATS</span></code></a> to confirm</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">POLLRDNORM</span></code> indicates a non-critical error has occurred and the user should use  <a class="reference internal" href="#c.XSDFEC_GET_STATS" title="XSDFEC_GET_STATS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_GET_STATS</span></code></a> to confirm</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Get stats by using the ioctl <a class="reference internal" href="#c.XSDFEC_GET_STATS" title="XSDFEC_GET_STATS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_GET_STATS</span></code></a></dt><dd><ul>
<li><p>For critical error the <code class="docutils literal notranslate"><span class="pre">isr_err_count</span></code> or <code class="docutils literal notranslate"><span class="pre">uecc_count</span></code> member  of <a class="reference internal" href="#c.xsdfec_stats" title="xsdfec_stats"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xsdfec_stats</span></code></a> is non-zero</p></li>
<li><p>For non-critical errors the <code class="docutils literal notranslate"><span class="pre">cecc_count</span></code> member of <a class="reference internal" href="#c.xsdfec_stats" title="xsdfec_stats"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xsdfec_stats</span></code></a> is non-zero</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Get state by using the ioctl <a class="reference internal" href="#c.XSDFEC_GET_STATUS" title="XSDFEC_GET_STATUS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_GET_STATUS</span></code></a></dt><dd><ul>
<li><p>For a critical error the <code class="docutils literal notranslate"><span class="pre">state</span></code> of <a class="reference internal" href="#c.xsdfec_status" title="xsdfec_status"><code class="xref c c-type docutils literal notranslate"><span class="pre">xsdfec_status</span></code></a> will indicate a Reset Is Required</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Clear stats by using the ioctl <a class="reference internal" href="#c.XSDFEC_CLEAR_STATS" title="XSDFEC_CLEAR_STATS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_CLEAR_STATS</span></code></a></p></li>
</ul>
</div></blockquote>
<p>If a critical error is detected where a reset is required. The application is required to call the ioctl <a class="reference internal" href="#c.XSDFEC_SET_DEFAULT_CONFIG" title="XSDFEC_SET_DEFAULT_CONFIG"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_SET_DEFAULT_CONFIG</span></code></a>, after the reset and it is not required to call the ioctl <a class="reference internal" href="#c.XSDFEC_STOP_DEV" title="XSDFEC_STOP_DEV"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_STOP_DEV</span></code></a></p>
<p>Note: Using poll system call prevents busy looping using <a class="reference internal" href="#c.XSDFEC_GET_STATS" title="XSDFEC_GET_STATS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_GET_STATS</span></code></a> and <a class="reference internal" href="#c.XSDFEC_GET_STATUS" title="XSDFEC_GET_STATUS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_GET_STATUS</span></code></a></p>
</section>
<section id="stop-the-sd-fec-core">
<h3>Stop the SD-FEC Core<a class="headerlink" href="#stop-the-sd-fec-core" title="Permalink to this headline">¶</a></h3>
<p>Stop the device by using the ioctl <a class="reference internal" href="#c.XSDFEC_STOP_DEV" title="XSDFEC_STOP_DEV"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_STOP_DEV</span></code></a></p>
</section>
<section id="set-the-default-configuration">
<h3>Set the Default Configuration<a class="headerlink" href="#set-the-default-configuration" title="Permalink to this headline">¶</a></h3>
<p>Load default configuration by using the ioctl <a class="reference internal" href="#c.XSDFEC_SET_DEFAULT_CONFIG" title="XSDFEC_SET_DEFAULT_CONFIG"><code class="xref c c-macro docutils literal notranslate"><span class="pre">XSDFEC_SET_DEFAULT_CONFIG</span></code></a> to restore the driver.</p>
</section>
<section id="limitations">
<h3>Limitations<a class="headerlink" href="#limitations" title="Permalink to this headline">¶</a></h3>
<p>Users should not duplicate SD-FEC device file handlers, for example fork() or dup() a process that has a created an SD-FEC file handler.</p>
</section>
</section>
<section id="driver-ioctls">
<h2>Driver IOCTLs<a class="headerlink" href="#driver-ioctls" title="Permalink to this headline">¶</a></h2>
<dl class="macro">
<dt id="c.XSDFEC_START_DEV">
<code class="sig-name descname">XSDFEC_START_DEV</code><a class="headerlink" href="#c.XSDFEC_START_DEV" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Description</strong></p>
<p>ioctl to start SD-FEC core</p>
<p>This fails if the XSDFEC_SET_ORDER ioctl has not been previously called</p>
<dl class="macro">
<dt id="c.XSDFEC_STOP_DEV">
<code class="sig-name descname">XSDFEC_STOP_DEV</code><a class="headerlink" href="#c.XSDFEC_STOP_DEV" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Description</strong></p>
<p>ioctl to stop the SD-FEC core</p>
<dl class="macro">
<dt id="c.XSDFEC_GET_STATUS">
<code class="sig-name descname">XSDFEC_GET_STATUS</code><a class="headerlink" href="#c.XSDFEC_GET_STATUS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Description</strong></p>
<p>ioctl that returns status of SD-FEC core</p>
<dl class="macro">
<dt id="c.XSDFEC_SET_IRQ">
<code class="sig-name descname">XSDFEC_SET_IRQ</code><a class="headerlink" href="#c.XSDFEC_SET_IRQ" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><strong>struct</strong> xsdfec_irq *</dt><dd><p>Pointer to the <a class="reference internal" href="#c.xsdfec_irq" title="xsdfec_irq"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xsdfec_irq</span></code></a> that contains the interrupt settings
for the SD-FEC core</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>ioctl to enable or disable irq</p>
<dl class="macro">
<dt id="c.XSDFEC_SET_TURBO">
<code class="sig-name descname">XSDFEC_SET_TURBO</code><a class="headerlink" href="#c.XSDFEC_SET_TURBO" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><strong>struct</strong> xsdfec_turbo *</dt><dd><p>Pointer to the <a class="reference internal" href="#c.xsdfec_turbo" title="xsdfec_turbo"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xsdfec_turbo</span></code></a> that contains the Turbo decode
settings for the SD-FEC core</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>ioctl that sets the SD-FEC Turbo parameter values</p>
<p>This can only be used when the driver is in the XSDFEC_STOPPED state</p>
<dl class="macro">
<dt id="c.XSDFEC_ADD_LDPC_CODE_PARAMS">
<code class="sig-name descname">XSDFEC_ADD_LDPC_CODE_PARAMS</code><a class="headerlink" href="#c.XSDFEC_ADD_LDPC_CODE_PARAMS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><strong>struct</strong> xsdfec_ldpc_params *</dt><dd><p>Pointer to the <a class="reference internal" href="#c.xsdfec_ldpc_params" title="xsdfec_ldpc_params"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xsdfec_ldpc_params</span></code></a> that contains the LDPC code
parameters to be added to the SD-FEC Block</p>
</dd>
</dl>
<p><strong>Description</strong>
ioctl to add an LDPC code to the SD-FEC LDPC codes</p>
<p>This can only be used when:</p>
<ul class="simple">
<li><p>Driver is in the XSDFEC_STOPPED state</p></li>
<li><p>SD-FEC core is configured as LPDC</p></li>
<li><p>SD-FEC Code Write Protection is disabled</p></li>
</ul>
<dl class="macro">
<dt id="c.XSDFEC_GET_CONFIG">
<code class="sig-name descname">XSDFEC_GET_CONFIG</code><a class="headerlink" href="#c.XSDFEC_GET_CONFIG" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><strong>struct</strong> xsdfec_config *</dt><dd><p>Pointer to the <a class="reference internal" href="#c.xsdfec_config" title="xsdfec_config"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xsdfec_config</span></code></a> that contains the current
configuration settings of the SD-FEC Block</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>ioctl that returns SD-FEC core configuration</p>
<dl class="macro">
<dt id="c.XSDFEC_SET_ORDER">
<code class="sig-name descname">XSDFEC_SET_ORDER</code><a class="headerlink" href="#c.XSDFEC_SET_ORDER" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><strong>struct</strong> unsigned long *</dt><dd><p>Pointer to the unsigned long that contains a value from the
<strong>enum</strong> xsdfec_order</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>ioctl that sets order, if order of blocks can change from input to output</p>
<p>This can only be used when the driver is in the XSDFEC_STOPPED state</p>
<dl class="macro">
<dt id="c.XSDFEC_SET_BYPASS">
<code class="sig-name descname">XSDFEC_SET_BYPASS</code><a class="headerlink" href="#c.XSDFEC_SET_BYPASS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><strong>struct</strong> bool *</dt><dd><p>Pointer to bool that sets the bypass value, where false results in
normal operation and false results in the SD-FEC performing the
configured operations (same number of cycles) but output data matches
the input data</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>ioctl that sets bypass.</p>
<p>This can only be used when the driver is in the XSDFEC_STOPPED state</p>
<dl class="macro">
<dt id="c.XSDFEC_IS_ACTIVE">
<code class="sig-name descname">XSDFEC_IS_ACTIVE</code><a class="headerlink" href="#c.XSDFEC_IS_ACTIVE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><strong>struct</strong> bool *</dt><dd><p>Pointer to bool that returns true if the SD-FEC is processing data</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>ioctl that determines if SD-FEC is processing data</p>
<dl class="macro">
<dt id="c.XSDFEC_CLEAR_STATS">
<code class="sig-name descname">XSDFEC_CLEAR_STATS</code><a class="headerlink" href="#c.XSDFEC_CLEAR_STATS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Description</strong></p>
<p>ioctl that clears error stats collected during interrupts</p>
<dl class="macro">
<dt id="c.XSDFEC_GET_STATS">
<code class="sig-name descname">XSDFEC_GET_STATS</code><a class="headerlink" href="#c.XSDFEC_GET_STATS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><strong>struct</strong> xsdfec_stats *</dt><dd><p>Pointer to the <a class="reference internal" href="#c.xsdfec_stats" title="xsdfec_stats"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xsdfec_stats</span></code></a> that will contain the updated stats
values</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>ioctl that returns SD-FEC core stats</p>
<p>This can only be used when the driver is in the XSDFEC_STOPPED state</p>
<dl class="macro">
<dt id="c.XSDFEC_SET_DEFAULT_CONFIG">
<code class="sig-name descname">XSDFEC_SET_DEFAULT_CONFIG</code><a class="headerlink" href="#c.XSDFEC_SET_DEFAULT_CONFIG" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Description</strong></p>
<p>ioctl that returns SD-FEC core to default config, use after a reset</p>
<p>This can only be used when the driver is in the XSDFEC_STOPPED state</p>
</section>
<section id="driver-type-definitions">
<h2>Driver Type Definitions<a class="headerlink" href="#driver-type-definitions" title="Permalink to this headline">¶</a></h2>
<dl class="type">
<dt id="c.xsdfec_code">
enum <code class="sig-name descname">xsdfec_code</code><a class="headerlink" href="#c.xsdfec_code" title="Permalink to this definition">¶</a></dt>
<dd><p>Code Type.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Constants</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XSDFEC_TURBO_CODE</span></code></dt><dd><p>Driver is configured for Turbo mode.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XSDFEC_LDPC_CODE</span></code></dt><dd><p>Driver is configured for LDPC mode.</p>
</dd>
</dl>
</div>
<p><strong>Description</strong></p>
<p>This enum is used to indicate the mode of the driver. The mode is determined
by checking which codes are set in the driver. Note that the mode cannot be
changed by the driver.</p>
<dl class="type">
<dt id="c.xsdfec_order">
enum <code class="sig-name descname">xsdfec_order</code><a class="headerlink" href="#c.xsdfec_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Order</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Constants</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XSDFEC_MAINTAIN_ORDER</span></code></dt><dd><p>Maintain order execution of blocks.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XSDFEC_OUT_OF_ORDER</span></code></dt><dd><p>Out-of-order execution of blocks.</p>
</dd>
</dl>
</div>
<p><strong>Description</strong></p>
<p>This enum is used to indicate whether the order of blocks can change from
input to output.</p>
<dl class="type">
<dt id="c.xsdfec_turbo_alg">
enum <code class="sig-name descname">xsdfec_turbo_alg</code><a class="headerlink" href="#c.xsdfec_turbo_alg" title="Permalink to this definition">¶</a></dt>
<dd><p>Turbo Algorithm Type.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Constants</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XSDFEC_MAX_SCALE</span></code></dt><dd><p>Max Log-Map algorithm with extrinsic scaling. When
scaling is set to this is equivalent to the Max Log-Map
algorithm.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XSDFEC_MAX_STAR</span></code></dt><dd><p>Log-Map algorithm.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XSDFEC_TURBO_ALG_MAX</span></code></dt><dd><p>Used to indicate out of bound Turbo algorithms.</p>
</dd>
</dl>
</div>
<p><strong>Description</strong></p>
<p>This enum specifies which Turbo Decode algorithm is in use.</p>
<dl class="type">
<dt id="c.xsdfec_state">
enum <code class="sig-name descname">xsdfec_state</code><a class="headerlink" href="#c.xsdfec_state" title="Permalink to this definition">¶</a></dt>
<dd><p>State.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Constants</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XSDFEC_INIT</span></code></dt><dd><p>Driver is initialized.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XSDFEC_STARTED</span></code></dt><dd><p>Driver is started.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XSDFEC_STOPPED</span></code></dt><dd><p>Driver is stopped.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XSDFEC_NEEDS_RESET</span></code></dt><dd><p>Driver needs to be reset.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XSDFEC_PL_RECONFIGURE</span></code></dt><dd><p>Programmable Logic needs to be recofigured.</p>
</dd>
</dl>
</div>
<p><strong>Description</strong></p>
<p>This enum is used to indicate the state of the driver.</p>
<dl class="type">
<dt id="c.xsdfec_axis_width">
enum <code class="sig-name descname">xsdfec_axis_width</code><a class="headerlink" href="#c.xsdfec_axis_width" title="Permalink to this definition">¶</a></dt>
<dd><p>AXIS_WIDTH.DIN Setting for 128-bit width.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Constants</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XSDFEC_1x128b</span></code></dt><dd><p>DIN data input stream consists of a 128-bit lane</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XSDFEC_2x128b</span></code></dt><dd><p>DIN data input stream consists of two 128-bit lanes</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XSDFEC_4x128b</span></code></dt><dd><p>DIN data input stream consists of four 128-bit lanes</p>
</dd>
</dl>
</div>
<p><strong>Description</strong></p>
<p>This enum is used to indicate the AXIS_WIDTH.DIN setting for 128-bit width.
The number of lanes of the DIN data input stream depends upon the
AXIS_WIDTH.DIN parameter.</p>
<dl class="type">
<dt id="c.xsdfec_axis_word_include">
enum <code class="sig-name descname">xsdfec_axis_word_include</code><a class="headerlink" href="#c.xsdfec_axis_word_include" title="Permalink to this definition">¶</a></dt>
<dd><p>Words Configuration.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Constants</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XSDFEC_FIXED_VALUE</span></code></dt><dd><p>Fixed, the DIN_WORDS AXI4-Stream interface is removed
from the IP instance and is driven with the specified
number of words.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XSDFEC_IN_BLOCK</span></code></dt><dd><p>In Block, configures the IP instance to expect a single
DIN_WORDS value per input code block. The DIN_WORDS
interface is present.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XSDFEC_PER_AXI_TRANSACTION</span></code></dt><dd><p>Per Transaction, configures the IP instance to
expect one DIN_WORDS value per input transaction on the DIN interface. The
DIN_WORDS interface is present.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XSDFEC_AXIS_WORDS_INCLUDE_MAX</span></code></dt><dd><p>Used to indicate out of bound Words
Configurations.</p>
</dd>
</dl>
</div>
<p><strong>Description</strong></p>
<p>This enum is used to specify the DIN_WORDS configuration.</p>
<dl class="type">
<dt id="c.xsdfec_turbo">
struct <code class="sig-name descname">xsdfec_turbo</code><a class="headerlink" href="#c.xsdfec_turbo" title="Permalink to this definition">¶</a></dt>
<dd><p>User data for Turbo codes.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct xsdfec_turbo {
    __u32 alg;
    __u8 scale;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">alg</span></code></dt><dd><p>Specifies which Turbo decode algorithm to use</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">scale</span></code></dt><dd><p>Specifies the extrinsic scaling to apply when the Max Scale algorithm
has been selected</p>
</dd>
</dl>
</div>
<p><strong>Description</strong></p>
<p>Turbo code structure to communicate parameters to XSDFEC driver.</p>
<dl class="type">
<dt id="c.xsdfec_ldpc_params">
struct <code class="sig-name descname">xsdfec_ldpc_params</code><a class="headerlink" href="#c.xsdfec_ldpc_params" title="Permalink to this definition">¶</a></dt>
<dd><p>User data for LDPC codes.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct xsdfec_ldpc_params {
    __u32 n;
    __u32 k;
    __u32 psize;
    __u32 nlayers;
    __u32 nqc;
    __u32 nmqc;
    __u32 nm;
    __u32 norm_type;
    __u32 no_packing;
    __u32 special_qc;
    __u32 no_final_parity;
    __u32 max_schedule;
    __u32 sc_off;
    __u32 la_off;
    __u32 qc_off;
    __u32 *sc_table;
    __u32 *la_table;
    __u32 *qc_table;
    __u16 code_id;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">n</span></code></dt><dd><p>Number of code word bits</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">k</span></code></dt><dd><p>Number of information bits</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">psize</span></code></dt><dd><p>Size of sub-matrix</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">nlayers</span></code></dt><dd><p>Number of layers in code</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">nqc</span></code></dt><dd><p>Quasi Cyclic Number</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">nmqc</span></code></dt><dd><p>Number of M-sized QC operations in parity check matrix</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">nm</span></code></dt><dd><p>Number of M-size vectors in N</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">norm_type</span></code></dt><dd><p>Normalization required or not</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">no_packing</span></code></dt><dd><p>Determines if multiple QC ops should be performed</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">special_qc</span></code></dt><dd><p>Sub-Matrix property for Circulant weight &gt; 0</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">no_final_parity</span></code></dt><dd><p>Decide if final parity check needs to be performed</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">max_schedule</span></code></dt><dd><p>Experimental code word scheduling limit</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">sc_off</span></code></dt><dd><p>SC offset</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">la_off</span></code></dt><dd><p>LA offset</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">qc_off</span></code></dt><dd><p>QC offset</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">sc_table</span></code></dt><dd><p>Pointer to SC Table which must be page aligned</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">la_table</span></code></dt><dd><p>Pointer to LA Table which must be page aligned</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">qc_table</span></code></dt><dd><p>Pointer to QC Table which must be page aligned</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">code_id</span></code></dt><dd><p>LDPC Code</p>
</dd>
</dl>
</div>
<p><strong>Description</strong></p>
<p>This structure describes the LDPC code that is passed to the driver by the
application.</p>
<dl class="type">
<dt id="c.xsdfec_status">
struct <code class="sig-name descname">xsdfec_status</code><a class="headerlink" href="#c.xsdfec_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Status of SD-FEC core.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct xsdfec_status {
    __u32 state;
    __s8 activity;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">state</span></code></dt><dd><p>State of the SD-FEC core</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">activity</span></code></dt><dd><p>Describes if the SD-FEC instance is Active</p>
</dd>
</dl>
</div>
<dl class="type">
<dt id="c.xsdfec_irq">
struct <code class="sig-name descname">xsdfec_irq</code><a class="headerlink" href="#c.xsdfec_irq" title="Permalink to this definition">¶</a></dt>
<dd><p>Enabling or Disabling Interrupts.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct xsdfec_irq {
    __s8 enable_isr;
    __s8 enable_ecc_isr;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">enable_isr</span></code></dt><dd><p>If true enables the ISR</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">enable_ecc_isr</span></code></dt><dd><p>If true enables the ECC ISR</p>
</dd>
</dl>
</div>
<dl class="type">
<dt id="c.xsdfec_config">
struct <code class="sig-name descname">xsdfec_config</code><a class="headerlink" href="#c.xsdfec_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration of SD-FEC core.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct xsdfec_config {
    __u32 code;
    __u32 order;
    __u32 din_width;
    __u32 din_word_include;
    __u32 dout_width;
    __u32 dout_word_include;
    struct xsdfec_irq irq;
    __s8 bypass;
    __s8 code_wr_protect;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">code</span></code></dt><dd><p>The codes being used by the SD-FEC instance</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">order</span></code></dt><dd><p>Order of Operation</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">din_width</span></code></dt><dd><p>Width of the DIN AXI4-Stream</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">din_word_include</span></code></dt><dd><p>How DIN_WORDS are inputted</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dout_width</span></code></dt><dd><p>Width of the DOUT AXI4-Stream</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dout_word_include</span></code></dt><dd><p>HOW DOUT_WORDS are outputted</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">irq</span></code></dt><dd><p>Enabling or disabling interrupts</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">bypass</span></code></dt><dd><p>Is the core being bypassed</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">code_wr_protect</span></code></dt><dd><p>Is write protection of LDPC codes enabled</p>
</dd>
</dl>
</div>
<dl class="type">
<dt id="c.xsdfec_stats">
struct <code class="sig-name descname">xsdfec_stats</code><a class="headerlink" href="#c.xsdfec_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Stats retrived by ioctl XSDFEC_GET_STATS. Used to buffer atomic_t variables from struct xsdfec_dev. Counts are accumulated until the user clears them.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct xsdfec_stats {
    __u32 isr_err_count;
    __u32 cecc_count;
    __u32 uecc_count;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">isr_err_count</span></code></dt><dd><p>Count of ISR errors</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">cecc_count</span></code></dt><dd><p>Count of Correctable ECC errors (SBE)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">uecc_count</span></code></dt><dd><p>Count of Uncorrectable ECC errors (MBE)</p>
</dd>
</dl>
</div>
<dl class="type">
<dt id="c.xsdfec_ldpc_param_table_sizes">
struct <code class="sig-name descname">xsdfec_ldpc_param_table_sizes</code><a class="headerlink" href="#c.xsdfec_ldpc_param_table_sizes" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to store sizes of SD-FEC table entries for an individual LPDC code parameter.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct xsdfec_ldpc_param_table_sizes {
    __u32 sc_size;
    __u32 la_size;
    __u32 qc_size;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">sc_size</span></code></dt><dd><p>Size of SC table used</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">la_size</span></code></dt><dd><p>Size of LA table used</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">qc_size</span></code></dt><dd><p>Size of QC table used</p>
</dd>
</dl>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Xilinx SD-FEC Driver</a><ul>
<li><a class="reference internal" href="#overview">Overview</a><ul>
<li><a class="reference internal" href="#modes-of-operation">Modes of Operation</a><ul>
<li><a class="reference internal" href="#run-time-configuration">Run-time Configuration</a></li>
<li><a class="reference internal" href="#programmable-logic-pl-initialization">Programmable Logic (PL) Initialization</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#driver-structure">Driver Structure</a></li>
<li><a class="reference internal" href="#driver-usage">Driver Usage</a><ul>
<li><a class="reference internal" href="#id1">Overview</a></li>
<li><a class="reference internal" href="#determine-configuration">Determine Configuration</a></li>
<li><a class="reference internal" href="#set-the-order">Set the Order</a></li>
<li><a class="reference internal" href="#add-ldpc-codes">Add LDPC Codes</a></li>
<li><a class="reference internal" href="#set-turbo-decode">Set Turbo Decode</a></li>
<li><a class="reference internal" href="#enable-interrupts">Enable Interrupts</a></li>
<li><a class="reference internal" href="#bypass-the-sd-fec">Bypass the SD-FEC</a></li>
<li><a class="reference internal" href="#start-the-sd-fec-core">Start the SD-FEC core</a></li>
<li><a class="reference internal" href="#get-sd-fec-status">Get SD-FEC Status</a></li>
<li><a class="reference internal" href="#monitor-for-interrupts">Monitor for Interrupts</a></li>
<li><a class="reference internal" href="#stop-the-sd-fec-core">Stop the SD-FEC Core</a></li>
<li><a class="reference internal" href="#set-the-default-configuration">Set the Default Configuration</a></li>
<li><a class="reference internal" href="#limitations">Limitations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#driver-ioctls">Driver IOCTLs</a></li>
<li><a class="reference internal" href="#driver-type-definitions">Driver Type Definitions</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/misc-devices/xilinx_sdfec.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/misc-devices/xilinx_sdfec.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>