
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>NetLabel CIPSO/IPv4 Protocol Engine &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="NetLabel Linux Security Module Interface" href="lsm_interface.html" />
    <link rel="prev" title="NetLabel Introduction" href="introduction.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="netlabel-cipso-ipv4-protocol-engine">
<h1>NetLabel CIPSO/IPv4 Protocol Engine<a class="headerlink" href="#netlabel-cipso-ipv4-protocol-engine" title="Permalink to this headline">¶</a></h1>
<p>Paul Moore, <a class="reference external" href="mailto:paul&#46;moore&#37;&#52;&#48;hp&#46;com">paul<span>&#46;</span>moore<span>&#64;</span>hp<span>&#46;</span>com</a></p>
<p>May 17, 2006</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The NetLabel CIPSO/IPv4 protocol engine is based on the IETF Commercial
IP Security Option (CIPSO) draft from July 16, 1992.  A copy of this
draft can be found in this directory
(draft-ietf-cipso-ipsecurity-01.txt).  While the IETF draft never made
it to an RFC standard it has become a de-facto standard for labeled
networking and is used in many trusted operating systems.</p>
</section>
<section id="outbound-packet-processing">
<h2>Outbound Packet Processing<a class="headerlink" href="#outbound-packet-processing" title="Permalink to this headline">¶</a></h2>
<p>The CIPSO/IPv4 protocol engine applies the CIPSO IP option to packets by
adding the CIPSO label to the socket.  This causes all packets leaving the
system through the socket to have the CIPSO IP option applied.  The socket’s
CIPSO label can be changed at any point in time, however, it is recommended
that it is set upon the socket’s creation.  The LSM can set the socket’s CIPSO
label by using the NetLabel security module API; if the NetLabel “domain” is
configured to use CIPSO for packet labeling then a CIPSO IP option will be
generated and attached to the socket.</p>
</section>
<section id="inbound-packet-processing">
<h2>Inbound Packet Processing<a class="headerlink" href="#inbound-packet-processing" title="Permalink to this headline">¶</a></h2>
<p>The CIPSO/IPv4 protocol engine validates every CIPSO IP option it finds at the
IP layer without any special handling required by the LSM.  However, in order
to decode and translate the CIPSO label on the packet the LSM must use the
NetLabel security module API to extract the security attributes of the packet.
This is typically done at the socket layer using the ‘socket_sock_rcv_skb()’
LSM hook.</p>
</section>
<section id="label-translation">
<h2>Label Translation<a class="headerlink" href="#label-translation" title="Permalink to this headline">¶</a></h2>
<p>The CIPSO/IPv4 protocol engine contains a mechanism to translate CIPSO security
attributes such as sensitivity level and category to values which are
appropriate for the host.  These mappings are defined as part of a CIPSO
Domain Of Interpretation (DOI) definition and are configured through the
NetLabel user space communication layer.  Each DOI definition can have a
different security attribute mapping table.</p>
</section>
<section id="label-translation-cache">
<h2>Label Translation Cache<a class="headerlink" href="#label-translation-cache" title="Permalink to this headline">¶</a></h2>
<p>The NetLabel system provides a framework for caching security attribute
mappings from the network labels to the corresponding LSM identifiers.  The
CIPSO/IPv4 protocol engine supports this caching mechanism.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">NetLabel CIPSO/IPv4 Protocol Engine</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#outbound-packet-processing">Outbound Packet Processing</a></li>
<li><a class="reference internal" href="#inbound-packet-processing">Inbound Packet Processing</a></li>
<li><a class="reference internal" href="#label-translation">Label Translation</a></li>
<li><a class="reference internal" href="#label-translation-cache">Label Translation Cache</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/netlabel/cipso_ipv4.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/netlabel/cipso_ipv4.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>