
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>16. Walkera WK-0701 transmitter &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="17. xpad - Linux USB driver for Xbox compatible controllers" href="xpad.html" />
    <link rel="prev" title="15. Sentelic Touchpad" href="sentelic.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="walkera-wk-0701-transmitter">
<h1><span class="section-number">16. </span>Walkera WK-0701 transmitter<a class="headerlink" href="#walkera-wk-0701-transmitter" title="Permalink to this headline">¶</a></h1>
<p>Walkera WK-0701 transmitter is supplied with a ready to fly Walkera
helicopters such as HM36, HM37, HM60. The walkera0701 module enables to use
this transmitter as joystick</p>
<p>Devel homepage and download:
<a class="reference external" href="http://zub.fei.tuke.sk/walkera-wk0701/">http://zub.fei.tuke.sk/walkera-wk0701/</a></p>
<p>or use cogito:
cg-clone <a class="reference external" href="http://zub.fei.tuke.sk/GIT/walkera0701-joystick">http://zub.fei.tuke.sk/GIT/walkera0701-joystick</a></p>
<section id="connecting-to-pc">
<h2><span class="section-number">16.1. </span>Connecting to PC<a class="headerlink" href="#connecting-to-pc" title="Permalink to this headline">¶</a></h2>
<p>At back side of transmitter S-video connector can be found. Modulation
pulses from processor to HF part can be found at pin 2 of this connector,
pin 3 is GND. Between pin 3 and CPU 5k6 resistor can be found. To get
modulation pulses to PC, signal pulses must be amplified.</p>
<p>Cable: (walkera TX to parport)</p>
<p>Walkera WK-0701 TX S-VIDEO connector:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(back side of TX)
    __   __              S-video:                                  canon25
   /  |_|  \             pin 2 (signal)              NPN           parport
  / O 4 3 O \            pin 3 (GND)        LED        ________________  10 ACK
 ( O 2   1 O )                                         | C
  \   ___   /      2 ________________________|\|_____|/
   | [___] |                                 |/|   B |\
    -------        3 __________________________________|________________ 25 GND
                                                         E
</pre></div>
</div>
<p>I use green LED and BC109 NPN transistor.</p>
</section>
<section id="software">
<h2><span class="section-number">16.2. </span>Software<a class="headerlink" href="#software" title="Permalink to this headline">¶</a></h2>
<p>Build kernel with walkera0701 module. Module walkera0701 need exclusive
access to parport, modules like lp must be unloaded before loading
walkera0701 module, check dmesg for error messages. Connect TX to PC by
cable and run jstest /dev/input/js0 to see values from TX. If no value can
be changed by TX “joystick”, check output from /proc/interrupts. Value for
(usually irq7) parport must increase if TX is on.</p>
</section>
<section id="technical-details">
<h2><span class="section-number">16.3. </span>Technical details<a class="headerlink" href="#technical-details" title="Permalink to this headline">¶</a></h2>
<p>Driver use interrupt from parport ACK input bit to measure pulse length
using hrtimers.</p>
<p>Frame format:
Based on walkera WK-0701 PCM Format description by Shaul Eizikovich.
(downloaded from <a class="reference external" href="http://www.smartpropoplus.com/Docs/Walkera_Wk-0701_PCM.pdf">http://www.smartpropoplus.com/Docs/Walkera_Wk-0701_PCM.pdf</a>)</p>
<section id="signal-pulses">
<h3><span class="section-number">16.3.1. </span>Signal pulses<a class="headerlink" href="#signal-pulses" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>                   (ANALOG)
    SYNC      BIN   OCT
  +---------+      +------+
  |         |      |      |
--+         +------+      +---
</pre></div>
</div>
</section>
<section id="frame">
<h3><span class="section-number">16.3.2. </span>Frame<a class="headerlink" href="#frame" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>SYNC , BIN1, OCT1, BIN2, OCT2 ... BIN24, OCT24, BIN25, next frame SYNC ..
</pre></div>
</div>
</section>
<section id="pulse-length">
<h3><span class="section-number">16.3.3. </span>pulse length<a class="headerlink" href="#pulse-length" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> Binary values:               Analog octal values:

 288 uS Binary 0              318 uS       000
 438 uS Binary 1              398 uS       001
                              478 uS       010
                              558 uS       011
                              638 uS       100
1306 uS SYNC                  718 uS       101
                              798 uS       110
                              878 uS       111
</pre></div>
</div>
<p>24 bin+oct values + 1 bin value = 24*4+1 bits  = 97 bits</p>
<p>(Warning, pulses on ACK are inverted by transistor, irq is raised up on sync
to bin change or octal value to bin change).</p>
</section>
<section id="binary-data-representations">
<h3><span class="section-number">16.3.4. </span>Binary data representations<a class="headerlink" href="#binary-data-representations" title="Permalink to this headline">¶</a></h3>
<p>One binary and octal value can be grouped to nibble. 24 nibbles + one binary
values can be sampled between sync pulses.</p>
<p>Values for first four channels (analog joystick values) can be found in
first 10 nibbles. Analog value is represented by one sign bit and 9 bit
absolute binary value. (10 bits per channel). Next nibble is checksum for
first ten nibbles.</p>
<p>Next nibbles 12 .. 21 represents four channels (not all channels can be
directly controlled from TX). Binary representations are the same as in first
four channels. In nibbles 22 and 23 is a special magic number. Nibble 24 is
checksum for nibbles 12..23.</p>
<p>After last octal value for nibble 24 and next sync pulse one additional
binary value can be sampled. This bit and magic number is not used in
software driver. Some details about this magic numbers can be found in
Walkera_Wk-0701_PCM.pdf.</p>
</section>
<section id="checksum-calculation">
<h3><span class="section-number">16.3.5. </span>Checksum calculation<a class="headerlink" href="#checksum-calculation" title="Permalink to this headline">¶</a></h3>
<p>Summary of octal values in nibbles must be same as octal value in checksum
nibble (only first 3 bits are used). Binary value for checksum nibble is
calculated by sum of binary values in checked nibbles + sum of octal values
in checked nibbles divided by 8. Only bit 0 of this sum is used.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">16. Walkera WK-0701 transmitter</a><ul>
<li><a class="reference internal" href="#connecting-to-pc">16.1. Connecting to PC</a></li>
<li><a class="reference internal" href="#software">16.2. Software</a></li>
<li><a class="reference internal" href="#technical-details">16.3. Technical details</a><ul>
<li><a class="reference internal" href="#signal-pulses">16.3.1. Signal pulses</a></li>
<li><a class="reference internal" href="#frame">16.3.2. Frame</a></li>
<li><a class="reference internal" href="#pulse-length">16.3.3. pulse length</a></li>
<li><a class="reference internal" href="#binary-data-representations">16.3.4. Binary data representations</a></li>
<li><a class="reference internal" href="#checksum-calculation">16.3.5. Checksum calculation</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/input/devices/walkera0701.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/input/devices/walkera0701.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>