
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Linux Security Module Development &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Linux Secure Attention Key (SAK) handling" href="sak.html" />
    <link rel="prev" title="Linux Security Modules: General Security Hooks for Linux" href="lsm.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="linux-security-module-development">
<h1>Linux Security Module Development<a class="headerlink" href="#linux-security-module-development" title="Permalink to this headline">¶</a></h1>
<p>Based on <a class="reference external" href="https://lore.kernel.org/r/20071026073721.618b4778&#64;laptopd505.fenrus.org">https://lore.kernel.org/r/20071026073721.618b4778&#64;laptopd505.fenrus.org</a>,
a new LSM is accepted into the kernel when its intent (a description of
what it tries to protect against and in what cases one would expect to
use it) has been appropriately documented in <code class="docutils literal notranslate"><span class="pre">Documentation/admin-guide/LSM/</span></code>.
This allows an LSM’s code to be easily compared to its goals, and so
that end users and distros can make a more informed decision about which
LSMs suit their requirements.</p>
<p>For extensive documentation on the available LSM hook interfaces, please
see <code class="docutils literal notranslate"><span class="pre">include/linux/lsm_hooks.h</span></code> and associated structures:</p>
<dl class="type">
<dt id="c.security_list_options">
union <code class="sig-name descname">security_list_options</code><a class="headerlink" href="#c.security_list_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Linux Security Module hook function list</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>union security_list_options {
#define LSM_HOOK(RET, DEFAULT, NAME, ...) RET (*NAME)(__VA_ARGS__);
    ;
#include &quot;lsm_hook_defs.h&quot;;
#undef LSM_HOOK;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
</div>
<p><strong>Description</strong></p>
<p>Security hooks for program execution operations.</p>
<dl class="simple">
<dt>Security hooks for mount using fs_context.</dt><dd><p>[See also <a class="reference internal" href="../filesystems/mount_api.html"><span class="doc">Filesystem Mount API</span></a>]</p>
</dd>
</dl>
<p>Security hooks for filesystem operations.</p>
<p>Security hooks for inode operations.</p>
<p>Security hooks for kernfs node operations</p>
<p>Security hooks for file operations</p>
<p>Security hooks for task operations.</p>
<p>Security hooks for Netlink messaging.</p>
<p>Security hooks for Unix domain networking.</p>
<p>The <strong>unix_stream_connect</strong> and <strong>unix_may_send</strong> hooks were necessary because
Linux provides an alternative to the conventional file name space for Unix
domain sockets.  Whereas binding and connecting to sockets in the file name
space is mediated by the typical file permissions (and caught by the mknod
and permission hooks in inode_security_ops), binding and connecting to
sockets in the abstract name space is completely unmediated.  Sufficient
control of Unix domain sockets in the abstract name space isn’t possible
using only the socket layer hooks, since we need to know the actual target
socket, which is not looked up until we are inside the af_unix code.</p>
<p>Security hooks for socket operations.</p>
<p>Security hooks for SCTP</p>
<p>Security hooks for Infiniband</p>
<p>Security hooks for XFRM operations.</p>
<p>Security hooks affecting all Key Management operations</p>
<p>Security hooks affecting all System V IPC operations.</p>
<p>Security hooks for individual messages held in System V IPC message queues</p>
<p>Security hooks for System V IPC Message Queues</p>
<p>Security hooks for System V Shared Memory Segments</p>
<p>Security hooks for System V Semaphores</p>
<p>Security hooks for Audit</p>
<p>Security hooks for the general notification queue:</p>
<p>Security hooks for using the eBPF maps and programs functionalities through
eBPF syscalls.</p>
<p>Security hooks for perf events</p>
<p>Security hooks for io_uring</p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/security/lsm-development.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/security/lsm-development.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>