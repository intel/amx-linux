
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Linux Secure Attention Key (SAK) handling &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SCTP" href="SCTP.html" />
    <link rel="prev" title="Linux Security Module Development" href="lsm-development.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="linux-secure-attention-key-sak-handling">
<h1>Linux Secure Attention Key (SAK) handling<a class="headerlink" href="#linux-secure-attention-key-sak-handling" title="Permalink to this headline">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Date</dt>
<dd class="field-odd"><p>18 March 2001</p>
</dd>
<dt class="field-even">Author</dt>
<dd class="field-even"><p>Andrew Morton</p>
</dd>
</dl>
<p>An operating system’s Secure Attention Key is a security tool which is
provided as protection against trojan password capturing programs.  It
is an undefeatable way of killing all programs which could be
masquerading as login applications.  Users need to be taught to enter
this key sequence before they log in to the system.</p>
<p>From the PC keyboard, Linux has two similar but different ways of
providing SAK.  One is the ALT-SYSRQ-K sequence.  You shouldn’t use
this sequence.  It is only available if the kernel was compiled with
sysrq support.</p>
<p>The proper way of generating a SAK is to define the key sequence using
<code class="docutils literal notranslate"><span class="pre">loadkeys</span></code>.  This will work whether or not sysrq support is compiled
into the kernel.</p>
<p>SAK works correctly when the keyboard is in raw mode.  This means that
once defined, SAK will kill a running X server.  If the system is in
run level 5, the X server will restart.  This is what you want to
happen.</p>
<p>What key sequence should you use? Well, CTRL-ALT-DEL is used to reboot
the machine.  CTRL-ALT-BACKSPACE is magical to the X server.  We’ll
choose CTRL-ALT-PAUSE.</p>
<p>In your rc.sysinit (or rc.local) file, add the command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>echo &quot;control alt keycode 101 = SAK&quot; | /bin/loadkeys
</pre></div>
</div>
<p>And that’s it!  Only the superuser may reprogram the SAK key.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic">
<li><p>Linux SAK is said to be not a “true SAK” as is required by
systems which implement C2 level security.  This author does not
know why.</p></li>
<li><p>On the PC keyboard, SAK kills all applications which have
/dev/console opened.</p>
<p>Unfortunately this includes a number of things which you don’t
actually want killed.  This is because these applications are
incorrectly holding /dev/console open.  Be sure to complain to your
Linux distributor about this!</p>
<p>You can identify processes which will be killed by SAK with the
command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ls -l /proc/[0-9]*/fd/* | grep console
l-wx------    1 root     root           64 Mar 18 00:46 /proc/579/fd/0 -&gt; /dev/console
</pre></div>
</div>
<p>Then:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ps aux|grep 579
root       579  0.0  0.1  1088  436 ?        S    00:43   0:00 gpm -t ps/2
</pre></div>
</div>
<p>So <code class="docutils literal notranslate"><span class="pre">gpm</span></code> will be killed by SAK.  This is a bug in gpm.  It should
be closing standard input.  You can work around this by finding the
initscript which launches gpm and changing it thusly:</p>
<p>Old:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>daemon gpm
</pre></div>
</div>
<p>New:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>daemon gpm &lt; /dev/null
</pre></div>
</div>
<p>Vixie cron also seems to have this problem, and needs the same treatment.</p>
<p>Also, one prominent Linux distribution has the following three
lines in its rc.sysinit and rc scripts:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>exec 3&lt;&amp;0
exec 4&gt;&amp;1
exec 5&gt;&amp;2
</pre></div>
</div>
<p>These commands cause <strong>all</strong> daemons which are launched by the
initscripts to have file descriptors 3, 4 and 5 attached to
/dev/console.  So SAK kills them all.  A workaround is to simply
delete these lines, but this may cause system management
applications to malfunction - test everything well.</p>
</li>
</ol>
</div>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/security/sak.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/security/sak.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>