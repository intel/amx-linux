
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Kernel driver mlxreg-fan &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Kernel driver mp2888" href="mp2888.html" />
    <link rel="prev" title="Kernel driver menf21bmc_hwmon" href="menf21bmc.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="kernel-driver-mlxreg-fan">
<h1>Kernel driver mlxreg-fan<a class="headerlink" href="#kernel-driver-mlxreg-fan" title="Permalink to this headline">¶</a></h1>
<p>Provides FAN control for the next Mellanox systems:</p>
<ul class="simple">
<li><p>QMB700, equipped with 40x200GbE InfiniBand ports;</p></li>
<li><p>MSN3700, equipped with 32x200GbE or 16x400GbE Ethernet ports;</p></li>
<li><p>MSN3410, equipped with 6x400GbE plus 48x50GbE Ethernet ports;</p></li>
<li><p>MSN3800, equipped with 64x1000GbE Ethernet ports;</p></li>
</ul>
<p>Author: Vadim Pasternak &lt;<a class="reference external" href="mailto:vadimp&#37;&#52;&#48;mellanox&#46;com">vadimp<span>&#64;</span>mellanox<span>&#46;</span>com</a>&gt;</p>
<p>These are the Top of the Rack systems, equipped with Mellanox switch
board with Mellanox Quantum or Spectrume-2 devices.
FAN controller is implemented by the programmable device logic.</p>
<p>The default registers offsets set within the programmable device is as
following:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 85%" />
<col style="width: 15%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>pwm1</p></td>
<td><p>0xe3</p></td>
</tr>
<tr class="row-even"><td><p>fan1 (tacho1)</p></td>
<td><p>0xe4</p></td>
</tr>
<tr class="row-odd"><td><p>fan2 (tacho2)</p></td>
<td><p>0xe5</p></td>
</tr>
<tr class="row-even"><td><p>fan3 (tacho3)</p></td>
<td><p>0xe6</p></td>
</tr>
<tr class="row-odd"><td><p>fan4 (tacho4)</p></td>
<td><p>0xe7</p></td>
</tr>
<tr class="row-even"><td><p>fan5 (tacho5)</p></td>
<td><p>0xe8</p></td>
</tr>
<tr class="row-odd"><td><p>fan6 (tacho6)</p></td>
<td><p>0xe9</p></td>
</tr>
<tr class="row-even"><td><p>fan7 (tacho7)</p></td>
<td><p>0xea</p></td>
</tr>
<tr class="row-odd"><td><p>fan8 (tacho8)</p></td>
<td><p>0xeb</p></td>
</tr>
<tr class="row-even"><td><p>fan9 (tacho9)</p></td>
<td><p>0xec</p></td>
</tr>
<tr class="row-odd"><td><p>fan10 (tacho10)</p></td>
<td><p>0xed</p></td>
</tr>
<tr class="row-even"><td><p>fan11 (tacho11)</p></td>
<td><p>0xee</p></td>
</tr>
<tr class="row-odd"><td><p>fan12 (tacho12)</p></td>
<td><p>0xef</p></td>
</tr>
</tbody>
</table>
<p>This setup can be re-programmed with other registers.</p>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>The driver implements a simple interface for driving a fan connected to
a PWM output and tachometer inputs.
This driver obtains PWM and tachometers registers location according to
the system configuration and creates FAN/PWM hwmon objects and a cooling
device. PWM and tachometers are sensed through the on-board programmable
device, which exports its register map. This device could be attached to
any bus type, for which register mapping is supported.
Single instance is created with one PWM control, up to 12 tachometers and
one cooling device. It could be as many instances as programmable device
supports.
The driver exposes the fan to the user space through the hwmon’s and
thermal’s sysfs interfaces.</p>
</section>
<section id="sys-files-in-hwmon-subsystem">
<h2>/sys files in hwmon subsystem<a class="headerlink" href="#sys-files-in-hwmon-subsystem" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 3%" />
<col style="width: 73%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>fan[1-12]_fault</p></td>
<td><p>RO</p></td>
<td><p>files for tachometers TACH1-TACH12 fault indication</p></td>
</tr>
<tr class="row-even"><td><p>fan[1-12]_input</p></td>
<td><p>RO</p></td>
<td><p>files for tachometers TACH1-TACH12 input (in RPM)</p></td>
</tr>
<tr class="row-odd"><td><p>pwm1</p></td>
<td><p>RW</p></td>
<td><p>file for fan[1-12] target duty cycle (0..255)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="sys-files-in-thermal-subsystem">
<h2>/sys files in thermal subsystem<a class="headerlink" href="#sys-files-in-thermal-subsystem" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 3%" />
<col style="width: 73%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>cur_state</p></td>
<td><p>RW</p></td>
<td><p>file for current cooling state of the cooling device
(0..max_state)</p></td>
</tr>
<tr class="row-even"><td><p>max_state</p></td>
<td><p>RO</p></td>
<td><p>file for maximum cooling state of the cooling device</p></td>
</tr>
</tbody>
</table>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Kernel driver mlxreg-fan</a><ul>
<li><a class="reference internal" href="#description">Description</a></li>
<li><a class="reference internal" href="#sys-files-in-hwmon-subsystem">/sys files in hwmon subsystem</a></li>
<li><a class="reference internal" href="#sys-files-in-thermal-subsystem">/sys files in thermal subsystem</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/hwmon/mlxreg-fan.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/hwmon/mlxreg-fan.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>