
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>ETMv4 sysfs linux driver programming reference. &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="CoreSight - Perf" href="coresight-perf.html" />
    <link rel="prev" title="CoreSight Embedded Cross Trigger (CTI &amp; CTM)." href="coresight-ect.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="etmv4-sysfs-linux-driver-programming-reference">
<h1>ETMv4 sysfs linux driver programming reference.<a class="headerlink" href="#etmv4-sysfs-linux-driver-programming-reference" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Mike Leach &lt;<a class="reference external" href="mailto:mike&#46;leach&#37;&#52;&#48;linaro&#46;org">mike<span>&#46;</span>leach<span>&#64;</span>linaro<span>&#46;</span>org</a>&gt;</p>
</dd>
<dt class="field-even">Date</dt>
<dd class="field-even"><p>October 11th, 2019</p>
</dd>
</dl>
</div></blockquote>
<p>Supplement to existing ETMv4 driver documentation.</p>
<section id="sysfs-files-and-directories">
<h2>Sysfs files and directories<a class="headerlink" href="#sysfs-files-and-directories" title="Permalink to this headline">¶</a></h2>
<p>Root: <code class="docutils literal notranslate"><span class="pre">/sys/bus/coresight/devices/etm&lt;N&gt;</span></code></p>
<p>The following paragraphs explain the association between sysfs files and the
ETMv4 registers that they effect. Note the register names are given without
the ‘TRC’ prefix.</p>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">mode</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>{CONFIGR + others}</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Bit select trace features. See ‘mode’ section below. Bits
in this will cause equivalent programming of trace config and
other registers to enable the features requested.</p>
</dd>
<dt class="field-even">Syntax &amp; eg</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">bitfield</span> <span class="pre">&gt;</span> <span class="pre">mode</span></code></p>
<p>bitfield up to 32 bits setting trace features.</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">$&gt;</span> <span class="pre">echo</span> <span class="pre">0x012</span> <span class="pre">&gt;</span> <span class="pre">mode</span></code></p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">reset</span></code> (wo)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>All</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Reset all programming to trace nothing / no logic programmed.</p>
</dd>
<dt class="field-even">Syntax</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">1</span> <span class="pre">&gt;</span> <span class="pre">reset</span></code></p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">enable_source</span></code> (wo)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>PRGCTLR, All hardware regs.</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><ul class="simple">
<li><p>&gt; 0 : Programs up the hardware with the current values held in the driver
and enables trace.</p></li>
<li><p>= 0 : disable trace hardware.</p></li>
</ul>
</dd>
<dt class="field-even">Syntax</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">1</span> <span class="pre">&gt;</span> <span class="pre">enable_source</span></code></p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">cpu</span></code> (ro)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>CPU ID that this ETM is attached to.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">$&gt;</span> <span class="pre">cat</span> <span class="pre">cpu</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">$&gt;</span> <span class="pre">0</span></code></p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">ts_source</span></code> (ro)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>When FEAT_TRF is implemented, value of TRFCR_ELx.TS used for trace session. Otherwise -1
indicates an unknown time source. Check trcidr0.tssize to see if a global timestamp is
available.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">$&gt;</span> <span class="pre">cat</span> <span class="pre">ts_source</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">$&gt;</span> <span class="pre">1</span></code></p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">addr_idx</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Virtual register to index address comparator and range
features. Set index for first of the pair in a range.</p>
</dd>
<dt class="field-even">Syntax</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">idx</span> <span class="pre">&gt;</span> <span class="pre">addr_idx</span></code></p>
<p>Where idx &lt; nr_addr_cmp x 2</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">addr_range</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>ACVR[idx, idx+1], VIIECTLR</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Pair of addresses for a range selected by addr_idx. Include
/ exclude according to the optional parameter, or if omitted
uses the current ‘mode’ setting. Select comparator range in
control register. Error if index is odd value.</p>
</dd>
<dt class="field-even">Depends</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">mode,</span> <span class="pre">addr_idx</span></code></p>
</dd>
<dt class="field-odd">Syntax</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">addr1</span> <span class="pre">addr2</span> <span class="pre">[exclude]</span> <span class="pre">&gt;</span> <span class="pre">addr_range</span></code></p>
<p>Where addr1 and addr2 define the range and addr1 &lt; addr2.</p>
<p>Optional exclude value:-</p>
<ul class="simple">
<li><p>0 for include</p></li>
<li><p>1 for exclude.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">$&gt;</span> <span class="pre">echo</span> <span class="pre">0x0000</span> <span class="pre">0x2000</span> <span class="pre">0</span> <span class="pre">&gt;</span> <span class="pre">addr_range</span></code></p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">addr_single</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>ACVR[idx]</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Set a single address comparator according to addr_idx. This
is used if the address comparator is used as part of event
generation logic etc.</p>
</dd>
<dt class="field-even">Depends</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">addr_idx</span></code></p>
</dd>
<dt class="field-odd">Syntax</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">addr1</span> <span class="pre">&gt;</span> <span class="pre">addr_single</span></code></p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">addr_start</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>ACVR[idx], VISSCTLR</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Set a trace start address comparator according to addr_idx.
Select comparator in control register.</p>
</dd>
<dt class="field-even">Depends</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">addr_idx</span></code></p>
</dd>
<dt class="field-odd">Syntax</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">addr1</span> <span class="pre">&gt;</span> <span class="pre">addr_start</span></code></p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">addr_stop</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>ACVR[idx], VISSCTLR</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Set a trace stop address comparator according to addr_idx.
Select comparator in control register.</p>
</dd>
<dt class="field-even">Depends</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">addr_idx</span></code></p>
</dd>
<dt class="field-odd">Syntax</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">addr1</span> <span class="pre">&gt;</span> <span class="pre">addr_stop</span></code></p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">addr_context</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>ACATR[idx,{6:4}]</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Link context ID comparator to address comparator addr_idx</p>
</dd>
<dt class="field-even">Depends</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">addr_idx</span></code></p>
</dd>
<dt class="field-odd">Syntax</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">ctxt_idx</span> <span class="pre">&gt;</span> <span class="pre">addr_context</span></code></p>
<p>Where ctxt_idx is the index of the linked context id / vmid
comparator.</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">addr_ctxtype</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>ACATR[idx,{3:2}]</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Input value string. Set type for linked context ID comparator</p>
</dd>
<dt class="field-even">Depends</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">addr_idx</span></code></p>
</dd>
<dt class="field-odd">Syntax</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">type</span> <span class="pre">&gt;</span> <span class="pre">addr_ctxtype</span></code></p>
<p>Type one of {all, vmid, ctxid, none}</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">$&gt;</span> <span class="pre">echo</span> <span class="pre">ctxid</span> <span class="pre">&gt;</span> <span class="pre">addr_ctxtype</span></code></p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">addr_exlevel_s_ns</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>ACATR[idx,{14:8}]</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Set the ELx secure and non-secure matching bits for the
selected address comparator</p>
</dd>
<dt class="field-even">Depends</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">addr_idx</span></code></p>
</dd>
<dt class="field-odd">Syntax</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">val</span> <span class="pre">&gt;</span> <span class="pre">addr_exlevel_s_ns</span></code></p>
<p>val is a 7 bit value for exception levels to exclude. Input
value shifted to correct bits in register.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">$&gt;</span> <span class="pre">echo</span> <span class="pre">0x4F</span> <span class="pre">&gt;</span> <span class="pre">addr_exlevel_s_ns</span></code></p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">addr_instdatatype</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>ACATR[idx,{1:0}]</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Set the comparator address type for matching. Driver only
supports setting instruction address type.</p>
</dd>
<dt class="field-even">Depends</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">addr_idx</span></code></p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">addr_cmp_view</span></code> (ro)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>ACVR[idx, idx+1], ACATR[idx], VIIECTLR</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Read the currently selected address comparator. If part of
address range then display both addresses.</p>
</dd>
<dt class="field-even">Depends</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">addr_idx</span></code></p>
</dd>
<dt class="field-odd">Syntax</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">cat</span> <span class="pre">addr_cmp_view</span></code></p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">$&gt;</span> <span class="pre">cat</span> <span class="pre">addr_cmp_view</span></code></p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">addr_cmp[0]</span> <span class="pre">range</span> <span class="pre">0x0</span> <span class="pre">0xffffffffffffffff</span> <span class="pre">include</span> <span class="pre">ctrl(0x4b00)</span></code></p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">nr_addr_cmp</span></code> (ro)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>From IDR4</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Number of address comparator pairs</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">sshot_idx</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Select single shot register set.</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">sshot_ctrl</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>SSCCR[idx]</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Access a single shot comparator control register.</p>
</dd>
<dt class="field-even">Depends</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">sshot_idx</span></code></p>
</dd>
<dt class="field-odd">Syntax</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">val</span> <span class="pre">&gt;</span> <span class="pre">sshot_ctrl</span></code></p>
<p>Writes val into the selected control register.</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">sshot_status</span></code> (ro)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>SSCSR[idx]</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Read a single shot comparator status register</p>
</dd>
<dt class="field-even">Depends</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">sshot_idx</span></code></p>
</dd>
<dt class="field-odd">Syntax</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">cat</span> <span class="pre">sshot_status</span></code></p>
<p>Read status.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">$&gt;</span> <span class="pre">cat</span> <span class="pre">sshot_status</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">0x1</span></code></p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">sshot_pe_ctrl</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>SSPCICR[idx]</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Access a single shot PE comparator input control register.</p>
</dd>
<dt class="field-even">Depends</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">sshot_idx</span></code></p>
</dd>
<dt class="field-odd">Syntax</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">val</span> <span class="pre">&gt;</span> <span class="pre">sshot_pe_ctrl</span></code></p>
<p>Writes val into the selected control register.</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">ns_exlevel_vinst</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>VICTLR{23:20}</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Program non-secure exception level filters. Set / clear NS
exception filter bits. Setting ‘1’ excludes trace from the
exception level.</p>
</dd>
<dt class="field-even">Syntax</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">bitfield</span> <span class="pre">&gt;</span> <span class="pre">ns_exlevel_viinst</span></code></p>
<p>Where bitfield contains bits to set clear for EL0 to EL2</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">%&gt;</span> <span class="pre">echo</span> <span class="pre">0x4</span> <span class="pre">&gt;</span> <span class="pre">ns_exlevel_viinst</span></code></p>
<p>Excludes EL2 NS trace.</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">vinst_pe_cmp_start_stop</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>VIPCSSCTLR</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Access PE start stop comparator input control registers</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">bb_ctrl</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>BBCTLR</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Define ranges that Branch Broadcast will operate in.
Default (0x0) is all addresses.</p>
</dd>
<dt class="field-even">Depends</dt>
<dd class="field-even"><p>BB enabled.</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">cyc_threshold</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>CCCTLR</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Set the threshold for which cycle counts will be emitted.
Error if attempt to set below minimum defined in IDR3, masked
to width of valid bits.</p>
</dd>
<dt class="field-even">Depends</dt>
<dd class="field-even"><p>CC enabled.</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">syncfreq</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>SYNCPR</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Set trace synchronisation period. Power of 2 value, 0 (off)
or 8-20. Driver defaults to 12 (every 4096 bytes).</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">cntr_idx</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>none</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Select the counter to access</p>
</dd>
<dt class="field-even">Syntax</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">idx</span> <span class="pre">&gt;</span> <span class="pre">cntr_idx</span></code></p>
<p>Where idx &lt; nr_cntr</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">cntr_ctrl</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>CNTCTLR[idx]</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Set counter control value.</p>
</dd>
<dt class="field-even">Depends</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">cntr_idx</span></code></p>
</dd>
<dt class="field-odd">Syntax</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">val</span> <span class="pre">&gt;</span> <span class="pre">cntr_ctrl</span></code></p>
<p>Where val is per ETMv4 spec.</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">cntrldvr</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>CNTRLDVR[idx]</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Set counter reload value.</p>
</dd>
<dt class="field-even">Depends</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">cntr_idx</span></code></p>
</dd>
<dt class="field-odd">Syntax</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">val</span> <span class="pre">&gt;</span> <span class="pre">cntrldvr</span></code></p>
<p>Where val is per ETMv4 spec.</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">nr_cntr</span></code> (ro)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>From IDR5</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Number of counters implemented.</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">ctxid_idx</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Select the context ID comparator to access</p>
</dd>
<dt class="field-even">Syntax</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">idx</span> <span class="pre">&gt;</span> <span class="pre">ctxid_idx</span></code></p>
<p>Where idx &lt; numcidc</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">ctxid_pid</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>CIDCVR[idx]</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Set the context ID comparator value</p>
</dd>
<dt class="field-even">Depends</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ctxid_idx</span></code></p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">ctxid_masks</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>CIDCCTLR0, CIDCCTLR1, CIDCVR&lt;0-7&gt;</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Pair of values to set the byte masks for 1-8 context ID
comparators. Automatically clears masked bytes to 0 in CID
value registers.</p>
</dd>
<dt class="field-even">Syntax</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">m3m2m1m0</span> <span class="pre">[m7m6m5m4]</span> <span class="pre">&gt;</span> <span class="pre">ctxid_masks</span></code></p>
<p>32 bit values made up of mask bytes, where mN represents a
byte mask value for Context ID comparator N.</p>
<p>Second value not required on systems that have fewer than 4
context ID comparators</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">numcidc</span></code> (ro)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>From IDR4</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Number of Context ID comparators</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">vmid_idx</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Select the VM ID comparator to access.</p>
</dd>
<dt class="field-even">Syntax</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">idx</span> <span class="pre">&gt;</span> <span class="pre">vmid_idx</span></code></p>
<p>Where idx &lt;  numvmidc</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">vmid_val</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>VMIDCVR[idx]</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Set the VM ID comparator value</p>
</dd>
<dt class="field-even">Depends</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">vmid_idx</span></code></p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">vmid_masks</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>VMIDCCTLR0, VMIDCCTLR1, VMIDCVR&lt;0-7&gt;</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Pair of values to set the byte masks for 1-8 VM ID comparators.
Automatically clears masked bytes to 0 in VMID value registers.</p>
</dd>
<dt class="field-even">Syntax</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">m3m2m1m0</span> <span class="pre">[m7m6m5m4]</span> <span class="pre">&gt;</span> <span class="pre">vmid_masks</span></code></p>
<p>Where mN represents a byte mask value for VMID comparator N.
Second value not required on systems that have fewer than 4
VMID comparators.</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">numvmidc</span></code> (ro)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>From IDR4</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Number of VMID comparators</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">res_idx</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Select the resource selector control to access. Must be 2 or
higher as selectors 0 and 1 are hardwired.</p>
</dd>
<dt class="field-even">Syntax</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">idx</span> <span class="pre">&gt;</span> <span class="pre">res_idx</span></code></p>
<p>Where 2 &lt;= idx &lt; nr_resource x 2</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">res_ctrl</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>RSCTLR[idx]</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Set resource selector control value. Value per ETMv4 spec.</p>
</dd>
<dt class="field-even">Depends</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">res_idx</span></code></p>
</dd>
<dt class="field-odd">Syntax</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">val</span> <span class="pre">&gt;</span> <span class="pre">res_cntr</span></code></p>
<p>Where val is per ETMv4 spec.</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">nr_resource</span></code> (ro)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>From IDR4</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Number of resource selector pairs</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">event</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>EVENTCTRL0R</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Set up to 4 implemented event fields.</p>
</dd>
<dt class="field-even">Syntax</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">ev3ev2ev1ev0</span> <span class="pre">&gt;</span> <span class="pre">event</span></code></p>
<p>Where evN is an 8 bit event field. Up to 4 event fields make up the
32-bit input value. Number of valid fields is implementation dependent,
defined in IDR0.</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">event_instren</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>EVENTCTRL1R</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Choose events which insert event packets into trace stream.</p>
</dd>
<dt class="field-even">Depends</dt>
<dd class="field-even"><p>EVENTCTRL0R</p>
</dd>
<dt class="field-odd">Syntax</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">bitfield</span> <span class="pre">&gt;</span> <span class="pre">event_instren</span></code></p>
<p>Where bitfield is up to 4 bits according to number of event fields.</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">event_ts</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>TSCTLR</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Set the event that will generate timestamp requests.</p>
</dd>
<dt class="field-even">Depends</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">TS</span> <span class="pre">activated</span></code></p>
</dd>
<dt class="field-odd">Syntax</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">evfield</span> <span class="pre">&gt;</span> <span class="pre">event_ts</span></code></p>
<p>Where evfield is an 8 bit event selector.</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">seq_idx</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Sequencer event register select - 0 to 2</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">seq_state</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>SEQSTR</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Sequencer current state - 0 to 3.</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">seq_event</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>SEQEVR[idx]</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>State transition event registers</p>
</dd>
<dt class="field-even">Depends</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">seq_idx</span></code></p>
</dd>
<dt class="field-odd">Syntax</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">evBevF</span> <span class="pre">&gt;</span> <span class="pre">seq_event</span></code></p>
<p>Where evBevF is a 16 bit value made up of two event selectors,</p>
<ul class="simple">
<li><p>evB : back</p></li>
<li><p>evF : forwards.</p></li>
</ul>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">seq_reset_event</span></code> (rw)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>SEQRSTEVR</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Sequencer reset event</p>
</dd>
<dt class="field-even">Syntax</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">evfield</span> <span class="pre">&gt;</span> <span class="pre">seq_reset_event</span></code></p>
<p>Where evfield is an 8 bit event selector.</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">nrseqstate</span></code> (ro)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>From IDR5</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Number of sequencer states (0 or 4)</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">nr_pe_cmp</span></code> (ro)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>From IDR4</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Number of PE comparator inputs</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">nr_ext_inp</span></code> (ro)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>From IDR5</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Number of external inputs</p>
</dd>
</dl>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">File</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">nr_ss_cmp</span></code> (ro)</p>
</dd>
<dt class="field-even">Trace Registers</dt>
<dd class="field-even"><p>From IDR4</p>
</dd>
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p>Number of Single Shot control registers</p>
</dd>
</dl>
<hr class="docutils" />
<p><em>Note:</em> When programming any address comparator the driver will tag the
comparator with a type used - i.e. RANGE, SINGLE, START, STOP. Once this tag
is set, then only the values can be changed using the same sysfs file / type
used to program it.</p>
<p>Thus:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% echo 0 &gt; addr_idx           ; select address comparator 0
% echo 0x1000 0x5000 0 &gt; addr_range ; set address range on comparators 0, 1.
% echo 0x2000 &gt; addr_start    ; error as comparator 0 is a range comparator
% echo 2 &gt; addr_idx           ; select address comparator 2
% echo 0x2000 &gt; addr_start    ; this is OK as comparator 2 is unused.
% echo 0x3000 &gt; addr_stop     ; error as comparator 2 set as start address.
% echo 2 &gt; addr_idx           ; select address comparator 3
% echo 0x3000 &gt; addr_stop     ; this is OK
</pre></div>
</div>
<p>To remove programming on all the comparators (and all the other hardware) use
the reset parameter:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% echo 1 &gt; reset
</pre></div>
</div>
</section>
<section id="the-mode-sysfs-parameter">
<h2>The ‘mode’ sysfs parameter.<a class="headerlink" href="#the-mode-sysfs-parameter" title="Permalink to this headline">¶</a></h2>
<p>This is a bitfield selection parameter that sets the overall trace mode for the
ETM. The table below describes the bits, using the defines from the driver
source file, along with a description of the feature these represent. Many
features are optional and therefore dependent on implementation in the
hardware.</p>
<p>Bit assignments shown below:-</p>
<hr class="docutils" />
<dl class="simple">
<dt><strong>bit (0):</strong></dt><dd><p>ETM_MODE_EXCLUDE</p>
</dd>
<dt><strong>description:</strong></dt><dd><p>This is the default value for the include / exclude function when
setting address ranges. Set 1 for exclude range. When the mode
parameter is set this value is applied to the currently indexed
address range.</p>
</dd>
</dl>
<dl id="coresight-branch-broadcast">
<dt><strong>bit (4):</strong></dt><dd><p>ETM_MODE_BB</p>
</dd>
<dt><strong>description:</strong></dt><dd><p>Set to enable branch broadcast if supported in hardware [IDR0]. The primary use for this feature
is when code is patched dynamically at run time and the full program flow may not be able to be
reconstructed using only conditional branches.</p>
<p>There is currently no support in Perf for supplying modified binaries to the decoder, so this
feature is only inteded to be used for debugging purposes or with a 3rd party tool.</p>
<p>Choosing this option will result in a significant increase in the amount of trace generated -
possible danger of overflows, or fewer instructions covered. Note, that this option also
overrides any setting of <a class="reference internal" href="#coresight-return-stack"><span class="std std-ref">ETM_MODE_RETURNSTACK</span></a>, so where a branch
broadcast range overlaps a return stack range, return stacks will not be available for that
range.</p>
</dd>
</dl>
<dl class="simple" id="coresight-cycle-accurate">
<dt><strong>bit (5):</strong></dt><dd><p>ETMv4_MODE_CYCACC</p>
</dd>
<dt><strong>description:</strong></dt><dd><p>Set to enable cycle accurate trace if supported [IDR0].</p>
</dd>
<dt><strong>bit (6):</strong></dt><dd><p>ETMv4_MODE_CTXID</p>
</dd>
<dt><strong>description:</strong></dt><dd><p>Set to enable context ID tracing if supported in hardware [IDR2].</p>
</dd>
<dt><strong>bit (7):</strong></dt><dd><p>ETM_MODE_VMID</p>
</dd>
<dt><strong>description:</strong></dt><dd><p>Set to enable virtual machine ID tracing if supported [IDR2].</p>
</dd>
</dl>
<dl class="simple" id="coresight-timestamp">
<dt><strong>bit (11):</strong></dt><dd><p>ETMv4_MODE_TIMESTAMP</p>
</dd>
<dt><strong>description:</strong></dt><dd><p>Set to enable timestamp generation if supported [IDR0].</p>
</dd>
</dl>
<dl class="simple" id="coresight-return-stack">
<dt><strong>bit (12):</strong></dt><dd><p>ETM_MODE_RETURNSTACK</p>
</dd>
<dt><strong>description:</strong></dt><dd><p>Set to enable trace return stack use if supported [IDR0].</p>
</dd>
<dt><strong>bit (13-14):</strong></dt><dd><p>ETM_MODE_QELEM(val)</p>
</dd>
<dt><strong>description:</strong></dt><dd><p>‘val’ determines level of Q element support enabled if
implemented by the ETM [IDR0]</p>
</dd>
<dt><strong>bit (19):</strong></dt><dd><p>ETM_MODE_ATB_TRIGGER</p>
</dd>
<dt><strong>description:</strong></dt><dd><p>Set to enable the ATBTRIGGER bit in the event control register
[EVENTCTLR1] if supported [IDR5].</p>
</dd>
<dt><strong>bit (20):</strong></dt><dd><p>ETM_MODE_LPOVERRIDE</p>
</dd>
<dt><strong>description:</strong></dt><dd><p>Set to enable the LPOVERRIDE bit in the event control register
[EVENTCTLR1], if supported [IDR5].</p>
</dd>
<dt><strong>bit (21):</strong></dt><dd><p>ETM_MODE_ISTALL_EN</p>
</dd>
<dt><strong>description:</strong></dt><dd><p>Set to enable the ISTALL bit in the stall control register
[STALLCTLR]</p>
</dd>
<dt><strong>bit (23):</strong></dt><dd><p>ETM_MODE_INSTPRIO</p>
</dd>
<dt><strong>description:</strong></dt><dd><p>Set to enable the INSTPRIORITY bit in the stall control register
[STALLCTLR] , if supported [IDR0].</p>
</dd>
<dt><strong>bit (24):</strong></dt><dd><p>ETM_MODE_NOOVERFLOW</p>
</dd>
<dt><strong>description:</strong></dt><dd><p>Set to enable the NOOVERFLOW bit in the stall control register
[STALLCTLR], if supported [IDR3].</p>
</dd>
<dt><strong>bit (25):</strong></dt><dd><p>ETM_MODE_TRACE_RESET</p>
</dd>
<dt><strong>description:</strong></dt><dd><p>Set to enable the TRCRESET bit in the viewinst control register
[VICTLR] , if supported [IDR3].</p>
</dd>
<dt><strong>bit (26):</strong></dt><dd><p>ETM_MODE_TRACE_ERR</p>
</dd>
<dt><strong>description:</strong></dt><dd><p>Set to enable the TRCCTRL bit in the viewinst control register
[VICTLR].</p>
</dd>
<dt><strong>bit (27):</strong></dt><dd><p>ETM_MODE_VIEWINST_STARTSTOP</p>
</dd>
<dt><strong>description:</strong></dt><dd><p>Set the initial state value of the ViewInst start / stop logic
in the viewinst control register [VICTLR]</p>
</dd>
<dt><strong>bit (30):</strong></dt><dd><p>ETM_MODE_EXCL_KERN</p>
</dd>
<dt><strong>description:</strong></dt><dd><p>Set default trace setup to exclude kernel mode trace (see note a)</p>
</dd>
<dt><strong>bit (31):</strong></dt><dd><p>ETM_MODE_EXCL_USER</p>
</dd>
<dt><strong>description:</strong></dt><dd><p>Set default trace setup to exclude user space trace (see note a)</p>
</dd>
</dl>
<hr class="docutils" />
<p><em>Note a)</em> On startup the ETM is programmed to trace the complete address space
using address range comparator 0. ‘mode’ bits 30 / 31 modify this setting to
set EL exclude bits for NS state in either user space (EL0) or kernel space
(EL1) in the address range comparator. (the default setting excludes all
secure EL, and NS EL2)</p>
<p>Once the reset parameter has been used, and/or custom programming has been
implemented - using these bits will result in the EL bits for address
comparator 0 being set in the same way.</p>
<p><em>Note b)</em> Bits 2-3, 8-10, 15-16, 18, 22, control features that only work with
data trace. As A-profile data trace is architecturally prohibited in ETMv4,
these have been omitted here. Possible uses could be where a kernel has
support for control of R or M profile infrastructure as part of a heterogeneous
system.</p>
<p>Bits 17, 28-29 are unused.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">ETMv4 sysfs linux driver programming reference.</a><ul>
<li><a class="reference internal" href="#sysfs-files-and-directories">Sysfs files and directories</a></li>
<li><a class="reference internal" href="#the-mode-sysfs-parameter">The ‘mode’ sysfs parameter.</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/trace/coresight/coresight-etm4x-reference.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/trace/coresight/coresight-etm4x-reference.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>