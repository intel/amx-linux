
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Bare UDP Tunnelling Module Documentation &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="batman-adv" href="batman-adv.html" />
    <link rel="prev" title="AF_XDP" href="af_xdp.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="bare-udp-tunnelling-module-documentation">
<h1>Bare UDP Tunnelling Module Documentation<a class="headerlink" href="#bare-udp-tunnelling-module-documentation" title="Permalink to this headline">¶</a></h1>
<p>There are various L3 encapsulation standards using UDP being discussed to
leverage the UDP based load balancing capability of different networks.
MPLSoUDP (__ <a class="reference external" href="https://tools.ietf.org/html/rfc7510">https://tools.ietf.org/html/rfc7510</a>) is one among them.</p>
<p>The Bareudp tunnel module provides a generic L3 encapsulation support for
tunnelling different L3 protocols like MPLS, IP, NSH etc. inside a UDP tunnel.</p>
<section id="special-handling">
<h2>Special Handling<a class="headerlink" href="#special-handling" title="Permalink to this headline">¶</a></h2>
<p>The bareudp device supports special handling for MPLS &amp; IP as they can have
multiple ethertypes.
MPLS procotcol can have ethertypes ETH_P_MPLS_UC  (unicast) &amp; ETH_P_MPLS_MC (multicast).
IP protocol can have ethertypes ETH_P_IP (v4) &amp; ETH_P_IPV6 (v6).
This special handling can be enabled only for ethertypes ETH_P_IP &amp; ETH_P_MPLS_UC
with a flag called multiproto mode.</p>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p>Device creation &amp; deletion</p>
<blockquote>
<div><ol class="loweralpha">
<li><p>ip link add dev bareudp0 type bareudp dstport 6635 ethertype mpls_uc</p>
<p>This creates a bareudp tunnel device which tunnels L3 traffic with ethertype
0x8847 (MPLS traffic). The destination port of the UDP header will be set to
6635.The device will listen on UDP port 6635 to receive traffic.</p>
</li>
<li><p>ip link delete bareudp0</p></li>
</ol>
</div></blockquote>
</li>
<li><p>Device creation with multiproto mode enabled</p></li>
</ol>
<p>The multiproto mode allows bareudp tunnels to handle several protocols of the
same family. It is currently only available for IP and MPLS. This mode has to
be enabled explicitly with the “multiproto” flag.</p>
<blockquote>
<div><ol class="loweralpha">
<li><p>ip link add dev bareudp0 type bareudp dstport 6635 ethertype ipv4 multiproto</p>
<p>For an IPv4 tunnel the multiproto mode allows the tunnel to also handle
IPv6.</p>
</li>
<li><p>ip link add dev bareudp0 type bareudp dstport 6635 ethertype mpls_uc multiproto</p>
<p>For MPLS, the multiproto mode allows the tunnel to handle both unicast
and multicast MPLS packets.</p>
</li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Device Usage</p></li>
</ol>
<p>The bareudp device could be used along with OVS or flower filter in TC.
The OVS or TC flower layer must set the tunnel information in SKB dst field before
sending packet buffer to the bareudp device for transmission. On reception the
bareudp device extracts and stores the tunnel information in SKB dst field before
passing the packet buffer to the network stack.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Bare UDP Tunnelling Module Documentation</a><ul>
<li><a class="reference internal" href="#special-handling">Special Handling</a></li>
<li><a class="reference internal" href="#usage">Usage</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/networking/bareudp.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/networking/bareudp.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>