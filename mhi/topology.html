
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>MHI Topology &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Linux PECI Subsystem" href="../peci/index.html" />
    <link rel="prev" title="MHI (Modem Host Interface)" href="mhi.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="mhi-topology">
<h1>MHI Topology<a class="headerlink" href="#mhi-topology" title="Permalink to this headline">¶</a></h1>
<p>This document provides information about the MHI topology modeling and
representation in the kernel.</p>
<section id="mhi-controller">
<h2>MHI Controller<a class="headerlink" href="#mhi-controller" title="Permalink to this headline">¶</a></h2>
<p>MHI controller driver manages the interaction with the MHI client devices
such as the external modems and WiFi chipsets. It is also the MHI bus master
which is in charge of managing the physical link between the host and device.
It is however not involved in the actual data transfer as the data transfer
is taken care by the physical bus such as PCIe. Each controller driver exposes
channels and events based on the client device type.</p>
<p>Below are the roles of the MHI controller driver:</p>
<ul class="simple">
<li><p>Turns on the physical bus and establishes the link to the device</p></li>
<li><p>Configures IRQs, IOMMU, and IOMEM</p></li>
<li><p>Allocates struct mhi_controller and registers with the MHI bus framework
with channel and event configurations using mhi_register_controller.</p></li>
<li><p>Initiates power on and shutdown sequence</p></li>
<li><p>Initiates suspend and resume power management operations of the device.</p></li>
</ul>
</section>
<section id="mhi-device">
<h2>MHI Device<a class="headerlink" href="#mhi-device" title="Permalink to this headline">¶</a></h2>
<p>MHI device is the logical device which binds to a maximum of two MHI channels
for bi-directional communication. Once MHI is in powered on state, the MHI
core will create MHI devices based on the channel configuration exposed
by the controller. There can be a single MHI device for each channel or for a
couple of channels.</p>
<p>Each supported device is enumerated in:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/sys/bus/mhi/devices/
</pre></div>
</div>
</section>
<section id="mhi-driver">
<h2>MHI Driver<a class="headerlink" href="#mhi-driver" title="Permalink to this headline">¶</a></h2>
<p>MHI driver is the client driver which binds to one or more MHI devices. The MHI
driver sends and receives the upper-layer protocol packets like IP packets,
modem control messages, and diagnostics messages over MHI. The MHI core will
bind the MHI devices to the MHI driver.</p>
<p>Each supported driver is enumerated in:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/sys/bus/mhi/drivers/
</pre></div>
</div>
<p>Below are the roles of the MHI driver:</p>
<ul class="simple">
<li><p>Registers the driver with the MHI bus framework using mhi_driver_register.</p></li>
<li><p>Prepares the device for transfer by calling mhi_prepare_for_transfer.</p></li>
<li><p>Initiates data transfer by calling mhi_queue_transfer.</p></li>
<li><p>Once the data transfer is finished, calls mhi_unprepare_from_transfer to
end data transfer.</p></li>
</ul>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">MHI Topology</a><ul>
<li><a class="reference internal" href="#mhi-controller">MHI Controller</a></li>
<li><a class="reference internal" href="#mhi-device">MHI Device</a></li>
<li><a class="reference internal" href="#mhi-driver">MHI Driver</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/mhi/topology.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/mhi/topology.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>