
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Device-Mapper Logging &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="dm-queue-length" href="dm-queue-length.html" />
    <link rel="prev" title="dm-io" href="dm-io.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="device-mapper-logging">
<h1>Device-Mapper Logging<a class="headerlink" href="#device-mapper-logging" title="Permalink to this headline">¶</a></h1>
<p>The device-mapper logging code is used by some of the device-mapper
RAID targets to track regions of the disk that are not consistent.
A region (or portion of the address space) of the disk may be
inconsistent because a RAID stripe is currently being operated on or
a machine died while the region was being altered.  In the case of
mirrors, a region would be considered dirty/inconsistent while you
are writing to it because the writes need to be replicated for all
the legs of the mirror and may not reach the legs at the same time.
Once all writes are complete, the region is considered clean again.</p>
<p>There is a generic logging interface that the device-mapper RAID
implementations use to perform logging operations (see
dm_dirty_log_type in include/linux/dm-dirty-log.h).  Various different
logging implementations are available and provide different
capabilities.  The list includes:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Files</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>disk</p></td>
<td><p>drivers/md/dm-log.c</p></td>
</tr>
<tr class="row-odd"><td><p>core</p></td>
<td><p>drivers/md/dm-log.c</p></td>
</tr>
<tr class="row-even"><td><p>userspace</p></td>
<td><p>drivers/md/dm-log-userspace* include/linux/dm-log-userspace.h</p></td>
</tr>
</tbody>
</table>
<section id="the-disk-log-type">
<h2>The “disk” log type<a class="headerlink" href="#the-disk-log-type" title="Permalink to this headline">¶</a></h2>
<p>This log implementation commits the log state to disk.  This way, the
logging state survives reboots/crashes.</p>
</section>
<section id="the-core-log-type">
<h2>The “core” log type<a class="headerlink" href="#the-core-log-type" title="Permalink to this headline">¶</a></h2>
<p>This log implementation keeps the log state in memory.  The log state
will not survive a reboot or crash, but there may be a small boost in
performance.  This method can also be used if no storage device is
available for storing log state.</p>
</section>
<section id="the-userspace-log-type">
<h2>The “userspace” log type<a class="headerlink" href="#the-userspace-log-type" title="Permalink to this headline">¶</a></h2>
<p>This log type simply provides a way to export the log API to userspace,
so log implementations can be done there.  This is done by forwarding most
logging requests to userspace, where a daemon receives and processes the
request.</p>
<p>The structure used for communication between kernel and userspace are
located in include/linux/dm-log-userspace.h.  Due to the frequency,
diversity, and 2-way communication nature of the exchanges between
kernel and userspace, ‘connector’ is used as the interface for
communication.</p>
<p>There are currently two userspace log implementations that leverage this
framework - “clustered-disk” and “clustered-core”.  These implementations
provide a cluster-coherent log for shared-storage.  Device-mapper mirroring
can be used in a shared-storage environment when the cluster log implementations
are employed.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Device-Mapper Logging</a><ul>
<li><a class="reference internal" href="#the-disk-log-type">The “disk” log type</a></li>
<li><a class="reference internal" href="#the-core-log-type">The “core” log type</a></li>
<li><a class="reference internal" href="#the-userspace-log-type">The “userspace” log type</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/admin-guide/device-mapper/dm-log.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/admin-guide/device-mapper/dm-log.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>