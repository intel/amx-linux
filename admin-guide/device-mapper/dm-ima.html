
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>dm-ima &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Early creation of mapped devices" href="dm-init.html" />
    <link rel="prev" title="dm-flakey" href="dm-flakey.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="dm-ima">
<h1>dm-ima<a class="headerlink" href="#dm-ima" title="Permalink to this headline">¶</a></h1>
<p>For a given system, various external services/infrastructure tools
(including the attestation service) interact with it - both during the
setup and during rest of the system run-time.  They share sensitive data
and/or execute critical workload on that system.  The external services
may want to verify the current run-time state of the relevant kernel
subsystems before fully trusting the system with business-critical
data/workload.</p>
<p>Device mapper plays a critical role on a given system by providing
various important functionalities to the block devices using various
target types like crypt, verity, integrity etc.  Each of these target
types’ functionalities can be configured with various attributes.
The attributes chosen to configure these target types can significantly
impact the security profile of the block device, and in-turn, of the
system itself.  For instance, the type of encryption algorithm and the
key size determines the strength of encryption for a given block device.</p>
<p>Therefore, verifying the current state of various block devices as well
as their various target attributes is crucial for external services before
fully trusting the system with business-critical data/workload.</p>
<p>IMA kernel subsystem provides the necessary functionality for
device mapper to measure the state and configuration of
various block devices -</p>
<ul class="simple">
<li><p>by device mapper itself, from within the kernel,</p></li>
<li><p>in a tamper resistant way,</p></li>
<li><p>and re-measured - triggered on state/configuration change.</p></li>
</ul>
<section id="setting-the-ima-policy">
<h2>Setting the IMA Policy:<a class="headerlink" href="#setting-the-ima-policy" title="Permalink to this headline">¶</a></h2>
<p>For IMA to measure the data on a given system, the IMA policy on the
system needs to be updated to have following line, and the system needs
to be restarted for the measurements to take effect.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/etc/ima/ima-policy
   measure func=CRITICAL_DATA label=device-mapper template=ima-buf
</pre></div>
</div>
<p>The measurements will be reflected in the IMA logs, which are located at:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/sys/kernel/security/integrity/ima/ascii_runtime_measurements
/sys/kernel/security/integrity/ima/binary_runtime_measurements
</pre></div>
</div>
<p>Then IMA ASCII measurement log has the following format:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;PCR&gt; &lt;TEMPLATE_DATA_DIGEST&gt; &lt;TEMPLATE_NAME&gt; &lt;TEMPLATE_DATA&gt;

PCR := Platform Configuration Register, in which the values are registered.
      This is applicable if TPM chip is in use.

TEMPLATE_DATA_DIGEST := Template data digest of the IMA record.
TEMPLATE_NAME := Template name that registered the integrity value (e.g. ima-buf).

TEMPLATE_DATA := &lt;ALG&gt; &quot;:&quot; &lt;EVENT_DIGEST&gt; &lt;EVENT_NAME&gt; &lt;EVENT_DATA&gt;
                 It contains data for the specific event to be measured,
                 in a given template data format.

ALG := Algorithm to compute event digest
EVENT_DIGEST := Digest of the event data
EVENT_NAME := Description of the event (e.g. &#39;dm_table_load&#39;).
EVENT_DATA := The event data to be measured.
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line"><em>NOTE #1:</em></div>
<div class="line">The DM target data measured by IMA subsystem can alternatively
be queried from userspace by setting DM_IMA_MEASUREMENT_FLAG with
DM_TABLE_STATUS_CMD.</div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line"><em>NOTE #2:</em></div>
<div class="line">The Kernel configuration CONFIG_IMA_DISABLE_HTABLE allows measurement of duplicate records.</div>
<div class="line">To support recording duplicate IMA events in the IMA log, the Kernel needs to be configured with
CONFIG_IMA_DISABLE_HTABLE=y.</div>
</div>
</section>
<section id="supported-device-states">
<h2>Supported Device States:<a class="headerlink" href="#supported-device-states" title="Permalink to this headline">¶</a></h2>
<p>Following device state changes will trigger IMA measurements:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Table load</p></li>
<li><p>Device resume</p></li>
<li><p>Device remove</p></li>
<li><p>Table clear</p></li>
<li><p>Device rename</p></li>
</ol>
</div></blockquote>
<section id="table-load">
<h3>1. Table load:<a class="headerlink" href="#table-load" title="Permalink to this headline">¶</a></h3>
<p>When a new table is loaded in a device’s inactive table slot,
the device information and target specific details from the
targets in the table are measured.</p>
<p>The IMA measurement log has the following format for ‘dm_table_load’:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>EVENT_NAME := &quot;dm_table_load&quot;
EVENT_DATA := &lt;dm_version_str&gt; &quot;;&quot; &lt;device_metadata&gt; &quot;;&quot; &lt;table_load_data&gt;

dm_version_str := &quot;dm_version=&quot; &lt;N&gt; &quot;.&quot; &lt;N&gt; &quot;.&quot; &lt;N&gt;
                 Same as Device Mapper driver version.
device_metadata := &lt;device_name&gt; &quot;,&quot; &lt;device_uuid&gt; &quot;,&quot; &lt;device_major&gt; &quot;,&quot; &lt;device_minor&gt; &quot;,&quot;
                  &lt;minor_count&gt; &quot;,&quot; &lt;num_device_targets&gt; &quot;;&quot;

device_name := &quot;name=&quot; &lt;dm-device-name&gt;
device_uuid := &quot;uuid=&quot; &lt;dm-device-uuid&gt;
device_major := &quot;major=&quot; &lt;N&gt;
device_minor := &quot;minor=&quot; &lt;N&gt;
minor_count := &quot;minor_count=&quot; &lt;N&gt;
num_device_targets := &quot;num_targets=&quot; &lt;N&gt;
dm-device-name := Name of the device. If it contains special characters like &#39;\&#39;, &#39;,&#39;, &#39;;&#39;,
                  they are prefixed with &#39;\&#39;.
dm-device-uuid := UUID of the device. If it contains special characters like &#39;\&#39;, &#39;,&#39;, &#39;;&#39;,
                  they are prefixed with &#39;\&#39;.

table_load_data := &lt;target_data&gt;
                   Represents the data (as name=value pairs) from various targets in the table,
                   which is being loaded into the DM device&#39;s inactive table slot.
target_data := &lt;target_data_row&gt; | &lt;target_data&gt;&lt;target_data_row&gt;

target_data_row := &lt;target_index&gt; &quot;,&quot; &lt;target_begin&gt; &quot;,&quot; &lt;target_len&gt; &quot;,&quot; &lt;target_name&gt; &quot;,&quot;
                   &lt;target_version&gt; &quot;,&quot; &lt;target_attributes&gt; &quot;;&quot;
target_index := &quot;target_index=&quot; &lt;N&gt;
                Represents nth target in the table (from 0 to N-1 targets specified in &lt;num_device_targets&gt;)
                If all the data for N targets doesn&#39;t fit in the given buffer - then the data that fits
                in the buffer (say from target 0 to x) is measured in a given IMA event.
                The remaining data from targets x+1 to N-1 is measured in the subsequent IMA events,
                with the same format as that of &#39;dm_table_load&#39;
                i.e. &lt;dm_version_str&gt; &quot;;&quot; &lt;device_metadata&gt; &quot;;&quot; &lt;table_load_data&gt;.

target_begin := &quot;target_begin=&quot; &lt;N&gt;
target_len := &quot;target_len=&quot; &lt;N&gt;
target_name := Name of the target. &#39;linear&#39;, &#39;crypt&#39;, &#39;integrity&#39; etc.
               The targets that are supported for IMA measurements are documented below in the
               &#39;Supported targets&#39; section.
target_version := &quot;target_version=&quot; &lt;N&gt; &quot;.&quot; &lt;N&gt; &quot;.&quot; &lt;N&gt;
target_attributes := Data containing comma separated list of name=value pairs of target specific attributes.

For instance, if a linear device is created with the following table entries,
 # dmsetup create linear1
 0 2 linear /dev/loop0 512
 2 2 linear /dev/loop0 512
 4 2 linear /dev/loop0 512
 6 2 linear /dev/loop0 512

Then IMA ASCII measurement log will have the following entry:
(converted from ASCII to text for readability)

10 a8c5ff755561c7a28146389d1514c318592af49a ima-buf sha256:4d73481ecce5eadba8ab084640d85bb9ca899af4d0a122989252a76efadc5b72
dm_table_load
dm_version=4.45.0;
name=linear1,uuid=,major=253,minor=0,minor_count=1,num_targets=4;
target_index=0,target_begin=0,target_len=2,target_name=linear,target_version=1.4.0,device_name=7:0,start=512;
target_index=1,target_begin=2,target_len=2,target_name=linear,target_version=1.4.0,device_name=7:0,start=512;
target_index=2,target_begin=4,target_len=2,target_name=linear,target_version=1.4.0,device_name=7:0,start=512;
target_index=3,target_begin=6,target_len=2,target_name=linear,target_version=1.4.0,device_name=7:0,start=512;
</pre></div>
</div>
</section>
<section id="device-resume">
<h3>2. Device resume:<a class="headerlink" href="#device-resume" title="Permalink to this headline">¶</a></h3>
<p>When a suspended device is resumed, the device information and the hash of the
data from previous load of an active table are measured.</p>
<p>The IMA measurement log has the following format for ‘dm_device_resume’:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>EVENT_NAME := &quot;dm_device_resume&quot;
EVENT_DATA := &lt;dm_version_str&gt; &quot;;&quot; &lt;device_metadata&gt; &quot;;&quot; &lt;active_table_hash&gt; &quot;;&quot; &lt;current_device_capacity&gt; &quot;;&quot;

dm_version_str := As described in the &#39;Table load&#39; section above.
device_metadata := As described in the &#39;Table load&#39; section above.
active_table_hash := &quot;active_table_hash=&quot; &lt;table_hash_alg&gt; &quot;:&quot; &lt;table_hash&gt;
                     Rerpresents the hash of the IMA data being measured for the
                     active table for the device.
table_hash_alg := Algorithm used to compute the hash.
table_hash := Hash of the (&lt;dm_version_str&gt; &quot;;&quot; &lt;device_metadata&gt; &quot;;&quot; &lt;table_load_data&gt; &quot;;&quot;)
              as described in the &#39;dm_table_load&#39; above.
              Note: If the table_load data spans across multiple IMA &#39;dm_table_load&#39;
              events for a given device, the hash is computed combining all the event data
              i.e. (&lt;dm_version_str&gt; &quot;;&quot; &lt;device_metadata&gt; &quot;;&quot; &lt;table_load_data&gt; &quot;;&quot;)
              across all those events.
current_device_capacity := &quot;current_device_capacity=&quot; &lt;N&gt;

For instance, if a linear device is resumed with the following command,
#dmsetup resume linear1

then IMA ASCII measurement log will have an entry with:
(converted from ASCII to text for readability)

10 56c00cc062ffc24ccd9ac2d67d194af3282b934e ima-buf sha256:e7d12c03b958b4e0e53e7363a06376be88d98a1ac191fdbd3baf5e4b77f329b6
dm_device_resume
dm_version=4.45.0;
name=linear1,uuid=,major=253,minor=0,minor_count=1,num_targets=4;
active_table_hash=sha256:4d73481ecce5eadba8ab084640d85bb9ca899af4d0a122989252a76efadc5b72;current_device_capacity=8;
</pre></div>
</div>
</section>
<section id="device-remove">
<h3>3. Device remove:<a class="headerlink" href="#device-remove" title="Permalink to this headline">¶</a></h3>
<p>When a device is removed, the device information and a sha256 hash of the
data from an active and inactive table are measured.</p>
<p>The IMA measurement log has the following format for ‘dm_device_remove’:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>EVENT_NAME := &quot;dm_device_remove&quot;
EVENT_DATA := &lt;dm_version_str&gt; &quot;;&quot; &lt;device_active_metadata&gt; &quot;;&quot; &lt;device_inactive_metadata&gt; &quot;;&quot;
              &lt;active_table_hash&gt; &quot;,&quot; &lt;inactive_table_hash&gt; &quot;,&quot; &lt;remove_all&gt; &quot;;&quot; &lt;current_device_capacity&gt; &quot;;&quot;

dm_version_str := As described in the &#39;Table load&#39; section above.
device_active_metadata := Device metadata that reflects the currently loaded active table.
                          The format is same as &#39;device_metadata&#39; described in the &#39;Table load&#39; section above.
device_inactive_metadata := Device metadata that reflects the inactive table.
                            The format is same as &#39;device_metadata&#39; described in the &#39;Table load&#39; section above.
active_table_hash := Hash of the currently loaded active table.
                     The format is same as &#39;active_table_hash&#39; described in the &#39;Device resume&#39; section above.
inactive_table_hash :=  Hash of the inactive table.
                        The format is same as &#39;active_table_hash&#39; described in the &#39;Device resume&#39; section above.
remove_all := &quot;remove_all=&quot; &lt;yes_no&gt;
yes_no := &quot;y&quot; | &quot;n&quot;
current_device_capacity := &quot;current_device_capacity=&quot; &lt;N&gt;

For instance, if a linear device is removed with the following command,
 #dmsetup remove l1

then IMA ASCII measurement log will have the following entry:
(converted from ASCII to text for readability)

10 790e830a3a7a31590824ac0642b3b31c2d0e8b38 ima-buf sha256:ab9f3c959367a8f5d4403d6ce9c3627dadfa8f9f0e7ec7899299782388de3840
dm_device_remove
dm_version=4.45.0;
device_active_metadata=name=l1,uuid=,major=253,minor=2,minor_count=1,num_targets=2;
device_inactive_metadata=name=l1,uuid=,major=253,minor=2,minor_count=1,num_targets=1;
active_table_hash=sha256:4a7e62efaebfc86af755831998b7db6f59b60d23c9534fb16a4455907957953a,
inactive_table_hash=sha256:9d79c175bc2302d55a183e8f50ad4bafd60f7692fd6249e5fd213e2464384b86,remove_all=n;
current_device_capacity=2048;
</pre></div>
</div>
</section>
<section id="table-clear">
<h3>4. Table clear:<a class="headerlink" href="#table-clear" title="Permalink to this headline">¶</a></h3>
<p>When an inactive table is cleared from the device, the device information and a sha256 hash of the
data from an inactive table are measured.</p>
<p>The IMA measurement log has the following format for ‘dm_table_clear’:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>EVENT_NAME := &quot;dm_table_clear&quot;
EVENT_DATA := &lt;dm_version_str&gt; &quot;;&quot; &lt;device_inactive_metadata&gt; &quot;;&quot; &lt;inactive_table_hash&gt; &quot;;&quot; &lt;current_device_capacity&gt; &quot;;&quot;

dm_version_str := As described in the &#39;Table load&#39; section above.
device_inactive_metadata := Device metadata that was captured during the load time inactive table being cleared.
                            The format is same as &#39;device_metadata&#39; described in the &#39;Table load&#39; section above.
inactive_table_hash := Hash of the inactive table being cleared from the device.
                       The format is same as &#39;active_table_hash&#39; described in the &#39;Device resume&#39; section above.
current_device_capacity := &quot;current_device_capacity=&quot; &lt;N&gt;

For instance, if a linear device&#39;s inactive table is cleared,
 #dmsetup clear l1

then IMA ASCII measurement log will have an entry with:
(converted from ASCII to text for readability)

10 77d347408f557f68f0041acb0072946bb2367fe5 ima-buf sha256:42f9ca22163fdfa548e6229dece2959bc5ce295c681644240035827ada0e1db5
dm_table_clear
dm_version=4.45.0;
name=l1,uuid=,major=253,minor=2,minor_count=1,num_targets=1;
inactive_table_hash=sha256:75c0dc347063bf474d28a9907037eba060bfe39d8847fc0646d75e149045d545;current_device_capacity=1024;
</pre></div>
</div>
</section>
<section id="device-rename">
<h3>5. Device rename:<a class="headerlink" href="#device-rename" title="Permalink to this headline">¶</a></h3>
<p>When an device’s NAME or UUID is changed, the device information and the new NAME and UUID
are measured.</p>
<p>The IMA measurement log has the following format for ‘dm_device_rename’:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>EVENT_NAME := &quot;dm_device_rename&quot;
EVENT_DATA := &lt;dm_version_str&gt; &quot;;&quot; &lt;device_active_metadata&gt; &quot;;&quot; &lt;new_device_name&gt; &quot;,&quot; &lt;new_device_uuid&gt; &quot;;&quot; &lt;current_device_capacity&gt; &quot;;&quot;

dm_version_str := As described in the &#39;Table load&#39; section above.
device_active_metadata := Device metadata that reflects the currently loaded active table.
                          The format is same as &#39;device_metadata&#39; described in the &#39;Table load&#39; section above.
new_device_name := &quot;new_name=&quot; &lt;dm-device-name&gt;
dm-device-name := Same as &lt;dm-device-name&gt; described in &#39;Table load&#39; section above
new_device_uuid := &quot;new_uuid=&quot; &lt;dm-device-uuid&gt;
dm-device-uuid := Same as &lt;dm-device-uuid&gt; described in &#39;Table load&#39; section above
current_device_capacity := &quot;current_device_capacity=&quot; &lt;N&gt;

E.g 1: if a linear device&#39;s name is changed with the following command,
 #dmsetup rename linear1 --setuuid 1234-5678

then IMA ASCII measurement log will have an entry with:
(converted from ASCII to text for readability)

10 8b0423209b4c66ac1523f4c9848c9b51ee332f48 ima-buf sha256:6847b7258134189531db593e9230b257c84f04038b5a18fd2e1473860e0569ac
dm_device_rename
dm_version=4.45.0;
name=linear1,uuid=,major=253,minor=2,minor_count=1,num_targets=1;new_name=linear1,new_uuid=1234-5678;
current_device_capacity=1024;

E.g 2:  if a linear device&#39;s name is changed with the following command,
 # dmsetup rename linear1 linear=2

then IMA ASCII measurement log will have an entry with:
(converted from ASCII to text for readability)

10 bef70476b99c2bdf7136fae033aa8627da1bf76f ima-buf sha256:8c6f9f53b9ef9dc8f92a2f2cca8910e622543d0f0d37d484870cb16b95111402
dm_device_rename
dm_version=4.45.0;
name=linear1,uuid=1234-5678,major=253,minor=2,minor_count=1,num_targets=1;
new_name=linear\=2,new_uuid=1234-5678;
current_device_capacity=1024;
</pre></div>
</div>
</section>
</section>
<section id="supported-targets">
<h2>Supported targets:<a class="headerlink" href="#supported-targets" title="Permalink to this headline">¶</a></h2>
<p>Following targets are supported to measure their data using IMA:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>cache</p></li>
<li><p>crypt</p></li>
<li><p>integrity</p></li>
<li><p>linear</p></li>
<li><p>mirror</p></li>
<li><p>multipath</p></li>
<li><p>raid</p></li>
<li><p>snapshot</p></li>
<li><p>striped</p></li>
<li><p>verity</p></li>
</ol>
</div></blockquote>
<section id="cache">
<h3>1. cache<a class="headerlink" href="#cache" title="Permalink to this headline">¶</a></h3>
<p>The ‘target_attributes’ (described as part of EVENT_DATA in ‘Table load’
section above) has the following data format for ‘cache’ target.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>target_attributes := &lt;target_name&gt; &quot;,&quot; &lt;target_version&gt; &quot;,&quot; &lt;metadata_mode&gt; &quot;,&quot; &lt;cache_metadata_device&gt; &quot;,&quot;
                     &lt;cache_device&gt; &quot;,&quot; &lt;cache_origin_device&gt; &quot;,&quot; &lt;writethrough&gt; &quot;,&quot; &lt;writeback&gt; &quot;,&quot;
                     &lt;passthrough&gt; &quot;,&quot; &lt;no_discard_passdown&gt; &quot;;&quot;

target_name := &quot;target_name=cache&quot;
target_version := &quot;target_version=&quot; &lt;N&gt; &quot;.&quot; &lt;N&gt; &quot;.&quot; &lt;N&gt;
metadata_mode := &quot;metadata_mode=&quot; &lt;cache_metadata_mode&gt;
cache_metadata_mode := &quot;fail&quot; | &quot;ro&quot; | &quot;rw&quot;
cache_device := &quot;cache_device=&quot; &lt;cache_device_name_string&gt;
cache_origin_device := &quot;cache_origin_device=&quot; &lt;cache_origin_device_string&gt;
writethrough := &quot;writethrough=&quot; &lt;yes_no&gt;
writeback := &quot;writeback=&quot; &lt;yes_no&gt;
passthrough := &quot;passthrough=&quot; &lt;yes_no&gt;
no_discard_passdown := &quot;no_discard_passdown=&quot; &lt;yes_no&gt;
yes_no := &quot;y&quot; | &quot;n&quot;

E.g.
When a &#39;cache&#39; target is loaded, then IMA ASCII measurement log will have an entry
similar to the following, depicting what &#39;cache&#39; attributes are measured in EVENT_DATA
for &#39;dm_table_load&#39; event.
(converted from ASCII to text for readability)

dm_version=4.45.0;name=cache1,uuid=cache_uuid,major=253,minor=2,minor_count=1,num_targets=1;
target_index=0,target_begin=0,target_len=28672,target_name=cache,target_version=2.2.0,metadata_mode=rw,
cache_metadata_device=253:4,cache_device=253:3,cache_origin_device=253:5,writethrough=y,writeback=n,
passthrough=n,metadata2=y,no_discard_passdown=n;
</pre></div>
</div>
</section>
<section id="crypt">
<h3>2. crypt<a class="headerlink" href="#crypt" title="Permalink to this headline">¶</a></h3>
<p>The ‘target_attributes’ (described as part of EVENT_DATA in ‘Table load’
section above) has the following data format for ‘crypt’ target.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>target_attributes := &lt;target_name&gt; &quot;,&quot; &lt;target_version&gt; &quot;,&quot; &lt;allow_discards&gt; &quot;,&quot; &lt;same_cpu_crypt&gt; &quot;,&quot;
                     &lt;submit_from_crypt_cpus&gt; &quot;,&quot; &lt;no_read_workqueue&gt; &quot;,&quot; &lt;no_write_workqueue&gt; &quot;,&quot;
                     &lt;iv_large_sectors&gt; &quot;,&quot; &lt;iv_large_sectors&gt; &quot;,&quot; [&lt;integrity_tag_size&gt; &quot;,&quot;] [&lt;cipher_auth&gt; &quot;,&quot;]
                     [&lt;sector_size&gt; &quot;,&quot;] [&lt;cipher_string&gt; &quot;,&quot;] &lt;key_size&gt; &quot;,&quot; &lt;key_parts&gt; &quot;,&quot;
                     &lt;key_extra_size&gt; &quot;,&quot; &lt;key_mac_size&gt; &quot;;&quot;

target_name := &quot;target_name=crypt&quot;
target_version := &quot;target_version=&quot; &lt;N&gt; &quot;.&quot; &lt;N&gt; &quot;.&quot; &lt;N&gt;
allow_discards := &quot;allow_discards=&quot; &lt;yes_no&gt;
same_cpu_crypt := &quot;same_cpu_crypt=&quot; &lt;yes_no&gt;
submit_from_crypt_cpus := &quot;submit_from_crypt_cpus=&quot; &lt;yes_no&gt;
no_read_workqueue := &quot;no_read_workqueue=&quot; &lt;yes_no&gt;
no_write_workqueue := &quot;no_write_workqueue=&quot; &lt;yes_no&gt;
iv_large_sectors := &quot;iv_large_sectors=&quot; &lt;yes_no&gt;
integrity_tag_size := &quot;integrity_tag_size=&quot; &lt;N&gt;
cipher_auth := &quot;cipher_auth=&quot; &lt;string&gt;
sector_size := &quot;sector_size=&quot;  &lt;N&gt;
cipher_string := &quot;cipher_string=&quot;
key_size := &quot;key_size=&quot;  &lt;N&gt;
key_parts := &quot;key_parts=&quot;  &lt;N&gt;
key_extra_size := &quot;key_extra_size=&quot;  &lt;N&gt;
key_mac_size := &quot;key_mac_size=&quot;  &lt;N&gt;
yes_no := &quot;y&quot; | &quot;n&quot;

E.g.
When a &#39;crypt&#39; target is loaded, then IMA ASCII measurement log will have an entry
similar to the following, depicting what &#39;crypt&#39; attributes are measured in EVENT_DATA
for &#39;dm_table_load&#39; event.
(converted from ASCII to text for readability)

dm_version=4.45.0;
name=crypt1,uuid=crypt_uuid1,major=253,minor=0,minor_count=1,num_targets=1;
target_index=0,target_begin=0,target_len=1953125,target_name=crypt,target_version=1.23.0,
allow_discards=y,same_cpu=n,submit_from_crypt_cpus=n,no_read_workqueue=n,no_write_workqueue=n,
iv_large_sectors=n,cipher_string=aes-xts-plain64,key_size=32,key_parts=1,key_extra_size=0,key_mac_size=0;
</pre></div>
</div>
</section>
<section id="integrity">
<h3>3. integrity<a class="headerlink" href="#integrity" title="Permalink to this headline">¶</a></h3>
<p>The ‘target_attributes’ (described as part of EVENT_DATA in ‘Table load’
section above) has the following data format for ‘integrity’ target.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>target_attributes := &lt;target_name&gt; &quot;,&quot; &lt;target_version&gt; &quot;,&quot; &lt;dev_name&gt; &quot;,&quot; &lt;start&gt;
                     &lt;tag_size&gt; &quot;,&quot; &lt;mode&gt; &quot;,&quot; [&lt;meta_device&gt; &quot;,&quot;] [&lt;block_size&gt; &quot;,&quot;] &lt;recalculate&gt; &quot;,&quot;
                     &lt;allow_discards&gt; &quot;,&quot; &lt;fix_padding&gt; &quot;,&quot; &lt;fix_hmac&gt; &quot;,&quot; &lt;legacy_recalculate&gt; &quot;,&quot;
                     &lt;journal_sectors&gt; &quot;,&quot; &lt;interleave_sectors&gt; &quot;,&quot; &lt;buffer_sectors&gt; &quot;;&quot;

target_name := &quot;target_name=integrity&quot;
target_version := &quot;target_version=&quot; &lt;N&gt; &quot;.&quot; &lt;N&gt; &quot;.&quot; &lt;N&gt;
dev_name := &quot;dev_name=&quot; &lt;device_name_str&gt;
start := &quot;start=&quot; &lt;N&gt;
tag_size := &quot;tag_size=&quot; &lt;N&gt;
mode := &quot;mode=&quot; &lt;integrity_mode_str&gt;
integrity_mode_str := &quot;J&quot; | &quot;B&quot; | &quot;D&quot; | &quot;R&quot;
meta_device := &quot;meta_device=&quot; &lt;meta_device_str&gt;
block_size := &quot;block_size=&quot; &lt;N&gt;
recalculate := &quot;recalculate=&quot; &lt;yes_no&gt;
allow_discards := &quot;allow_discards=&quot; &lt;yes_no&gt;
fix_padding := &quot;fix_padding=&quot; &lt;yes_no&gt;
fix_hmac := &quot;fix_hmac=&quot; &lt;yes_no&gt;
legacy_recalculate := &quot;legacy_recalculate=&quot; &lt;yes_no&gt;
journal_sectors := &quot;journal_sectors=&quot; &lt;N&gt;
interleave_sectors := &quot;interleave_sectors=&quot; &lt;N&gt;
buffer_sectors := &quot;buffer_sectors=&quot; &lt;N&gt;
yes_no := &quot;y&quot; | &quot;n&quot;

E.g.
When a &#39;integrity&#39; target is loaded, then IMA ASCII measurement log will have an entry
similar to the following, depicting what &#39;integrity&#39; attributes are measured in EVENT_DATA
for &#39;dm_table_load&#39; event.
(converted from ASCII to text for readability)

dm_version=4.45.0;
name=integrity1,uuid=,major=253,minor=1,minor_count=1,num_targets=1;
target_index=0,target_begin=0,target_len=7856,target_name=integrity,target_version=1.10.0,
dev_name=253:0,start=0,tag_size=32,mode=J,recalculate=n,allow_discards=n,fix_padding=n,
fix_hmac=n,legacy_recalculate=n,journal_sectors=88,interleave_sectors=32768,buffer_sectors=128;
</pre></div>
</div>
</section>
<section id="linear">
<h3>4. linear<a class="headerlink" href="#linear" title="Permalink to this headline">¶</a></h3>
<p>The ‘target_attributes’ (described as part of EVENT_DATA in ‘Table load’
section above) has the following data format for ‘linear’ target.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>target_attributes := &lt;target_name&gt; &quot;,&quot; &lt;target_version&gt; &quot;,&quot; &lt;device_name&gt; &lt;,&gt; &lt;start&gt; &quot;;&quot;

target_name := &quot;target_name=linear&quot;
target_version := &quot;target_version=&quot; &lt;N&gt; &quot;.&quot; &lt;N&gt; &quot;.&quot; &lt;N&gt;
device_name := &quot;device_name=&quot; &lt;linear_device_name_str&gt;
start := &quot;start=&quot; &lt;N&gt;

E.g.
When a &#39;linear&#39; target is loaded, then IMA ASCII measurement log will have an entry
similar to the following, depicting what &#39;linear&#39; attributes are measured in EVENT_DATA
for &#39;dm_table_load&#39; event.
(converted from ASCII to text for readability)

dm_version=4.45.0;
name=linear1,uuid=linear_uuid1,major=253,minor=2,minor_count=1,num_targets=1;
target_index=0,target_begin=0,target_len=28672,target_name=linear,target_version=1.4.0,
device_name=253:1,start=2048;
</pre></div>
</div>
</section>
<section id="mirror">
<h3>5. mirror<a class="headerlink" href="#mirror" title="Permalink to this headline">¶</a></h3>
<p>The ‘target_attributes’ (described as part of EVENT_DATA in ‘Table load’
section above) has the following data format for ‘mirror’ target.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>target_attributes := &lt;target_name&gt; &quot;,&quot; &lt;target_version&gt; &quot;,&quot; &lt;nr_mirrors&gt; &quot;,&quot;
                     &lt;mirror_device_data&gt; &quot;,&quot; &lt;handle_errors&gt; &quot;,&quot; &lt;keep_log&gt; &quot;,&quot; &lt;log_type_status&gt; &quot;;&quot;

target_name := &quot;target_name=mirror&quot;
target_version := &quot;target_version=&quot; &lt;N&gt; &quot;.&quot; &lt;N&gt; &quot;.&quot; &lt;N&gt;
nr_mirrors := &quot;nr_mirrors=&quot; &lt;NR&gt;
mirror_device_data := &lt;mirror_device_row&gt; | &lt;mirror_device_data&gt;&lt;mirror_device_row&gt;
                      mirror_device_row is repeated &lt;NR&gt; times - for &lt;NR&gt; described in &lt;nr_mirrors&gt;.
mirror_device_row := &lt;mirror_device_name&gt; &quot;,&quot; &lt;mirror_device_status&gt;
mirror_device_name := &quot;mirror_device_&quot; &lt;X&gt; &quot;=&quot; &lt;mirror_device_name_str&gt;
                      where &lt;X&gt; ranges from 0 to (&lt;NR&gt; -1) - for &lt;NR&gt; described in &lt;nr_mirrors&gt;.
mirror_device_status := &quot;mirror_device_&quot; &lt;X&gt; &quot;_status=&quot; &lt;mirror_device_status_char&gt;
                        where &lt;X&gt; ranges from 0 to (&lt;NR&gt; -1) - for &lt;NR&gt; described in &lt;nr_mirrors&gt;.
mirror_device_status_char := &quot;A&quot; | &quot;F&quot; | &quot;D&quot; | &quot;S&quot; | &quot;R&quot; | &quot;U&quot;
handle_errors := &quot;handle_errors=&quot; &lt;yes_no&gt;
keep_log := &quot;keep_log=&quot; &lt;yes_no&gt;
log_type_status := &quot;log_type_status=&quot; &lt;log_type_status_str&gt;
yes_no := &quot;y&quot; | &quot;n&quot;

E.g.
When a &#39;mirror&#39; target is loaded, then IMA ASCII measurement log will have an entry
similar to the following, depicting what &#39;mirror&#39; attributes are measured in EVENT_DATA
for &#39;dm_table_load&#39; event.
(converted from ASCII to text for readability)

dm_version=4.45.0;
name=mirror1,uuid=mirror_uuid1,major=253,minor=6,minor_count=1,num_targets=1;
target_index=0,target_begin=0,target_len=2048,target_name=mirror,target_version=1.14.0,nr_mirrors=2,
   mirror_device_0=253:4,mirror_device_0_status=A,
   mirror_device_1=253:5,mirror_device_1_status=A,
handle_errors=y,keep_log=n,log_type_status=;
</pre></div>
</div>
</section>
<section id="multipath">
<h3>6. multipath<a class="headerlink" href="#multipath" title="Permalink to this headline">¶</a></h3>
<p>The ‘target_attributes’ (described as part of EVENT_DATA in ‘Table load’
section above) has the following data format for ‘multipath’ target.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>target_attributes := &lt;target_name&gt; &quot;,&quot; &lt;target_version&gt; &quot;,&quot; &lt;nr_priority_groups&gt;
                     [&quot;,&quot; &lt;pg_state&gt; &quot;,&quot; &lt;priority_groups&gt; &quot;,&quot; &lt;priority_group_paths&gt;] &quot;;&quot;

target_name := &quot;target_name=multipath&quot;
target_version := &quot;target_version=&quot; &lt;N&gt; &quot;.&quot; &lt;N&gt; &quot;.&quot; &lt;N&gt;
nr_priority_groups := &quot;nr_priority_groups=&quot; &lt;NPG&gt;
priority_groups := &lt;priority_groups_row&gt;|&lt;priority_groups_row&gt;&lt;priority_groups&gt;
priority_groups_row := &quot;pg_state_&quot; &lt;X&gt; &quot;=&quot; &lt;pg_state_str&gt; &quot;,&quot; &quot;nr_pgpaths_&quot; &lt;X&gt;  &quot;=&quot; &lt;NPGP&gt; &quot;,&quot;
                       &quot;path_selector_name_&quot; &lt;X&gt; &quot;=&quot; &lt;string&gt; &quot;,&quot; &lt;priority_group_paths&gt;
                       where &lt;X&gt; ranges from 0 to (&lt;NPG&gt; -1) - for &lt;NPG&gt; described in &lt;nr_priority_groups&gt;.
pg_state_str := &quot;E&quot; | &quot;A&quot; | &quot;D&quot;
&lt;priority_group_paths&gt; := &lt;priority_group_paths_row&gt; | &lt;priority_group_paths_row&gt;&lt;priority_group_paths&gt;
priority_group_paths_row := &quot;path_name_&quot; &lt;X&gt; &quot;_&quot; &lt;Y&gt; &quot;=&quot; &lt;string&gt; &quot;,&quot; &quot;is_active_&quot; &lt;X&gt; &quot;_&quot; &lt;Y&gt; &quot;=&quot; &lt;is_active_str&gt;
                            &quot;fail_count_&quot; &lt;X&gt; &quot;_&quot; &lt;Y&gt; &quot;=&quot; &lt;N&gt; &quot;,&quot; &quot;path_selector_status_&quot; &lt;X&gt; &quot;_&quot; &lt;Y&gt; &quot;=&quot; &lt;path_selector_status_str&gt;
                            where &lt;X&gt; ranges from 0 to (&lt;NPG&gt; -1) - for &lt;NPG&gt; described in &lt;nr_priority_groups&gt;,
                            and &lt;Y&gt; ranges from 0 to (&lt;NPGP&gt; -1) - for &lt;NPGP&gt; described in &lt;priority_groups_row&gt;.
is_active_str := &quot;A&quot; | &quot;F&quot;

E.g.
When a &#39;multipath&#39; target is loaded, then IMA ASCII measurement log will have an entry
similar to the following, depicting what &#39;multipath&#39; attributes are measured in EVENT_DATA
for &#39;dm_table_load&#39; event.
(converted from ASCII to text for readability)

dm_version=4.45.0;
name=mp,uuid=,major=253,minor=0,minor_count=1,num_targets=1;
target_index=0,target_begin=0,target_len=2097152,target_name=multipath,target_version=1.14.0,nr_priority_groups=2,
   pg_state_0=E,nr_pgpaths_0=2,path_selector_name_0=queue-length,
       path_name_0_0=8:16,is_active_0_0=A,fail_count_0_0=0,path_selector_status_0_0=,
       path_name_0_1=8:32,is_active_0_1=A,fail_count_0_1=0,path_selector_status_0_1=,
   pg_state_1=E,nr_pgpaths_1=2,path_selector_name_1=queue-length,
       path_name_1_0=8:48,is_active_1_0=A,fail_count_1_0=0,path_selector_status_1_0=,
       path_name_1_1=8:64,is_active_1_1=A,fail_count_1_1=0,path_selector_status_1_1=;
</pre></div>
</div>
</section>
<section id="raid">
<h3>7. raid<a class="headerlink" href="#raid" title="Permalink to this headline">¶</a></h3>
<p>The ‘target_attributes’ (described as part of EVENT_DATA in ‘Table load’
section above) has the following data format for ‘raid’ target.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>target_attributes := &lt;target_name&gt; &quot;,&quot; &lt;target_version&gt; &quot;,&quot; &lt;raid_type&gt; &quot;,&quot; &lt;raid_disks&gt; &quot;,&quot; &lt;raid_state&gt;
                     &lt;raid_device_status&gt; [&quot;,&quot; journal_dev_mode] &quot;;&quot;

target_name := &quot;target_name=raid&quot;
target_version := &quot;target_version=&quot; &lt;N&gt; &quot;.&quot; &lt;N&gt; &quot;.&quot; &lt;N&gt;
raid_type := &quot;raid_type=&quot; &lt;raid_type_str&gt;
raid_disks := &quot;raid_disks=&quot; &lt;NRD&gt;
raid_state := &quot;raid_state=&quot; &lt;raid_state_str&gt;
raid_state_str := &quot;frozen&quot; | &quot;reshape&quot; |&quot;resync&quot; | &quot;check&quot; | &quot;repair&quot; | &quot;recover&quot; | &quot;idle&quot; |&quot;undef&quot;
raid_device_status := &lt;raid_device_status_row&gt; | &lt;raid_device_status_row&gt;&lt;raid_device_status&gt;
                      &lt;raid_device_status_row&gt; is repeated &lt;NRD&gt; times - for &lt;NRD&gt; described in &lt;raid_disks&gt;.
raid_device_status_row := &quot;raid_device_&quot; &lt;X&gt; &quot;_status=&quot; &lt;raid_device_status_str&gt;
                          where &lt;X&gt; ranges from 0 to (&lt;NRD&gt; -1) - for &lt;NRD&gt; described in &lt;raid_disks&gt;.
raid_device_status_str := &quot;A&quot; | &quot;D&quot; | &quot;a&quot; | &quot;-&quot;
journal_dev_mode := &quot;journal_dev_mode=&quot; &lt;journal_dev_mode_str&gt;
journal_dev_mode_str := &quot;writethrough&quot; | &quot;writeback&quot; | &quot;invalid&quot;

E.g.
When a &#39;raid&#39; target is loaded, then IMA ASCII measurement log will have an entry
similar to the following, depicting what &#39;raid&#39; attributes are measured in EVENT_DATA
for &#39;dm_table_load&#39; event.
(converted from ASCII to text for readability)

dm_version=4.45.0;
name=raid_LV1,uuid=uuid_raid_LV1,major=253,minor=12,minor_count=1,num_targets=1;
target_index=0,target_begin=0,target_len=2048,target_name=raid,target_version=1.15.1,
raid_type=raid10,raid_disks=4,raid_state=idle,
   raid_device_0_status=A,
   raid_device_1_status=A,
   raid_device_2_status=A,
   raid_device_3_status=A;
</pre></div>
</div>
</section>
<section id="snapshot">
<h3>8. snapshot<a class="headerlink" href="#snapshot" title="Permalink to this headline">¶</a></h3>
<p>The ‘target_attributes’ (described as part of EVENT_DATA in ‘Table load’
section above) has the following data format for ‘snapshot’ target.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>target_attributes := &lt;target_name&gt; &quot;,&quot; &lt;target_version&gt; &quot;,&quot; &lt;snap_origin_name&gt; &quot;,&quot;
                     &lt;snap_cow_name&gt; &quot;,&quot; &lt;snap_valid&gt; &quot;,&quot; &lt;snap_merge_failed&gt; &quot;,&quot; &lt;snapshot_overflowed&gt; &quot;;&quot;

target_name := &quot;target_name=snapshot&quot;
target_version := &quot;target_version=&quot; &lt;N&gt; &quot;.&quot; &lt;N&gt; &quot;.&quot; &lt;N&gt;
snap_origin_name := &quot;snap_origin_name=&quot; &lt;string&gt;
snap_cow_name := &quot;snap_cow_name=&quot; &lt;string&gt;
snap_valid := &quot;snap_valid=&quot; &lt;yes_no&gt;
snap_merge_failed := &quot;snap_merge_failed=&quot; &lt;yes_no&gt;
snapshot_overflowed := &quot;snapshot_overflowed=&quot; &lt;yes_no&gt;
yes_no := &quot;y&quot; | &quot;n&quot;

E.g.
When a &#39;snapshot&#39; target is loaded, then IMA ASCII measurement log will have an entry
similar to the following, depicting what &#39;snapshot&#39; attributes are measured in EVENT_DATA
for &#39;dm_table_load&#39; event.
(converted from ASCII to text for readability)

dm_version=4.45.0;
name=snap1,uuid=snap_uuid1,major=253,minor=13,minor_count=1,num_targets=1;
target_index=0,target_begin=0,target_len=4096,target_name=snapshot,target_version=1.16.0,
snap_origin_name=253:11,snap_cow_name=253:12,snap_valid=y,snap_merge_failed=n,snapshot_overflowed=n;
</pre></div>
</div>
</section>
<section id="striped">
<h3>9. striped<a class="headerlink" href="#striped" title="Permalink to this headline">¶</a></h3>
<p>The ‘target_attributes’ (described as part of EVENT_DATA in ‘Table load’
section above) has the following data format for ‘striped’ target.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>target_attributes := &lt;target_name&gt; &quot;,&quot; &lt;target_version&gt; &quot;,&quot; &lt;stripes&gt; &quot;,&quot; &lt;chunk_size&gt; &quot;,&quot;
                     &lt;stripe_data&gt; &quot;;&quot;

target_name := &quot;target_name=striped&quot;
target_version := &quot;target_version=&quot; &lt;N&gt; &quot;.&quot; &lt;N&gt; &quot;.&quot; &lt;N&gt;
stripes := &quot;stripes=&quot; &lt;NS&gt;
chunk_size := &quot;chunk_size=&quot; &lt;N&gt;
stripe_data := &lt;stripe_data_row&gt;|&lt;stripe_data&gt;&lt;stripe_data_row&gt;
stripe_data_row := &lt;stripe_device_name&gt; &quot;,&quot; &lt;stripe_physical_start&gt; &quot;,&quot; &lt;stripe_status&gt;
stripe_device_name := &quot;stripe_&quot; &lt;X&gt; &quot;_device_name=&quot; &lt;stripe_device_name_str&gt;
                      where &lt;X&gt; ranges from 0 to (&lt;NS&gt; -1) - for &lt;NS&gt; described in &lt;stripes&gt;.
stripe_physical_start := &quot;stripe_&quot; &lt;X&gt; &quot;_physical_start=&quot; &lt;N&gt;
                          where &lt;X&gt; ranges from 0 to (&lt;NS&gt; -1) - for &lt;NS&gt; described in &lt;stripes&gt;.
stripe_status := &quot;stripe_&quot; &lt;X&gt; &quot;_status=&quot; &lt;stripe_status_str&gt;
                 where &lt;X&gt; ranges from 0 to (&lt;NS&gt; -1) - for &lt;NS&gt; described in &lt;stripes&gt;.
stripe_status_str := &quot;D&quot; | &quot;A&quot;

E.g.
When a &#39;striped&#39; target is loaded, then IMA ASCII measurement log will have an entry
similar to the following, depicting what &#39;striped&#39; attributes are measured in EVENT_DATA
for &#39;dm_table_load&#39; event.
(converted from ASCII to text for readability)

dm_version=4.45.0;
name=striped1,uuid=striped_uuid1,major=253,minor=5,minor_count=1,num_targets=1;
target_index=0,target_begin=0,target_len=640,target_name=striped,target_version=1.6.0,stripes=2,chunk_size=64,
   stripe_0_device_name=253:0,stripe_0_physical_start=2048,stripe_0_status=A,
   stripe_1_device_name=253:3,stripe_1_physical_start=2048,stripe_1_status=A;
</pre></div>
</div>
</section>
<section id="verity">
<h3>10. verity<a class="headerlink" href="#verity" title="Permalink to this headline">¶</a></h3>
<p>The ‘target_attributes’ (described as part of EVENT_DATA in ‘Table load’
section above) has the following data format for ‘verity’ target.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>target_attributes := &lt;target_name&gt; &quot;,&quot; &lt;target_version&gt; &quot;,&quot; &lt;hash_failed&gt; &quot;,&quot; &lt;verity_version&gt; &quot;,&quot;
                     &lt;data_device_name&gt; &quot;,&quot; &lt;hash_device_name&gt; &quot;,&quot; &lt;verity_algorithm&gt; &quot;,&quot; &lt;root_digest&gt; &quot;,&quot;
                     &lt;salt&gt; &quot;,&quot; &lt;ignore_zero_blocks&gt; &quot;,&quot; &lt;check_at_most_once&gt; [&quot;,&quot; &lt;root_hash_sig_key_desc&gt;]
                     [&quot;,&quot; &lt;verity_mode&gt;] &quot;;&quot;

target_name := &quot;target_name=verity&quot;
target_version := &quot;target_version=&quot; &lt;N&gt; &quot;.&quot; &lt;N&gt; &quot;.&quot; &lt;N&gt;
hash_failed := &quot;hash_failed=&quot; &lt;hash_failed_str&gt;
hash_failed_str := &quot;C&quot; | &quot;V&quot;
verity_version := &quot;verity_version=&quot; &lt;verity_version_str&gt;
data_device_name := &quot;data_device_name=&quot; &lt;data_device_name_str&gt;
hash_device_name := &quot;hash_device_name=&quot; &lt;hash_device_name_str&gt;
verity_algorithm := &quot;verity_algorithm=&quot; &lt;verity_algorithm_str&gt;
root_digest := &quot;root_digest=&quot; &lt;root_digest_str&gt;
salt := &quot;salt=&quot; &lt;salt_str&gt;
salt_str := &quot;-&quot; &lt;verity_salt_str&gt;
ignore_zero_blocks := &quot;ignore_zero_blocks=&quot; &lt;yes_no&gt;
check_at_most_once := &quot;check_at_most_once=&quot; &lt;yes_no&gt;
root_hash_sig_key_desc := &quot;root_hash_sig_key_desc=&quot;
verity_mode := &quot;verity_mode=&quot; &lt;verity_mode_str&gt;
verity_mode_str := &quot;ignore_corruption&quot; | &quot;restart_on_corruption&quot; | &quot;panic_on_corruption&quot; | &quot;invalid&quot;
yes_no := &quot;y&quot; | &quot;n&quot;

E.g.
When a &#39;verity&#39; target is loaded, then IMA ASCII measurement log will have an entry
similar to the following, depicting what &#39;verity&#39; attributes are measured in EVENT_DATA
for &#39;dm_table_load&#39; event.
(converted from ASCII to text for readability)

dm_version=4.45.0;
name=test-verity,uuid=,major=253,minor=2,minor_count=1,num_targets=1;
target_index=0,target_begin=0,target_len=1953120,target_name=verity,target_version=1.8.0,hash_failed=V,
verity_version=1,data_device_name=253:1,hash_device_name=253:0,verity_algorithm=sha256,
root_digest=29cb87e60ce7b12b443ba6008266f3e41e93e403d7f298f8e3f316b29ff89c5e,
salt=e48da609055204e89ae53b655ca2216dd983cf3cb829f34f63a297d106d53e2d,
ignore_zero_blocks=n,check_at_most_once=n;
</pre></div>
</div>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">dm-ima</a><ul>
<li><a class="reference internal" href="#setting-the-ima-policy">Setting the IMA Policy:</a></li>
<li><a class="reference internal" href="#supported-device-states">Supported Device States:</a><ul>
<li><a class="reference internal" href="#table-load">1. Table load:</a></li>
<li><a class="reference internal" href="#device-resume">2. Device resume:</a></li>
<li><a class="reference internal" href="#device-remove">3. Device remove:</a></li>
<li><a class="reference internal" href="#table-clear">4. Table clear:</a></li>
<li><a class="reference internal" href="#device-rename">5. Device rename:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#supported-targets">Supported targets:</a><ul>
<li><a class="reference internal" href="#cache">1. cache</a></li>
<li><a class="reference internal" href="#crypt">2. crypt</a></li>
<li><a class="reference internal" href="#integrity">3. integrity</a></li>
<li><a class="reference internal" href="#linear">4. linear</a></li>
<li><a class="reference internal" href="#mirror">5. mirror</a></li>
<li><a class="reference internal" href="#multipath">6. multipath</a></li>
<li><a class="reference internal" href="#raid">7. raid</a></li>
<li><a class="reference internal" href="#snapshot">8. snapshot</a></li>
<li><a class="reference internal" href="#striped">9. striped</a></li>
<li><a class="reference internal" href="#verity">10. verity</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/admin-guide/device-mapper/dm-ima.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/admin-guide/device-mapper/dm-ima.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>