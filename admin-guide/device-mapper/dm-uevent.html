
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>device-mapper uevent &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="dm-zoned" href="dm-zoned.html" />
    <link rel="prev" title="dm-service-time" href="dm-service-time.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="device-mapper-uevent">
<h1>device-mapper uevent<a class="headerlink" href="#device-mapper-uevent" title="Permalink to this headline">¶</a></h1>
<p>The device-mapper uevent code adds the capability to device-mapper to create
and send kobject uevents (uevents).  Previously device-mapper events were only
available through the ioctl interface.  The advantage of the uevents interface
is the event contains environment attributes providing increased context for
the event avoiding the need to query the state of the device-mapper device after
the event is received.</p>
<p>There are two functions currently for device-mapper events.  The first function
listed creates the event and the second function sends the event(s):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>void dm_path_uevent(enum dm_uevent_type event_type, struct dm_target *ti,
                    const char *path, unsigned nr_valid_paths)

void dm_send_uevents(struct list_head *events, struct kobject *kobj)
</pre></div>
</div>
<p>The variables added to the uevent environment are:</p>
<section id="variable-name-dm-target">
<h2>Variable Name: DM_TARGET<a class="headerlink" href="#variable-name-dm-target" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Uevent Action(s)</dt>
<dd class="field-odd"><p>KOBJ_CHANGE</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>string</p>
</dd>
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">Value</dt>
<dd class="field-even"><p>Name of device-mapper target that generated the event.</p>
</dd>
</dl>
</section>
<section id="variable-name-dm-action">
<h2>Variable Name: DM_ACTION<a class="headerlink" href="#variable-name-dm-action" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Uevent Action(s)</dt>
<dd class="field-odd"><p>KOBJ_CHANGE</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>string</p>
</dd>
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">Value</dt>
<dd class="field-even"><p>Device-mapper specific action that caused the uevent action.
PATH_FAILED - A path has failed;
PATH_REINSTATED - A path has been reinstated.</p>
</dd>
</dl>
</section>
<section id="variable-name-dm-seqnum">
<h2>Variable Name: DM_SEQNUM<a class="headerlink" href="#variable-name-dm-seqnum" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Uevent Action(s)</dt>
<dd class="field-odd"><p>KOBJ_CHANGE</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>unsigned integer</p>
</dd>
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>A sequence number for this specific device-mapper device.</p>
</dd>
<dt class="field-even">Value</dt>
<dd class="field-even"><p>Valid unsigned integer range.</p>
</dd>
</dl>
</section>
<section id="variable-name-dm-path">
<h2>Variable Name: DM_PATH<a class="headerlink" href="#variable-name-dm-path" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Uevent Action(s)</dt>
<dd class="field-odd"><p>KOBJ_CHANGE</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>string</p>
</dd>
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Major and minor number of the path device pertaining to this
event.</p>
</dd>
<dt class="field-even">Value</dt>
<dd class="field-even"><p>Path name in the form of “Major:Minor”</p>
</dd>
</dl>
</section>
<section id="variable-name-dm-nr-valid-paths">
<h2>Variable Name: DM_NR_VALID_PATHS<a class="headerlink" href="#variable-name-dm-nr-valid-paths" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Uevent Action(s)</dt>
<dd class="field-odd"><p>KOBJ_CHANGE</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>unsigned integer</p>
</dd>
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">Value</dt>
<dd class="field-even"><p>Valid unsigned integer range.</p>
</dd>
</dl>
</section>
<section id="variable-name-dm-name">
<h2>Variable Name: DM_NAME<a class="headerlink" href="#variable-name-dm-name" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Uevent Action(s)</dt>
<dd class="field-odd"><p>KOBJ_CHANGE</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>string</p>
</dd>
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Name of the device-mapper device.</p>
</dd>
<dt class="field-even">Value</dt>
<dd class="field-even"><p>Name</p>
</dd>
</dl>
</section>
<section id="variable-name-dm-uuid">
<h2>Variable Name: DM_UUID<a class="headerlink" href="#variable-name-dm-uuid" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Uevent Action(s)</dt>
<dd class="field-odd"><p>KOBJ_CHANGE</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>string</p>
</dd>
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>UUID of the device-mapper device.</p>
</dd>
<dt class="field-even">Value</dt>
<dd class="field-even"><p>UUID. (Empty string if there isn’t one.)</p>
</dd>
</dl>
<p>An example of the uevents generated as captured by udevmonitor is shown
below</p>
<p>1.) Path failure:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>UEVENT[1192521009.711215] change@/block/dm-3
ACTION=change
DEVPATH=/block/dm-3
SUBSYSTEM=block
DM_TARGET=multipath
DM_ACTION=PATH_FAILED
DM_SEQNUM=1
DM_PATH=8:32
DM_NR_VALID_PATHS=0
DM_NAME=mpath2
DM_UUID=mpath-35333333000002328
MINOR=3
MAJOR=253
SEQNUM=1130
</pre></div>
</div>
<p>2.) Path reinstate:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>UEVENT[1192521132.989927] change@/block/dm-3
ACTION=change
DEVPATH=/block/dm-3
SUBSYSTEM=block
DM_TARGET=multipath
DM_ACTION=PATH_REINSTATED
DM_SEQNUM=2
DM_PATH=8:32
DM_NR_VALID_PATHS=1
DM_NAME=mpath2
DM_UUID=mpath-35333333000002328
MINOR=3
MAJOR=253
SEQNUM=1131
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">device-mapper uevent</a><ul>
<li><a class="reference internal" href="#variable-name-dm-target">Variable Name: DM_TARGET</a></li>
<li><a class="reference internal" href="#variable-name-dm-action">Variable Name: DM_ACTION</a></li>
<li><a class="reference internal" href="#variable-name-dm-seqnum">Variable Name: DM_SEQNUM</a></li>
<li><a class="reference internal" href="#variable-name-dm-path">Variable Name: DM_PATH</a></li>
<li><a class="reference internal" href="#variable-name-dm-nr-valid-paths">Variable Name: DM_NR_VALID_PATHS</a></li>
<li><a class="reference internal" href="#variable-name-dm-name">Variable Name: DM_NAME</a></li>
<li><a class="reference internal" href="#variable-name-dm-uuid">Variable Name: DM_UUID</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/admin-guide/device-mapper/dm-uevent.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/admin-guide/device-mapper/dm-uevent.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>