
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>ASoC Platform Driver &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="ASoC Machine Driver" href="machine.html" />
    <link rel="prev" title="Dynamic Audio Power Management for Portable Devices" href="dapm.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="asoc-platform-driver">
<h1>ASoC Platform Driver<a class="headerlink" href="#asoc-platform-driver" title="Permalink to this headline">¶</a></h1>
<p>An ASoC platform driver class can be divided into audio DMA drivers, SoC DAI
drivers and DSP drivers. The platform drivers only target the SoC CPU and must
have no board specific code.</p>
<section id="audio-dma">
<h2>Audio DMA<a class="headerlink" href="#audio-dma" title="Permalink to this headline">¶</a></h2>
<p>The platform DMA driver optionally supports the following ALSA operations:-</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/* SoC audio ops */
struct snd_soc_ops {
      int (*startup)(struct snd_pcm_substream *);
      void (*shutdown)(struct snd_pcm_substream *);
      int (*hw_params)(struct snd_pcm_substream *, struct snd_pcm_hw_params *);
      int (*hw_free)(struct snd_pcm_substream *);
      int (*prepare)(struct snd_pcm_substream *);
      int (*trigger)(struct snd_pcm_substream *, int);
};
</pre></div>
</div>
<p>The platform driver exports its DMA functionality via struct
snd_soc_component_driver:-</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct snd_soc_component_driver {
      const char *name;

      ...
      int (*probe)(struct snd_soc_component *);
      void (*remove)(struct snd_soc_component *);
      int (*suspend)(struct snd_soc_component *);
      int (*resume)(struct snd_soc_component *);

      /* pcm creation and destruction */
      int (*pcm_new)(struct snd_soc_pcm_runtime *);
      void (*pcm_free)(struct snd_pcm *);

      ...
      const struct snd_pcm_ops *ops;
      const struct snd_compr_ops *compr_ops;
      ...
};
</pre></div>
</div>
<p>Please refer to the ALSA driver documentation for details of audio DMA.
<a class="reference external" href="https://www.kernel.org/doc/html/latest/sound/kernel-api/writing-an-alsa-driver.html">https://www.kernel.org/doc/html/latest/sound/kernel-api/writing-an-alsa-driver.html</a></p>
<p>An example DMA driver is soc/pxa/pxa2xx-pcm.c</p>
</section>
<section id="soc-dai-drivers">
<h2>SoC DAI Drivers<a class="headerlink" href="#soc-dai-drivers" title="Permalink to this headline">¶</a></h2>
<p>Each SoC DAI driver must provide the following features:-</p>
<ol class="arabic simple">
<li><p>Digital audio interface (DAI) description</p></li>
<li><p>Digital audio interface configuration</p></li>
<li><p>PCM’s description</p></li>
<li><p>SYSCLK configuration</p></li>
<li><p>Suspend and resume (optional)</p></li>
</ol>
<p>Please see <a class="reference internal" href="codec.html"><span class="doc">ASoC Codec Class Driver</span></a> for a description of items 1 - 4.</p>
</section>
<section id="soc-dsp-drivers">
<h2>SoC DSP Drivers<a class="headerlink" href="#soc-dsp-drivers" title="Permalink to this headline">¶</a></h2>
<p>Each SoC DSP driver usually supplies the following features :-</p>
<ol class="arabic simple">
<li><p>DAPM graph</p></li>
<li><p>Mixer controls</p></li>
<li><p>DMA IO to/from DSP buffers (if applicable)</p></li>
<li><p>Definition of DSP front end (FE) PCM devices.</p></li>
</ol>
<p>Please see DPCM.txt for a description of item 4.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">ASoC Platform Driver</a><ul>
<li><a class="reference internal" href="#audio-dma">Audio DMA</a></li>
<li><a class="reference internal" href="#soc-dai-drivers">SoC DAI Drivers</a></li>
<li><a class="reference internal" href="#soc-dsp-drivers">SoC DSP Drivers</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/sound/soc/platform.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/sound/soc/platform.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>