
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>ALSA Jack Controls &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Tracepoints in ALSA" href="tracepoints.html" />
    <link rel="prev" title="ALSA PCM Timestamping" href="timestamping.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="alsa-jack-controls">
<h1>ALSA Jack Controls<a class="headerlink" href="#alsa-jack-controls" title="Permalink to this headline">¶</a></h1>
<section id="why-we-need-jack-kcontrols">
<h2>Why we need Jack kcontrols<a class="headerlink" href="#why-we-need-jack-kcontrols" title="Permalink to this headline">¶</a></h2>
<p>ALSA uses kcontrols to export audio controls(switch, volume, Mux, …)
to user space. This means userspace applications like pulseaudio can
switch off headphones and switch on speakers when no headphones are
pluged in.</p>
<p>The old ALSA jack code only created input devices for each registered
jack. These jack input devices are not readable by userspace devices
that run as non root.</p>
<p>The new jack code creates embedded jack kcontrols for each jack that
can be read by any process.</p>
<p>This can be combined with UCM to allow userspace to route audio more
intelligently based on jack insertion or removal events.</p>
</section>
<section id="jack-kcontrol-internals">
<h2>Jack Kcontrol Internals<a class="headerlink" href="#jack-kcontrol-internals" title="Permalink to this headline">¶</a></h2>
<p>Each jack will have a kcontrol list, so that we can create a kcontrol
and attach it to the jack, at jack creation stage. We can also add a
kcontrol to an existing jack, at anytime when required.</p>
<p>Those kcontrols will be freed automatically when the Jack is freed.</p>
</section>
<section id="how-to-use-jack-kcontrols">
<h2>How to use jack kcontrols<a class="headerlink" href="#how-to-use-jack-kcontrols" title="Permalink to this headline">¶</a></h2>
<p>In order to keep compatibility, <a class="reference internal" href="../kernel-api/alsa-driver-api.html#c.snd_jack_new" title="snd_jack_new"><code class="xref c c-func docutils literal notranslate"><span class="pre">snd_jack_new()</span></code></a> has been modified by
adding two params:</p>
<dl class="simple">
<dt>initial_kctl</dt><dd><p>if true, create a kcontrol and add it to the jack list.</p>
</dd>
<dt>phantom_jack</dt><dd><p>Don’t create a input device for phantom jacks.</p>
</dd>
</dl>
<p>HDA jacks can set phantom_jack to true in order to create a phantom
jack and set initial_kctl to true to create an initial kcontrol with
the correct id.</p>
<p>ASoC jacks should set initial_kctl as false. The pin name will be
assigned as the jack kcontrol name.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">ALSA Jack Controls</a><ul>
<li><a class="reference internal" href="#why-we-need-jack-kcontrols">Why we need Jack kcontrols</a></li>
<li><a class="reference internal" href="#jack-kcontrol-internals">Jack Kcontrol Internals</a></li>
<li><a class="reference internal" href="#how-to-use-jack-kcontrols">How to use jack kcontrols</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/sound/designs/jack-controls.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/sound/designs/jack-controls.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>