
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Operating FCoE using bnx2fc &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="BusLogic MultiMaster and FlashPoint SCSI Driver for Linux" href="BusLogic.html" />
    <link rel="prev" title="Linux driver for Brocade FC/FCOE adapters" href="bfa.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="operating-fcoe-using-bnx2fc">
<h1>Operating FCoE using bnx2fc<a class="headerlink" href="#operating-fcoe-using-bnx2fc" title="Permalink to this headline">¶</a></h1>
<p>Broadcom FCoE offload through bnx2fc is full stateful hardware offload that
cooperates with all interfaces provided by the Linux ecosystem for FC/FCoE and
SCSI controllers.  As such, FCoE functionality, once enabled is largely
transparent. Devices discovered on the SAN will be registered and unregistered
automatically with the upper storage layers.</p>
<p>Despite the fact that the Broadcom’s FCoE offload is fully offloaded, it does
depend on the state of the network interfaces to operate. As such, the network
interface (e.g. eth0) associated with the FCoE offload initiator must be ‘up’.
It is recommended that the network interfaces be configured to be brought up
automatically at boot time.</p>
<p>Furthermore, the Broadcom FCoE offload solution creates VLAN interfaces to
support the VLANs that have been discovered for FCoE operation (e.g.
eth0.1001-fcoe).  Do not delete or disable these interfaces or FCoE operation
will be disrupted.</p>
<section id="driver-usage-model">
<h2>Driver Usage Model:<a class="headerlink" href="#driver-usage-model" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Ensure that fcoe-utils package is installed.</p></li>
</ol>
<p>2. Configure the interfaces on which bnx2fc driver has to operate on.
Here are the steps to configure:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>cd /etc/fcoe</p></li>
<li><p>copy cfg-ethx to cfg-eth5 if FCoE has to be enabled on eth5.</p></li>
<li><p>Repeat this for all the interfaces where FCoE has to be enabled.</p></li>
<li><p>Edit all the cfg-eth files to set “no” for DCB_REQUIRED** field, and
“yes” for AUTO_VLAN.</p></li>
<li><p>Other configuration parameters should be left as default</p></li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Ensure that “bnx2fc” is in SUPPORTED_DRIVERS list in /etc/fcoe/config.</p></li>
</ol>
<p>4. Start fcoe service. (service fcoe start). If Broadcom devices are present in
the system, bnx2fc driver would automatically claim the interfaces, starts vlan
discovery and log into the targets.</p>
<p>5. “Symbolic Name” in ‘fcoeadm -i’ output would display if bnx2fc has claimed
the interface.</p>
<p>Eg:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[root@bh2 ~]# fcoeadm -i
   Description:      NetXtreme II BCM57712 10 Gigabit Ethernet
   Revision:         01
   Manufacturer:     Broadcom Corporation
   Serial Number:    0010186FD558
   Driver:           bnx2x 1.70.00-0
   Number of Ports:  2

       Symbolic Name:     bnx2fc v1.0.5 over eth5.4
       OS Device Name:    host11
       Node Name:         0x10000010186FD559
       Port Name:         0x20000010186FD559
       FabricName:        0x2001000DECB3B681
       Speed:             10 Gbit
       Supported Speed:   10 Gbit
       MaxFrameSize:      2048
       FC-ID (Port ID):   0x0F0377
       State:             Online
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li><p>Verify the vlan discovery is performed by running ifconfig and notice
&lt;INTERFACE&gt;.&lt;VLAN&gt;-fcoe interfaces are automatically created.</p></li>
</ol>
<p>Refer to fcoeadm manpage for more information on fcoeadm operations to
create/destroy interfaces or to display lun/target information.</p>
</section>
<section id="note">
<h2>NOTE<a class="headerlink" href="#note" title="Permalink to this headline">¶</a></h2>
<p>** Broadcom FCoE capable devices implement a DCBX/LLDP client on-chip. Only one
LLDP client is allowed per interface. For proper operation all host software
based DCBX/LLDP clients (e.g. lldpad) must be disabled. To disable lldpad on a
given interface, run the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>lldptool set-lldp -i &lt;interface_name&gt; adminStatus=disabled
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Operating FCoE using bnx2fc</a><ul>
<li><a class="reference internal" href="#driver-usage-model">Driver Usage Model:</a></li>
<li><a class="reference internal" href="#note">NOTE</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/scsi/bnx2fc.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/scsi/bnx2fc.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>