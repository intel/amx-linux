
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Kernel driver for Qualcomm LPG &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="kernel-driver-for-qualcomm-lpg">
<h1>Kernel driver for Qualcomm LPG<a class="headerlink" href="#kernel-driver-for-qualcomm-lpg" title="Permalink to this headline">¶</a></h1>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>The Qualcomm LPG can be found in a variety of Qualcomm PMICs and consists of a
number of PWM channels, a programmable pattern lookup table and a RGB LED
current sink.</p>
<p>To facilitate the various use cases, the LPG channels can be exposed as
individual LEDs, grouped together as RGB LEDs or otherwise be accessed as PWM
channels. The output of each PWM channel is routed to other hardware
blocks, such as the RGB current sink, GPIO pins etc.</p>
<p>The each PWM channel can operate with a period between 27us and 384 seconds and
has a 9 bit resolution of the duty cycle.</p>
<p>In order to provide support for status notifications with the CPU subsystem in
deeper idle states the LPG provides pattern support. This consists of a shared
lookup table of brightness values and per channel properties to select the
range within the table to use, the rate and if the pattern should repeat.</p>
<p>The pattern for a channel can be programmed using the “pattern” trigger, using
the hw_pattern attribute.</p>
</section>
<section id="sys-class-leds-led-hw-pattern">
<h2>/sys/class/leds/&lt;led&gt;/hw_pattern<a class="headerlink" href="#sys-class-leds-led-hw-pattern" title="Permalink to this headline">¶</a></h2>
<p>Specify a hardware pattern for a Qualcomm LPG LED.</p>
<p>The pattern is a series of brightness and hold-time pairs, with the hold-time
expressed in milliseconds. The hold time is a property of the pattern and must
therefor be identical for each element in the pattern (except for the pauses
described below). As the LPG hardware is not able to perform the linear
transitions expected by the leds-trigger-pattern format, each entry in the
pattern must be followed a zero-length entry of the same brightness.</p>
<p>Simple pattern:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&quot;255 500 255 0 0 500 0 0&quot;

    ^
    |
255 +----+    +----+
    |    |    |    |      ...
  0 |    +----+    +----
    +----------------------&gt;
    0    5   10   15     time (100ms)
</pre></div>
</div>
<p>The LPG supports specifying a longer hold-time for the first and last element
in the pattern, the so called “low pause” and “high pause”.</p>
<p>Low-pause pattern:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&quot;255 1000 255 0 0 500 0 0 255 500 255 0 0 500 0 0&quot;

    ^
    |
255 +--------+    +----+    +----+    +--------+
    |        |    |    |    |    |    |        |      ...
  0 |        +----+    +----+    +----+        +----
    +-----------------------------&gt;
    0    5   10   15  20   25   time (100ms)
</pre></div>
</div>
<p>Similarily, the last entry can be stretched by using a higher hold-time on the
last entry.</p>
<p>In order to save space in the shared lookup table the LPG supports “ping-pong”
mode, in which case each run through the pattern is performed by first running
the pattern forward, then backwards. This mode is automatically used by the
driver when the given pattern is a palindrome. In this case the “high pause”
denotes the wait time before the pattern is run in reverse and as such the
specified hold-time of the middle item in the pattern is allowed to have a
different hold-time.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Kernel driver for Qualcomm LPG</a><ul>
<li><a class="reference internal" href="#description">Description</a></li>
<li><a class="reference internal" href="#sys-class-leds-led-hw-pattern">/sys/class/leds/&lt;led&gt;/hw_pattern</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/leds/leds-qcom-lpg.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/leds/leds-qcom-lpg.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>