
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>4.7. Sliced VBI Data Interface &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="4.8. Radio Interface" href="dev-radio.html" />
    <link rel="prev" title="4.6. Raw VBI Data Interface" href="dev-raw-vbi.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="sliced-vbi-data-interface">
<span id="sliced"></span><h1><span class="section-number">4.7. </span>Sliced VBI Data Interface<a class="headerlink" href="#sliced-vbi-data-interface" title="Permalink to this headline">¶</a></h1>
<p>VBI stands for Vertical Blanking Interval, a gap in the sequence of
lines of an analog video signal. During VBI no picture information is
transmitted, allowing some time while the electron beam of a cathode ray
tube TV returns to the top of the screen.</p>
<p>Sliced VBI devices use hardware to demodulate data transmitted in the
VBI. V4L2 drivers shall <em>not</em> do this by software, see also the
<a class="reference internal" href="dev-raw-vbi.html#raw-vbi"><span class="std std-ref">raw VBI interface</span></a>. The data is passed as short
packets of fixed size, covering one scan line each. The number of
packets per video frame is variable.</p>
<p>Sliced VBI capture and output devices are accessed through the same
character special files as raw VBI devices. When a driver supports both
interfaces, the default function of a <code class="docutils literal notranslate"><span class="pre">/dev/vbi</span></code> device is <em>raw</em> VBI
capturing or output, and the sliced VBI function is only available after
calling the <a class="reference internal" href="vidioc-g-fmt.html#vidioc-g-fmt"><span class="std std-ref">VIDIOC_S_FMT</span></a> ioctl as defined
below. Likewise a <code class="docutils literal notranslate"><span class="pre">/dev/video</span></code> device may support the sliced VBI API,
however the default function here is video capturing or output.
Different file descriptors must be used to pass raw and sliced VBI data
simultaneously, if this is supported by the driver.</p>
<section id="querying-capabilities">
<h2><span class="section-number">4.7.1. </span>Querying Capabilities<a class="headerlink" href="#querying-capabilities" title="Permalink to this headline">¶</a></h2>
<p>Devices supporting the sliced VBI capturing or output API set the
<code class="docutils literal notranslate"><span class="pre">V4L2_CAP_SLICED_VBI_CAPTURE</span></code> or <code class="docutils literal notranslate"><span class="pre">V4L2_CAP_SLICED_VBI_OUTPUT</span></code> flag
respectively, in the <code class="docutils literal notranslate"><span class="pre">capabilities</span></code> field of struct
<code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_capability</span></code> returned by the
<a class="reference internal" href="vidioc-querycap.html#vidioc-querycap"><span class="std std-ref">ioctl VIDIOC_QUERYCAP</span></a> ioctl. At least one of the
read/write or streaming <a class="reference internal" href="io.html#io"><span class="std std-ref">I/O methods</span></a> must be
supported. Sliced VBI devices may have a tuner or modulator.</p>
</section>
<section id="supplemental-functions">
<h2><span class="section-number">4.7.2. </span>Supplemental Functions<a class="headerlink" href="#supplemental-functions" title="Permalink to this headline">¶</a></h2>
<p>Sliced VBI devices shall support <a class="reference internal" href="video.html#video"><span class="std std-ref">video input or output</span></a>
and <a class="reference internal" href="tuner.html#tuner"><span class="std std-ref">tuner or modulator</span></a> ioctls if they have these
capabilities, and they may support <a class="reference internal" href="control.html#control"><span class="std std-ref">User Controls</span></a> ioctls.
The <a class="reference internal" href="standard.html#standard"><span class="std std-ref">video standard</span></a> ioctls provide information vital
to program a sliced VBI device, therefore must be supported.</p>
</section>
<section id="sliced-vbi-format-negotiation">
<span id="sliced-vbi-format-negotitation"></span><h2><span class="section-number">4.7.3. </span>Sliced VBI Format Negotiation<a class="headerlink" href="#sliced-vbi-format-negotiation" title="Permalink to this headline">¶</a></h2>
<p>To find out which data services are supported by the hardware
applications can call the
<a class="reference internal" href="vidioc-g-sliced-vbi-cap.html#vidioc-g-sliced-vbi-cap"><span class="std std-ref">VIDIOC_G_SLICED_VBI_CAP</span></a> ioctl.
All drivers implementing the sliced VBI interface must support this
ioctl. The results may differ from those of the
<a class="reference internal" href="vidioc-g-fmt.html#vidioc-g-fmt"><span class="std std-ref">VIDIOC_S_FMT</span></a> ioctl when the number of VBI
lines the hardware can capture or output per frame, or the number of
services it can identify on a given line are limited. For example on PAL
line 16 the hardware may be able to look for a VPS or Teletext signal,
but not both at the same time.</p>
<p>To determine the currently selected services applications set the
<code class="docutils literal notranslate"><span class="pre">type</span></code> field of struct <code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_format</span></code> to
<code class="docutils literal notranslate"><span class="pre">V4L2_BUF_TYPE_SLICED_VBI_CAPTURE</span></code> or
<code class="docutils literal notranslate"><span class="pre">V4L2_BUF_TYPE_SLICED_VBI_OUTPUT</span></code>, and the
<a class="reference internal" href="vidioc-g-fmt.html#vidioc-g-fmt"><span class="std std-ref">VIDIOC_G_FMT</span></a> ioctl fills the <code class="docutils literal notranslate"><span class="pre">fmt.sliced</span></code>
member, a struct
<code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_sliced_vbi_format</span></code>.</p>
<p>Applications can request different parameters by initializing or
modifying the <code class="docutils literal notranslate"><span class="pre">fmt.sliced</span></code> member and calling the
<a class="reference internal" href="vidioc-g-fmt.html#vidioc-g-fmt"><span class="std std-ref">VIDIOC_S_FMT</span></a> ioctl with a pointer to the
struct <code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_format</span></code> structure.</p>
<p>The sliced VBI API is more complicated than the raw VBI API because the
hardware must be told which VBI service to expect on each scan line. Not
all services may be supported by the hardware on all lines (this is
especially true for VBI output where Teletext is often unsupported and
other services can only be inserted in one specific line). In many
cases, however, it is sufficient to just set the <code class="docutils literal notranslate"><span class="pre">service_set</span></code> field
to the required services and let the driver fill the <code class="docutils literal notranslate"><span class="pre">service_lines</span></code>
array according to hardware capabilities. Only if more precise control
is needed should the programmer set the <code class="docutils literal notranslate"><span class="pre">service_lines</span></code> array
explicitly.</p>
<p>The <a class="reference internal" href="vidioc-g-fmt.html#vidioc-g-fmt"><span class="std std-ref">VIDIOC_S_FMT</span></a> ioctl modifies the parameters
according to hardware capabilities. When the driver allocates resources
at this point, it may return an <code class="docutils literal notranslate"><span class="pre">EBUSY</span></code> error code if the required
resources are temporarily unavailable. Other resource allocation points
which may return <code class="docutils literal notranslate"><span class="pre">EBUSY</span></code> can be the
<a class="reference internal" href="vidioc-streamon.html#vidioc-streamon"><span class="std std-ref">ioctl VIDIOC_STREAMON, VIDIOC_STREAMOFF</span></a> ioctl and the first
<code class="xref c c-func docutils literal notranslate"><span class="pre">read()</span></code>, <code class="xref c c-func docutils literal notranslate"><span class="pre">write()</span></code> and
<code class="xref c c-func docutils literal notranslate"><span class="pre">select()</span></code> call.</p>
<dl class="type">
<dt id="c.V4L.v4l2_sliced_vbi_format">
<code class="sig-name descname">v4l2_sliced_vbi_format</code><a class="headerlink" href="#c.V4L.v4l2_sliced_vbi_format" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<section id="struct-v4l2-sliced-vbi-format">
<h3><span class="section-number">4.7.3.1. </span>struct v4l2_sliced_vbi_format<a class="headerlink" href="#struct-v4l2-sliced-vbi-format" title="Permalink to this headline">¶</a></h3>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>__u16</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">service_set</span></code></p></td>
<td colspan="3"><p></p>
<p>If <code class="docutils literal notranslate"><span class="pre">service_set</span></code> is non-zero when passed with
<a class="reference internal" href="vidioc-g-fmt.html#vidioc-g-fmt"><span class="std std-ref">VIDIOC_S_FMT</span></a> or
<a class="reference internal" href="vidioc-g-fmt.html#vidioc-g-fmt"><span class="std std-ref">VIDIOC_TRY_FMT</span></a>, the <code class="docutils literal notranslate"><span class="pre">service_lines</span></code>
array will be filled by the driver according to the services
specified in this field. For example, if <code class="docutils literal notranslate"><span class="pre">service_set</span></code> is
initialized with <code class="docutils literal notranslate"><span class="pre">V4L2_SLICED_TELETEXT_B</span> <span class="pre">|</span> <span class="pre">V4L2_SLICED_WSS_625</span></code>,
a driver for the cx25840 video decoder sets lines 7-22 of both
fields <a class="footnote-reference brackets" href="#f1" id="id1">1</a> to <code class="docutils literal notranslate"><span class="pre">V4L2_SLICED_TELETEXT_B</span></code> and line 23 of the first
field to <code class="docutils literal notranslate"><span class="pre">V4L2_SLICED_WSS_625</span></code>. If <code class="docutils literal notranslate"><span class="pre">service_set</span></code> is set to
zero, then the values of <code class="docutils literal notranslate"><span class="pre">service_lines</span></code> will be used instead.</p>
<p>On return the driver sets this field to the union of all elements
of the returned <code class="docutils literal notranslate"><span class="pre">service_lines</span></code> array. It may contain less
services than requested, perhaps just one, if the hardware cannot
handle more services simultaneously. It may be empty (zero) if
none of the requested services are supported by the hardware.</p>
</td>
</tr>
<tr class="row-even"><td><p>__u16</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">service_lines</span></code>[2][24]</p></td>
<td colspan="3"><p></p>
<p>Applications initialize this array with sets of data services the
driver shall look for or insert on the respective scan line.
Subject to hardware capabilities drivers return the requested set,
a subset, which may be just a single service, or an empty set.
When the hardware cannot handle multiple services on the same line
the driver shall choose one. No assumptions can be made on which
service the driver chooses.</p>
<p>Data services are defined in <a class="reference internal" href="#vbi-services2"><span class="std std-ref">Sliced VBI services</span></a>. Array indices
map to ITU-R line numbers<a class="footnote-reference brackets" href="#f2" id="id2">2</a> as follows:</p>
</td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>Element</p></td>
<td><p>525 line systems</p></td>
<td><p>625 line systems</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">service_lines</span></code>[0][1]</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">service_lines</span></code>[0][23]</p></td>
<td><p>23</p></td>
<td><p>23</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">service_lines</span></code>[1][1]</p></td>
<td><p>264</p></td>
<td><p>314</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">service_lines</span></code>[1][23]</p></td>
<td><p>286</p></td>
<td><p>336</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td colspan="3"><p> Drivers must set <code class="docutils literal notranslate"><span class="pre">service_lines</span></code> [0][0] and
<code class="docutils literal notranslate"><span class="pre">service_lines</span></code>[1][0] to zero. The
<code class="docutils literal notranslate"><span class="pre">V4L2_VBI_ITU_525_F1_START</span></code>, <code class="docutils literal notranslate"><span class="pre">V4L2_VBI_ITU_525_F2_START</span></code>,
<code class="docutils literal notranslate"><span class="pre">V4L2_VBI_ITU_625_F1_START</span></code> and <code class="docutils literal notranslate"><span class="pre">V4L2_VBI_ITU_625_F2_START</span></code>
defines give the start line numbers for each field for each 525 or
625 line format as a convenience. Don’t forget that ITU line
numbering starts at 1, not 0.</p></td>
</tr>
<tr class="row-odd"><td><p>__u32</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">io_size</span></code></p></td>
<td colspan="3"><p> Maximum number of bytes passed by one
<code class="xref c c-func docutils literal notranslate"><span class="pre">read()</span></code> or <code class="xref c c-func docutils literal notranslate"><span class="pre">write()</span></code> call,
and the buffer size in bytes for the
<a class="reference internal" href="vidioc-qbuf.html#vidioc-qbuf"><span class="std std-ref">ioctl VIDIOC_QBUF, VIDIOC_DQBUF</span></a> and
<a class="reference internal" href="vidioc-qbuf.html#vidioc-qbuf"><span class="std std-ref">VIDIOC_DQBUF</span></a> ioctl. Drivers set this field
to the size of struct
<code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_sliced_vbi_data</span></code> times the
number of non-zero elements in the returned <code class="docutils literal notranslate"><span class="pre">service_lines</span></code>
array (that is the number of lines potentially carrying data).</p></td>
</tr>
<tr class="row-even"><td><p>__u32</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">reserved</span></code>[2]</p></td>
<td colspan="3"><p> This array is reserved for future extensions.</p>
<p>Applications and drivers must set it to zero.</p>
</td>
</tr>
</tbody>
</table>
</section>
<section id="sliced-vbi-services">
<span id="vbi-services2"></span><h3><span class="section-number">4.7.3.2. </span>Sliced VBI services<a class="headerlink" href="#sliced-vbi-services" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Symbol</p></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Reference</p></th>
<th class="head"><p>Lines, usually</p></th>
<th class="head"><p>Payload</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_SLICED_TELETEXT_B</span></code> (Teletext System B)</p></td>
<td><p>0x0001</p></td>
<td><p><a class="reference internal" href="biblio.html#ets300706"><span class="std std-ref">ETS 300 706</span></a>,</p>
<p><a class="reference internal" href="biblio.html#itu653"><span class="std std-ref">ITU BT.653</span></a></p>
</td>
<td><p>PAL/SECAM line 7-22, 320-335 (second field 7-22)</p></td>
<td><p>Last 42 of the 45 byte Teletext packet, that is without clock
run-in and framing code, lsb first transmitted.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_SLICED_VPS</span></code></p></td>
<td><p>0x0400</p></td>
<td><p><a class="reference internal" href="biblio.html#ets300231"><span class="std std-ref">ETS 300 231</span></a></p></td>
<td><p>PAL line 16</p></td>
<td><p>Byte number 3 to 15 according to Figure 9 of ETS 300 231, lsb
first transmitted.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_SLICED_CAPTION_525</span></code></p></td>
<td><p>0x1000</p></td>
<td><p><a class="reference internal" href="biblio.html#cea608"><span class="std std-ref">CEA 608-E</span></a></p></td>
<td><p>NTSC line 21, 284 (second field 21)</p></td>
<td><p>Two bytes in transmission order, including parity bit, lsb first
transmitted.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_SLICED_WSS_625</span></code></p></td>
<td><p>0x4000</p></td>
<td><p><a class="reference internal" href="biblio.html#itu1119"><span class="std std-ref">ITU BT.1119</span></a>,</p>
<p><a class="reference internal" href="biblio.html#en300294"><span class="std std-ref">EN 300 294</span></a></p>
</td>
<td><p>PAL/SECAM line 23</p></td>
<td><p>See <a class="reference internal" href="#v4l2-sliced-wss-625-payload"><span class="std std-ref">V4L2_SLICED_WSS_625 payload</span></a> below.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_SLICED_VBI_525</span></code></p></td>
<td><p>0x1000</p></td>
<td colspan="3"><p> Set of services applicable to 525 line systems.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_SLICED_VBI_625</span></code></p></td>
<td><p>0x4401</p></td>
<td colspan="3"><p> Set of services applicable to 625 line systems.</p></td>
</tr>
</tbody>
</table>
<p>Drivers may return an <code class="docutils literal notranslate"><span class="pre">EINVAL</span></code> error code when applications attempt to
read or write data without prior format negotiation, after switching the
video standard (which may invalidate the negotiated VBI parameters) and
after switching the video input (which may change the video standard as
a side effect). The <a class="reference internal" href="vidioc-g-fmt.html#vidioc-g-fmt"><span class="std std-ref">VIDIOC_S_FMT</span></a> ioctl may
return an <code class="docutils literal notranslate"><span class="pre">EBUSY</span></code> error code when applications attempt to change the
format while i/o is in progress (between a
<a class="reference internal" href="vidioc-streamon.html#vidioc-streamon"><span class="std std-ref">ioctl VIDIOC_STREAMON, VIDIOC_STREAMOFF</span></a> and
<a class="reference internal" href="vidioc-streamon.html#vidioc-streamon"><span class="std std-ref">VIDIOC_STREAMOFF</span></a> call, and after the first
<code class="xref c c-func docutils literal notranslate"><span class="pre">read()</span></code> or <code class="xref c c-func docutils literal notranslate"><span class="pre">write()</span></code> call).</p>
<section id="v4l2-sliced-wss-625-payload">
<span id="id3"></span><h4><span class="section-number">4.7.3.2.1. </span>V4L2_SLICED_WSS_625 payload<a class="headerlink" href="#v4l2-sliced-wss-625-payload" title="Permalink to this headline">¶</a></h4>
<p>The payload for <code class="docutils literal notranslate"><span class="pre">V4L2_SLICED_WSS_625</span></code> is:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 3%" />
<col style="width: 3%" />
<col style="width: 3%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 3%" />
<col style="width: 3%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 3%" />
<col style="width: 6%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 6%" />
<col style="width: 3%" />
<col style="width: 6%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Byte</p></td>
<td colspan="8"><p>0</p></td>
<td colspan="8"><p>1</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>Bit</p></td>
<td colspan="4"><p>msb</p></td>
<td colspan="4"><p>lsb</p></td>
<td colspan="4"><p>msb</p></td>
<td colspan="4"><p>lsb</p></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>6</p></td>
<td><p>5</p></td>
<td><p>4</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
<td><p>13</p></td>
<td><p>12</p></td>
<td><p>11</p></td>
<td><p>10</p></td>
<td><p>9</p></td>
<td><p>8</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</section>
</section>
</section>
<section id="reading-and-writing-sliced-vbi-data">
<h2><span class="section-number">4.7.4. </span>Reading and writing sliced VBI data<a class="headerlink" href="#reading-and-writing-sliced-vbi-data" title="Permalink to this headline">¶</a></h2>
<p>A single <code class="xref c c-func docutils literal notranslate"><span class="pre">read()</span></code> or <code class="xref c c-func docutils literal notranslate"><span class="pre">write()</span></code>
call must pass all data belonging to one video frame. That is an array
of struct <code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_sliced_vbi_data</span></code> structures with one or
more elements and a total size not exceeding <code class="docutils literal notranslate"><span class="pre">io_size</span></code> bytes. Likewise
in streaming I/O mode one buffer of <code class="docutils literal notranslate"><span class="pre">io_size</span></code> bytes must contain data
of one video frame. The <code class="docutils literal notranslate"><span class="pre">id</span></code> of unused
struct <code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_sliced_vbi_data</span></code> elements must be zero.</p>
<dl class="type">
<dt id="c.V4L.v4l2_sliced_vbi_data">
<code class="sig-name descname">v4l2_sliced_vbi_data</code><a class="headerlink" href="#c.V4L.v4l2_sliced_vbi_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<section id="struct-v4l2-sliced-vbi-data">
<h3><span class="section-number">4.7.4.1. </span>struct v4l2_sliced_vbi_data<a class="headerlink" href="#struct-v4l2-sliced-vbi-data" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 38%" />
<col style="width: 13%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>__u32</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">id</span></code></p></td>
<td><p>A flag from <a class="reference internal" href="vidioc-g-sliced-vbi-cap.html#vbi-services"><span class="std std-ref">Sliced VBI services</span></a> identifying the type of data in
this packet. Only a single bit must be set. When the <code class="docutils literal notranslate"><span class="pre">id</span></code> of a
captured packet is zero, the packet is empty and the contents of
other fields are undefined. Applications shall ignore empty
packets. When the <code class="docutils literal notranslate"><span class="pre">id</span></code> of a packet for output is zero the
contents of the <code class="docutils literal notranslate"><span class="pre">data</span></code> field are undefined and the driver must
no longer insert data on the requested <code class="docutils literal notranslate"><span class="pre">field</span></code> and <code class="docutils literal notranslate"><span class="pre">line</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p>__u32</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">field</span></code></p></td>
<td><p>The video field number this data has been captured from, or shall
be inserted at. <code class="docutils literal notranslate"><span class="pre">0</span></code> for the first field, <code class="docutils literal notranslate"><span class="pre">1</span></code> for the second
field.</p></td>
</tr>
<tr class="row-odd"><td><p>__u32</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">line</span></code></p></td>
<td><p>The field (as opposed to frame) line number this data has been
captured from, or shall be inserted at. See <a class="reference internal" href="dev-raw-vbi.html#vbi-525"><span class="std std-ref">Figure 4.2. ITU-R 525 line numbering (M/NTSC and M/PAL)</span></a> and
<a class="reference internal" href="dev-raw-vbi.html#vbi-625"><span class="std std-ref">Figure 4.3. ITU-R 625 line numbering</span></a> for valid values. Sliced VBI capture devices can
set the line number of all packets to <code class="docutils literal notranslate"><span class="pre">0</span></code> if the hardware cannot
reliably identify scan lines. The field number must always be
valid.</p></td>
</tr>
<tr class="row-even"><td><p>__u32</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">reserved</span></code></p></td>
<td><p>This field is reserved for future extensions. Applications and
drivers must set it to zero.</p></td>
</tr>
<tr class="row-odd"><td><p>__u8</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">data</span></code>[48]</p></td>
<td><p>The packet payload. See <a class="reference internal" href="vidioc-g-sliced-vbi-cap.html#vbi-services"><span class="std std-ref">Sliced VBI services</span></a> for the contents and
number of bytes passed for each data type. The contents of padding
bytes at the end of this array are undefined, drivers and
applications shall ignore them.</p></td>
</tr>
</tbody>
</table>
<p>Packets are always passed in ascending line number order, without
duplicate line numbers. The <code class="xref c c-func docutils literal notranslate"><span class="pre">write()</span></code> function and
the <a class="reference internal" href="vidioc-qbuf.html#vidioc-qbuf"><span class="std std-ref">ioctl VIDIOC_QBUF, VIDIOC_DQBUF</span></a> ioctl must return an <code class="docutils literal notranslate"><span class="pre">EINVAL</span></code>
error code when applications violate this rule. They must also return an
EINVAL error code when applications pass an incorrect field or line
number, or a combination of <code class="docutils literal notranslate"><span class="pre">field</span></code>, <code class="docutils literal notranslate"><span class="pre">line</span></code> and <code class="docutils literal notranslate"><span class="pre">id</span></code> which has not
been negotiated with the <a class="reference internal" href="vidioc-g-fmt.html#vidioc-g-fmt"><span class="std std-ref">VIDIOC_G_FMT</span></a> or
<a class="reference internal" href="vidioc-g-fmt.html#vidioc-g-fmt"><span class="std std-ref">VIDIOC_S_FMT</span></a> ioctl. When the line numbers are
unknown the driver must pass the packets in transmitted order. The
driver can insert empty packets with <code class="docutils literal notranslate"><span class="pre">id</span></code> set to zero anywhere in the
packet array.</p>
<p>To assure synchronization and to distinguish from frame dropping, when a
captured frame does not carry any of the requested data services drivers
must pass one or more empty packets. When an application fails to pass
VBI data in time for output, the driver must output the last VPS and WSS
packet again, and disable the output of Closed Caption and Teletext
data, or output data which is ignored by Closed Caption and Teletext
decoders.</p>
<p>A sliced VBI device may support <a class="reference internal" href="rw.html#rw"><span class="std std-ref">read/write</span></a> and/or
streaming (<a class="reference internal" href="mmap.html#mmap"><span class="std std-ref">memory mapping</span></a> and/or
<a class="reference internal" href="userp.html#userp"><span class="std std-ref">user pointer</span></a>) I/O. The latter bears the possibility of
synchronizing video and VBI data by using buffer timestamps.</p>
</section>
</section>
<section id="sliced-vbi-data-in-mpeg-streams">
<h2><span class="section-number">4.7.5. </span>Sliced VBI Data in MPEG Streams<a class="headerlink" href="#sliced-vbi-data-in-mpeg-streams" title="Permalink to this headline">¶</a></h2>
<p>If a device can produce an MPEG output stream, it may be capable of
providing
<a class="reference internal" href="#sliced-vbi-format-negotitation"><span class="std std-ref">negotiated sliced VBI services</span></a>
as data embedded in the MPEG stream. Users or applications control this
sliced VBI data insertion with the
<a class="reference internal" href="ext-ctrls-codec.html#v4l2-mpeg-stream-vbi-fmt"><span class="std std-ref">V4L2_CID_MPEG_STREAM_VBI_FMT</span></a>
control.</p>
<p>If the driver does not provide the
<a class="reference internal" href="ext-ctrls-codec.html#v4l2-mpeg-stream-vbi-fmt"><span class="std std-ref">V4L2_CID_MPEG_STREAM_VBI_FMT</span></a>
control, or only allows that control to be set to
<a class="reference internal" href="ext-ctrls-codec.html#v4l2-mpeg-stream-vbi-fmt"><span class="std std-ref">V4L2_MPEG_STREAM_VBI_FMT_NONE</span></a>,
then the device cannot embed sliced VBI data in the MPEG stream.</p>
<p>The
<a class="reference internal" href="ext-ctrls-codec.html#v4l2-mpeg-stream-vbi-fmt"><span class="std std-ref">V4L2_CID_MPEG_STREAM_VBI_FMT</span></a>
control does not implicitly set the device driver to capture nor cease
capturing sliced VBI data. The control only indicates to embed sliced
VBI data in the MPEG stream, if an application has negotiated sliced VBI
service be captured.</p>
<p>It may also be the case that a device can embed sliced VBI data in only
certain types of MPEG streams: for example in an MPEG-2 PS but not an
MPEG-2 TS. In this situation, if sliced VBI data insertion is requested,
the sliced VBI data will be embedded in MPEG stream types when
supported, and silently omitted from MPEG stream types where sliced VBI
data insertion is not supported by the device.</p>
<p>The following subsections specify the format of the embedded sliced VBI
data.</p>
<section id="mpeg-stream-embedded-sliced-vbi-data-format-none">
<h3><span class="section-number">4.7.5.1. </span>MPEG Stream Embedded, Sliced VBI Data Format: NONE<a class="headerlink" href="#mpeg-stream-embedded-sliced-vbi-data-format-none" title="Permalink to this headline">¶</a></h3>
<p>The
<a class="reference internal" href="ext-ctrls-codec.html#v4l2-mpeg-stream-vbi-fmt"><span class="std std-ref">V4L2_MPEG_STREAM_VBI_FMT_NONE</span></a>
embedded sliced VBI format shall be interpreted by drivers as a control
to cease embedding sliced VBI data in MPEG streams. Neither the device
nor driver shall insert “empty” embedded sliced VBI data packets in the
MPEG stream when this format is set. No MPEG stream data structures are
specified for this format.</p>
</section>
<section id="mpeg-stream-embedded-sliced-vbi-data-format-ivtv">
<h3><span class="section-number">4.7.5.2. </span>MPEG Stream Embedded, Sliced VBI Data Format: IVTV<a class="headerlink" href="#mpeg-stream-embedded-sliced-vbi-data-format-ivtv" title="Permalink to this headline">¶</a></h3>
<p>The
<a class="reference internal" href="ext-ctrls-codec.html#v4l2-mpeg-stream-vbi-fmt"><span class="std std-ref">V4L2_MPEG_STREAM_VBI_FMT_IVTV</span></a>
embedded sliced VBI format, when supported, indicates to the driver to
embed up to 36 lines of sliced VBI data per frame in an MPEG-2 <em>Private
Stream 1 PES</em> packet encapsulated in an MPEG-2 <em>Program Pack</em> in the
MPEG stream.</p>
<p><em>Historical context</em>: This format specification originates from a
custom, embedded, sliced VBI data format used by the <code class="docutils literal notranslate"><span class="pre">ivtv</span></code> driver.
This format has already been informally specified in the kernel sources
in the file <code class="docutils literal notranslate"><span class="pre">Documentation/userspace-api/media/drivers/cx2341x-uapi.rst</span></code> . The
maximum size of the payload and other aspects of this format are driven
by the CX23415 MPEG decoder’s capabilities and limitations with respect
to extracting, decoding, and displaying sliced VBI data embedded within
an MPEG stream.</p>
<p>This format’s use is <em>not</em> exclusive to the <code class="docutils literal notranslate"><span class="pre">ivtv</span></code> driver <em>nor</em>
exclusive to CX2341x devices, as the sliced VBI data packet insertion
into the MPEG stream is implemented in driver software. At least the
<code class="docutils literal notranslate"><span class="pre">cx18</span></code> driver provides sliced VBI data insertion into an MPEG-2 PS in
this format as well.</p>
<p>The following definitions specify the payload of the MPEG-2 <em>Private
Stream 1 PES</em> packets that contain sliced VBI data when
<a class="reference internal" href="ext-ctrls-codec.html#v4l2-mpeg-stream-vbi-fmt"><span class="std std-ref">V4L2_MPEG_STREAM_VBI_FMT_IVTV</span></a>
is set. (The MPEG-2 <em>Private Stream 1 PES</em> packet header and
encapsulating MPEG-2 <em>Program Pack</em> header are not detailed here. Please
refer to the MPEG-2 specifications for details on those packet headers.)</p>
<p>The payload of the MPEG-2 <em>Private Stream 1 PES</em> packets that contain
sliced VBI data is specified by struct
<code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_mpeg_vbi_fmt_ivtv</span></code>. The
payload is variable length, depending on the actual number of lines of
sliced VBI data present in a video frame. The payload may be padded at
the end with unspecified fill bytes to align the end of the payload to a
4-byte boundary. The payload shall never exceed 1552 bytes (2 fields
with 18 lines/field with 43 bytes of data/line and a 4 byte magic
number).</p>
<dl class="type">
<dt id="c.V4L.v4l2_mpeg_vbi_fmt_ivtv">
<code class="sig-name descname">v4l2_mpeg_vbi_fmt_ivtv</code><a class="headerlink" href="#c.V4L.v4l2_mpeg_vbi_fmt_ivtv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="struct-v4l2-mpeg-vbi-fmt-ivtv">
<h3><span class="section-number">4.7.5.3. </span>struct v4l2_mpeg_vbi_fmt_ivtv<a class="headerlink" href="#struct-v4l2-mpeg-vbi-fmt-ivtv" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>__u8</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">magic</span></code>[4]</p></td>
<td><p>A “magic” constant from <a class="reference internal" href="#v4l2-mpeg-vbi-fmt-ivtv-magic"><span class="std std-ref">Magic Constants for struct v4l2_mpeg_vbi_fmt_ivtv magic field</span></a> that
indicates this is a valid sliced VBI data payload and also
indicates which member of the anonymous union, <code class="docutils literal notranslate"><span class="pre">itv0</span></code> or
<code class="docutils literal notranslate"><span class="pre">ITV0</span></code>, to use for the payload data.</p></td>
</tr>
<tr class="row-even"><td><p>union {</p></td>
<td colspan="2"><p>(anonymous)</p></td>
</tr>
<tr class="row-odd"><td><p>struct <code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_mpeg_vbi_itv0</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">itv0</span></code></p></td>
<td><p>The primary form of the sliced VBI data payload that contains
anywhere from 1 to 35 lines of sliced VBI data. Line masks are
provided in this form of the payload indicating which VBI lines
are provided.</p></td>
</tr>
<tr class="row-even"><td><p>struct <a class="reference internal" href="#v4l2-mpeg-vbi-itv0-1"><span class="std std-ref">v4l2_mpeg_vbi_ITV0</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ITV0</span></code></p></td>
<td><p>An alternate form of the sliced VBI data payload used when 36
lines of sliced VBI data are present. No line masks are provided
in this form of the payload; all valid line mask bits are
implcitly set.</p></td>
</tr>
<tr class="row-odd"><td><p>}</p></td>
<td colspan="2"></td>
</tr>
</tbody>
</table>
</section>
<section id="magic-constants-for-struct-v4l2-mpeg-vbi-fmt-ivtv-magic-field">
<span id="v4l2-mpeg-vbi-fmt-ivtv-magic"></span><h3><span class="section-number">4.7.5.4. </span>Magic Constants for struct v4l2_mpeg_vbi_fmt_ivtv magic field<a class="headerlink" href="#magic-constants-for-struct-v4l2-mpeg-vbi-fmt-ivtv-magic-field" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 38%" />
<col style="width: 13%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Defined Symbol</p></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_MPEG_VBI_IVTV_MAGIC0</span></code></p></td>
<td><p>“itv0”</p></td>
<td><p>Indicates the <code class="docutils literal notranslate"><span class="pre">itv0</span></code> member of the union in struct
<code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_mpeg_vbi_fmt_ivtv</span></code> is
valid.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_MPEG_VBI_IVTV_MAGIC1</span></code></p></td>
<td><p>“ITV0”</p></td>
<td><p>Indicates the <code class="docutils literal notranslate"><span class="pre">ITV0</span></code> member of the union in struct
<code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_mpeg_vbi_fmt_ivtv</span></code> is
valid and that 36 lines of sliced VBI data are present.</p></td>
</tr>
</tbody>
</table>
<dl class="type">
<dt id="c.V4L.v4l2_mpeg_vbi_itv0">
<code class="sig-name descname">v4l2_mpeg_vbi_itv0</code><a class="headerlink" href="#c.V4L.v4l2_mpeg_vbi_itv0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="type">
<dt id="c.V4L.v4l2_mpeg_vbi_ITV0">
<code class="sig-name descname">v4l2_mpeg_vbi_ITV0</code><a class="headerlink" href="#c.V4L.v4l2_mpeg_vbi_ITV0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="structs-v4l2-mpeg-vbi-itv0-and-v4l2-mpeg-vbi-itv0">
<h3><span class="section-number">4.7.5.5. </span>structs v4l2_mpeg_vbi_itv0 and v4l2_mpeg_vbi_ITV0<a class="headerlink" href="#structs-v4l2-mpeg-vbi-itv0-and-v4l2-mpeg-vbi-itv0" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>__le32</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">linemask</span></code>[2]</p></td>
<td><p>Bitmasks indicating the VBI service lines present. These
<code class="docutils literal notranslate"><span class="pre">linemask</span></code> values are stored in little endian byte order in the
MPEG stream. Some reference <code class="docutils literal notranslate"><span class="pre">linemask</span></code> bit positions with their
corresponding VBI line number and video field are given below.
b<sub>0</sub> indicates the least significant bit of a <code class="docutils literal notranslate"><span class="pre">linemask</span></code>
value:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>linemask[0] b0:     line  6  first field
linemask[0] b17:    line 23  first field
linemask[0] b18:    line  6  second field
linemask[0] b31:    line 19  second field
linemask[1] b0:     line 20  second field
linemask[1] b3:     line 23  second field
linemask[1] b4-b31: unused and set to 0
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>struct
<code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_mpeg_vbi_itv0_line</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">line</span></code>[35]</p></td>
<td><p>This is a variable length array that holds from 1 to 35 lines of
sliced VBI data. The sliced VBI data lines present correspond to
the bits set in the <code class="docutils literal notranslate"><span class="pre">linemask</span></code> array, starting from b<sub>0</sub>
of <code class="docutils literal notranslate"><span class="pre">linemask</span></code>[0] up through b<sub>31</sub> of <code class="docutils literal notranslate"><span class="pre">linemask</span></code>[0],
and from b<sub>0</sub> of <code class="docutils literal notranslate"><span class="pre">linemask</span></code>[1] up through b<sub>3</sub> of
<code class="docutils literal notranslate"><span class="pre">linemask</span></code>[1]. <code class="docutils literal notranslate"><span class="pre">line</span></code>[0] corresponds to the first bit
found set in the <code class="docutils literal notranslate"><span class="pre">linemask</span></code> array, <code class="docutils literal notranslate"><span class="pre">line</span></code>[1] corresponds to
the second bit found set in the <code class="docutils literal notranslate"><span class="pre">linemask</span></code> array, etc. If no
<code class="docutils literal notranslate"><span class="pre">linemask</span></code> array bits are set, then <code class="docutils literal notranslate"><span class="pre">line</span></code>[0] may contain
one line of unspecified data that should be ignored by
applications.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="struct-v4l2-mpeg-vbi-itv0">
<span id="v4l2-mpeg-vbi-itv0-1"></span><h3><span class="section-number">4.7.5.6. </span>struct v4l2_mpeg_vbi_ITV0<a class="headerlink" href="#struct-v4l2-mpeg-vbi-itv0" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>struct
<code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_mpeg_vbi_itv0_line</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">line</span></code>[36]</p></td>
<td><p>A fixed length array of 36 lines of sliced VBI data. <code class="docutils literal notranslate"><span class="pre">line</span></code>[0]
through <code class="docutils literal notranslate"><span class="pre">line</span></code>[17] correspond to lines 6 through 23 of the
first field. <code class="docutils literal notranslate"><span class="pre">line</span></code>[18] through <code class="docutils literal notranslate"><span class="pre">line</span></code>[35] corresponds to
lines 6 through 23 of the second field.</p></td>
</tr>
</tbody>
</table>
<dl class="type">
<dt id="c.V4L.v4l2_mpeg_vbi_itv0_line">
<code class="sig-name descname">v4l2_mpeg_vbi_itv0_line</code><a class="headerlink" href="#c.V4L.v4l2_mpeg_vbi_itv0_line" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="struct-v4l2-mpeg-vbi-itv0-line">
<h3><span class="section-number">4.7.5.7. </span>struct v4l2_mpeg_vbi_itv0_line<a class="headerlink" href="#struct-v4l2-mpeg-vbi-itv0-line" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>__u8</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">id</span></code></p></td>
<td><p>A line identifier value from
<a class="reference internal" href="#itv0-line-identifier-constants"><span class="std std-ref">Line Identifiers for struct v4l2_mpeg_vbi_itv0_line id field</span></a> that indicates the type of
sliced VBI data stored on this line.</p></td>
</tr>
<tr class="row-even"><td><p>__u8</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">data</span></code>[42]</p></td>
<td><p>The sliced VBI data for the line.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="line-identifiers-for-struct-v4l2-mpeg-vbi-itv0-line-id-field">
<span id="itv0-line-identifier-constants"></span><h3><span class="section-number">4.7.5.8. </span>Line Identifiers for struct v4l2_mpeg_vbi_itv0_line id field<a class="headerlink" href="#line-identifiers-for-struct-v4l2-mpeg-vbi-itv0-line-id-field" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 38%" />
<col style="width: 13%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Defined Symbol</p></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_MPEG_VBI_IVTV_TELETEXT_B</span></code></p></td>
<td><p>1</p></td>
<td><p>Refer to <a class="reference internal" href="#vbi-services2"><span class="std std-ref">Sliced VBI services</span></a> for a
description of the line payload.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_MPEG_VBI_IVTV_CAPTION_525</span></code></p></td>
<td><p>4</p></td>
<td><p>Refer to <a class="reference internal" href="#vbi-services2"><span class="std std-ref">Sliced VBI services</span></a> for a
description of the line payload.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_MPEG_VBI_IVTV_WSS_625</span></code></p></td>
<td><p>5</p></td>
<td><p>Refer to <a class="reference internal" href="#vbi-services2"><span class="std std-ref">Sliced VBI services</span></a> for a
description of the line payload.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_MPEG_VBI_IVTV_VPS</span></code></p></td>
<td><p>7</p></td>
<td><p>Refer to <a class="reference internal" href="#vbi-services2"><span class="std std-ref">Sliced VBI services</span></a> for a
description of the line payload.</p></td>
</tr>
</tbody>
</table>
<dl class="footnote brackets">
<dt class="label" id="f1"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>According to <a class="reference internal" href="biblio.html#ets300706"><span class="std std-ref">ETS 300 706</span></a> lines 6-22 of the first
field and lines 5-22 of the second field may carry Teletext data.</p>
</dd>
<dt class="label" id="f2"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>See also <a class="reference internal" href="dev-raw-vbi.html#vbi-525"><span class="std std-ref">Figure 4.2. ITU-R 525 line numbering (M/NTSC and M/PAL)</span></a> and <a class="reference internal" href="dev-raw-vbi.html#vbi-625"><span class="std std-ref">Figure 4.3. ITU-R 625 line numbering</span></a>.</p>
</dd>
</dl>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h3><a href="../../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">4.7. Sliced VBI Data Interface</a><ul>
<li><a class="reference internal" href="#querying-capabilities">4.7.1. Querying Capabilities</a></li>
<li><a class="reference internal" href="#supplemental-functions">4.7.2. Supplemental Functions</a></li>
<li><a class="reference internal" href="#sliced-vbi-format-negotiation">4.7.3. Sliced VBI Format Negotiation</a><ul>
<li><a class="reference internal" href="#struct-v4l2-sliced-vbi-format">4.7.3.1. struct v4l2_sliced_vbi_format</a></li>
<li><a class="reference internal" href="#sliced-vbi-services">4.7.3.2. Sliced VBI services</a><ul>
<li><a class="reference internal" href="#v4l2-sliced-wss-625-payload">4.7.3.2.1. V4L2_SLICED_WSS_625 payload</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#reading-and-writing-sliced-vbi-data">4.7.4. Reading and writing sliced VBI data</a><ul>
<li><a class="reference internal" href="#struct-v4l2-sliced-vbi-data">4.7.4.1. struct v4l2_sliced_vbi_data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sliced-vbi-data-in-mpeg-streams">4.7.5. Sliced VBI Data in MPEG Streams</a><ul>
<li><a class="reference internal" href="#mpeg-stream-embedded-sliced-vbi-data-format-none">4.7.5.1. MPEG Stream Embedded, Sliced VBI Data Format: NONE</a></li>
<li><a class="reference internal" href="#mpeg-stream-embedded-sliced-vbi-data-format-ivtv">4.7.5.2. MPEG Stream Embedded, Sliced VBI Data Format: IVTV</a></li>
<li><a class="reference internal" href="#struct-v4l2-mpeg-vbi-fmt-ivtv">4.7.5.3. struct v4l2_mpeg_vbi_fmt_ivtv</a></li>
<li><a class="reference internal" href="#magic-constants-for-struct-v4l2-mpeg-vbi-fmt-ivtv-magic-field">4.7.5.4. Magic Constants for struct v4l2_mpeg_vbi_fmt_ivtv magic field</a></li>
<li><a class="reference internal" href="#structs-v4l2-mpeg-vbi-itv0-and-v4l2-mpeg-vbi-itv0">4.7.5.5. structs v4l2_mpeg_vbi_itv0 and v4l2_mpeg_vbi_ITV0</a></li>
<li><a class="reference internal" href="#struct-v4l2-mpeg-vbi-itv0">4.7.5.6. struct v4l2_mpeg_vbi_ITV0</a></li>
<li><a class="reference internal" href="#struct-v4l2-mpeg-vbi-itv0-line">4.7.5.7. struct v4l2_mpeg_vbi_itv0_line</a></li>
<li><a class="reference internal" href="#line-identifiers-for-struct-v4l2-mpeg-vbi-itv0-line-id-field">4.7.5.8. Line Identifiers for struct v4l2_mpeg_vbi_itv0_line id field</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/userspace-api/media/v4l/dev-sliced-vbi.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../../_sources/userspace-api/media/v4l/dev-sliced-vbi.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>