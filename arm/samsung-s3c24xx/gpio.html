
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>S3C24XX GPIO Control &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="S3C24XX CPUfreq support" href="cpufreq.html" />
    <link rel="prev" title="HP IPAQ H1940" href="h1940.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="s3c24xx-gpio-control">
<h1>S3C24XX GPIO Control<a class="headerlink" href="#s3c24xx-gpio-control" title="Permalink to this headline">¶</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The s3c2410 kernel provides an interface to configure and
manipulate the state of the GPIO pins, and find out other
information about them.</p>
<p>There are a number of conditions attached to the configuration
of the s3c2410 GPIO system, please read the Samsung provided
data-sheet/users manual to find out the complete list.</p>
<p>See <a class="reference internal" href="../samsung/gpio.html"><span class="doc">Samsung GPIO implementation</span></a> for the core implementation.</p>
</div></blockquote>
</section>
<section id="gpiolib">
<h2>GPIOLIB<a class="headerlink" href="#gpiolib" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>With the event of the GPIOLIB in drivers/gpio, support for some
of the GPIO functions such as reading and writing a pin will
be removed in favour of this common access method.</p>
<p>Once all the extant drivers have been converted, the functions
listed below will be removed (they may be marked as __deprecated
in the near future).</p>
<p>The following functions now either have a <cite>s3c_</cite> specific variant
or are merged into gpiolib. See the definitions in
arch/arm/mach-s3c/gpio-cfg.h:</p>
<ul class="simple">
<li><p>s3c2410_gpio_setpin()       gpio_set_value() or gpio_direction_output()</p></li>
<li><p>s3c2410_gpio_getpin()       gpio_get_value() or gpio_direction_input()</p></li>
<li><p>s3c2410_gpio_getirq()       gpio_to_irq()</p></li>
<li><p>s3c2410_gpio_cfgpin()       s3c_gpio_cfgpin()</p></li>
<li><p>s3c2410_gpio_getcfg()       s3c_gpio_getcfg()</p></li>
<li><p>s3c2410_gpio_pullup()       s3c_gpio_setpull()</p></li>
</ul>
</div></blockquote>
</section>
<section id="gpiolib-conversion">
<h2>GPIOLIB conversion<a class="headerlink" href="#gpiolib-conversion" title="Permalink to this headline">¶</a></h2>
<p>If you need to convert your board or driver to use gpiolib from the phased
out s3c2410 API, then here are some notes on the process.</p>
<ol class="arabic">
<li><p>If your board is exclusively using an GPIO, say to control peripheral
power, then it will require to claim the gpio with gpio_request() before
it can use it.</p>
<p>It is recommended to check the return value, with at least WARN_ON()
during initialisation.</p>
</li>
<li><p>The s3c2410_gpio_cfgpin() can be directly replaced with s3c_gpio_cfgpin()
as they have the same arguments, and can either take the pin specific
values, or the more generic special-function-number arguments.</p></li>
<li><p>s3c2410_gpio_pullup() changes have the problem that while the
s3c2410_gpio_pullup(x, 1) can be easily translated to the
s3c_gpio_setpull(x, S3C_GPIO_PULL_NONE), the s3c2410_gpio_pullup(x, 0)
are not so easy.</p>
<p>The s3c2410_gpio_pullup(x, 0) case enables the pull-up (or in the case
of some of the devices, a pull-down) and as such the new API distinguishes
between the UP and DOWN case. There is currently no ‘just turn on’ setting
which may be required if this becomes a problem.</p>
</li>
<li><p>s3c2410_gpio_setpin() can be replaced by gpio_set_value(), the old call
does not implicitly configure the relevant gpio to output. The gpio
direction should be changed before using gpio_set_value().</p></li>
<li><p>s3c2410_gpio_getpin() is replaceable by gpio_get_value() if the pin
has been set to input. It is currently unknown what the behaviour is
when using gpio_get_value() on an output pin (s3c2410_gpio_getpin
would return the value the pin is supposed to be outputting).</p></li>
<li><p>s3c2410_gpio_getirq() should be directly replaceable with the
gpio_to_irq() call.</p></li>
</ol>
<p>The s3c2410_gpio and <cite>gpio_</cite> calls have always operated on the same gpio
numberspace, so there is no problem with converting the gpio numbering
between the calls.</p>
</section>
<section id="headers">
<h2>Headers<a class="headerlink" href="#headers" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>See arch/arm/mach-s3c/regs-gpio-s3c24xx.h for the list
of GPIO pins, and the configuration values for them. This
is included by using #include &lt;mach/regs-gpio.h&gt;</p>
</div></blockquote>
</section>
<section id="pin-numbers">
<h2>PIN Numbers<a class="headerlink" href="#pin-numbers" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Each pin has an unique number associated with it in regs-gpio.h,
e.g. S3C2410_GPA(0) or S3C2410_GPF(1). These defines are used to tell
the GPIO functions which pin is to be used.</p>
<p>With the conversion to gpiolib, there is no longer a direct conversion
from gpio pin number to register base address as in earlier kernels. This
is due to the number space required for newer SoCs where the later
GPIOs are not contiguous.</p>
</div></blockquote>
</section>
<section id="configuring-a-pin">
<h2>Configuring a pin<a class="headerlink" href="#configuring-a-pin" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The following function allows the configuration of a given pin to
be changed.</p>
<blockquote>
<div><p>void s3c_gpio_cfgpin(unsigned int pin, unsigned int function);</p>
</div></blockquote>
<p>e.g.:</p>
<blockquote>
<div><blockquote>
<div><p>s3c_gpio_cfgpin(S3C2410_GPA(0), S3C_GPIO_SFN(1));
s3c_gpio_cfgpin(S3C2410_GPE(8), S3C_GPIO_SFN(2));</p>
</div></blockquote>
<p>which would turn GPA(0) into the lowest Address line A0, and set
GPE(8) to be connected to the SDIO/MMC controller’s SDDAT1 line.</p>
</div></blockquote>
</div></blockquote>
</section>
<section id="reading-the-current-configuration">
<h2>Reading the current configuration<a class="headerlink" href="#reading-the-current-configuration" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The current configuration of a pin can be read by using standard
gpiolib function:</p>
<p>s3c_gpio_getcfg(unsigned int pin);</p>
<p>The return value will be from the same set of values which can be
passed to s3c_gpio_cfgpin().</p>
</div></blockquote>
</section>
<section id="configuring-a-pull-up-resistor">
<h2>Configuring a pull-up resistor<a class="headerlink" href="#configuring-a-pull-up-resistor" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>A large proportion of the GPIO pins on the S3C2410 can have weak
pull-up resistors enabled. This can be configured by the following
function:</p>
<blockquote>
<div><p>void s3c_gpio_setpull(unsigned int pin, unsigned int to);</p>
</div></blockquote>
<p>Where the to value is S3C_GPIO_PULL_NONE to set the pull-up off,
and S3C_GPIO_PULL_UP to enable the specified pull-up. Any other
values are currently undefined.</p>
</div></blockquote>
</section>
<section id="getting-and-setting-the-state-of-a-pin">
<h2>Getting and setting the state of a PIN<a class="headerlink" href="#getting-and-setting-the-state-of-a-pin" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>These calls are now implemented by the relevant gpiolib calls, convert
your board or driver to use gpiolib.</p>
</div></blockquote>
</section>
<section id="getting-the-irq-number-associated-with-a-pin">
<h2>Getting the IRQ number associated with a PIN<a class="headerlink" href="#getting-the-irq-number-associated-with-a-pin" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>A standard gpiolib function can map the given pin number to an IRQ
number to pass to the IRQ system.</p>
<blockquote>
<div><p>int gpio_to_irq(unsigned int pin);</p>
</div></blockquote>
<p>Note, not all pins have an IRQ.</p>
</div></blockquote>
</section>
<section id="author">
<h2>Author<a class="headerlink" href="#author" title="Permalink to this headline">¶</a></h2>
<p>Ben Dooks, 03 October 2004
Copyright 2004 Ben Dooks, Simtec Electronics</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">S3C24XX GPIO Control</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#gpiolib">GPIOLIB</a></li>
<li><a class="reference internal" href="#gpiolib-conversion">GPIOLIB conversion</a></li>
<li><a class="reference internal" href="#headers">Headers</a></li>
<li><a class="reference internal" href="#pin-numbers">PIN Numbers</a></li>
<li><a class="reference internal" href="#configuring-a-pin">Configuring a pin</a></li>
<li><a class="reference internal" href="#reading-the-current-configuration">Reading the current configuration</a></li>
<li><a class="reference internal" href="#configuring-a-pull-up-resistor">Configuring a pull-up resistor</a></li>
<li><a class="reference internal" href="#getting-and-setting-the-state-of-a-pin">Getting and setting the state of a PIN</a></li>
<li><a class="reference internal" href="#getting-the-irq-number-associated-with-a-pin">Getting the IRQ number associated with a PIN</a></li>
<li><a class="reference internal" href="#author">Author</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/arm/samsung-s3c24xx/gpio.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/arm/samsung-s3c24xx/gpio.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>