
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>2.18. V4L2 flash functions and data structures &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2.19. V4L2 Media Controller functions and data structures" href="v4l2-mc.html" />
    <link rel="prev" title="2.17. V4L2 DV Timings functions" href="v4l2-dv-timings.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="v4l2-flash-functions-and-data-structures">
<h1><span class="section-number">2.18. </span>V4L2 flash functions and data structures<a class="headerlink" href="#v4l2-flash-functions-and-data-structures" title="Permalink to this headline">¶</a></h1>
<dl class="type">
<dt id="c.v4l2_flash_ctrl_data">
struct <code class="sig-name descname">v4l2_flash_ctrl_data</code><a class="headerlink" href="#c.v4l2_flash_ctrl_data" title="Permalink to this definition">¶</a></dt>
<dd><p>flash control initialization data, filled basing on the features declared by the LED flash class driver in the v4l2_flash_config</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct v4l2_flash_ctrl_data {
    struct v4l2_ctrl_config config;
    u32 cid;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">config</span></code></dt><dd><p>initialization data for a control</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">cid</span></code></dt><dd><p>contains v4l2 flash control id if the config
field was initialized, 0 otherwise</p>
</dd>
</dl>
</div>
<dl class="type">
<dt id="c.v4l2_flash_ops">
struct <code class="sig-name descname">v4l2_flash_ops</code><a class="headerlink" href="#c.v4l2_flash_ops" title="Permalink to this definition">¶</a></dt>
<dd><p>V4L2 flash operations</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct v4l2_flash_ops {
    int (*external_strobe_set)(struct v4l2_flash *v4l2_flash, bool enable);
    enum led_brightness (*intensity_to_led_brightness) (struct v4l2_flash *v4l2_flash, s32 intensity);
    s32 (*led_brightness_to_intensity) (struct v4l2_flash *v4l2_flash, enum led_brightness);
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">external_strobe_set</span></code></dt><dd><p>Setup strobing the flash by hardware pin state
assertion.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">intensity_to_led_brightness</span></code></dt><dd><p>Convert intensity to brightness in a device
specific manner</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">led_brightness_to_intensity</span></code></dt><dd><p>convert brightness to intensity in a device
specific manner.</p>
</dd>
</dl>
</div>
<dl class="type">
<dt id="c.v4l2_flash_config">
struct <code class="sig-name descname">v4l2_flash_config</code><a class="headerlink" href="#c.v4l2_flash_config" title="Permalink to this definition">¶</a></dt>
<dd><p>V4L2 Flash sub-device initialization data</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct v4l2_flash_config {
    char dev_name[32];
    struct led_flash_setting intensity;
    u32 flash_faults;
    unsigned int has_external_strobe:1;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">dev_name</span></code></dt><dd><p>the name of the media entity,
unique in the system</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">intensity</span></code></dt><dd><p>non-flash strobe constraints for the LED</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">flash_faults</span></code></dt><dd><p>bitmask of flash faults that the LED flash class
device can report; corresponding LED_FAULT* bit
definitions are available in the header file
&lt;linux/led-class-flash.h&gt;</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">has_external_strobe</span></code></dt><dd><p>external strobe capability</p>
</dd>
</dl>
</div>
<dl class="type">
<dt id="c.v4l2_flash">
struct <code class="sig-name descname">v4l2_flash</code><a class="headerlink" href="#c.v4l2_flash" title="Permalink to this definition">¶</a></dt>
<dd><p>Flash sub-device context</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct v4l2_flash {
    struct led_classdev_flash *fled_cdev;
    struct led_classdev *iled_cdev;
    const struct v4l2_flash_ops *ops;
    struct v4l2_subdev sd;
    struct v4l2_ctrl_handler hdl;
    struct v4l2_ctrl **ctrls;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">fled_cdev</span></code></dt><dd><p>LED flash class device controlled by this sub-device</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">iled_cdev</span></code></dt><dd><p>LED class device representing indicator LED associated
with the LED flash class device</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ops</span></code></dt><dd><p>V4L2 specific flash ops</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">sd</span></code></dt><dd><p>V4L2 sub-device</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">hdl</span></code></dt><dd><p>flash controls handler</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ctrls</span></code></dt><dd><p>array of pointers to controls, whose values define
the sub-device state</p>
</dd>
</dl>
</div>
<dl class="function">
<dt id="c.v4l2_subdev_to_v4l2_flash">
struct <a class="reference internal" href="#c.v4l2_flash" title="v4l2_flash">v4l2_flash</a> * <code class="sig-name descname">v4l2_subdev_to_v4l2_flash</code><span class="sig-paren">(</span>struct <a class="reference internal" href="v4l2-subdev.html#c.v4l2_subdev" title="v4l2_subdev">v4l2_subdev</a><em> *sd</em><span class="sig-paren">)</span><a class="headerlink" href="#c.v4l2_subdev_to_v4l2_flash" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <a class="reference internal" href="#c.v4l2_flash" title="v4l2_flash"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">v4l2_flash</span></code></a> from the <a class="reference internal" href="v4l2-subdev.html#c.v4l2_subdev" title="v4l2_subdev"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">v4l2_subdev</span></code></a> embedded on it.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">v4l2_subdev</span> <span class="pre">*sd</span></code></dt><dd><p>pointer to <a class="reference internal" href="v4l2-subdev.html#c.v4l2_subdev" title="v4l2_subdev"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">v4l2_subdev</span></code></a></p>
</dd>
</dl>
</div>
<dl class="function">
<dt id="c.v4l2_ctrl_to_v4l2_flash">
struct <a class="reference internal" href="#c.v4l2_flash" title="v4l2_flash">v4l2_flash</a> * <code class="sig-name descname">v4l2_ctrl_to_v4l2_flash</code><span class="sig-paren">(</span>struct <a class="reference internal" href="v4l2-controls.html#c.v4l2_ctrl" title="v4l2_ctrl">v4l2_ctrl</a><em> *c</em><span class="sig-paren">)</span><a class="headerlink" href="#c.v4l2_ctrl_to_v4l2_flash" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <a class="reference internal" href="#c.v4l2_flash" title="v4l2_flash"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">v4l2_flash</span></code></a> from the <a class="reference internal" href="v4l2-controls.html#c.v4l2_ctrl" title="v4l2_ctrl"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">v4l2_ctrl</span></code></a> embedded on it.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">v4l2_ctrl</span> <span class="pre">*c</span></code></dt><dd><p>pointer to <a class="reference internal" href="v4l2-controls.html#c.v4l2_ctrl" title="v4l2_ctrl"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">v4l2_ctrl</span></code></a></p>
</dd>
</dl>
</div>
<dl class="function">
<dt id="c.v4l2_flash_init">
struct <a class="reference internal" href="#c.v4l2_flash" title="v4l2_flash">v4l2_flash</a> * <code class="sig-name descname">v4l2_flash_init</code><span class="sig-paren">(</span>struct <a class="reference internal" href="../infrastructure.html#c.device" title="device">device</a><em> *dev</em>, struct fwnode_handle<em> *fwn</em>, struct led_classdev_flash<em> *fled_cdev</em>, const struct <a class="reference internal" href="#c.v4l2_flash_ops" title="v4l2_flash_ops">v4l2_flash_ops</a><em> *ops</em>, struct <a class="reference internal" href="#c.v4l2_flash_config" title="v4l2_flash_config">v4l2_flash_config</a><em> *config</em><span class="sig-paren">)</span><a class="headerlink" href="#c.v4l2_flash_init" title="Permalink to this definition">¶</a></dt>
<dd><p>initialize V4L2 flash led sub-device</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">device</span> <span class="pre">*dev</span></code></dt><dd><p>flash device, e.g. an I2C device</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">fwnode_handle</span> <span class="pre">*fwn</span></code></dt><dd><p>fwnode_handle of the LED, may be NULL if the same as device’s</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">led_classdev_flash</span> <span class="pre">*fled_cdev</span></code></dt><dd><p>LED flash class device to wrap</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">v4l2_flash_ops</span> <span class="pre">*ops</span></code></dt><dd><p>V4L2 Flash device ops</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">v4l2_flash_config</span> <span class="pre">*config</span></code></dt><dd><p>initialization data for V4L2 Flash sub-device</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Create V4L2 Flash sub-device wrapping given LED subsystem device.
The ops pointer is stored by the V4L2 flash framework. No
references are held to config nor its contents once this function
has returned.</p>
<p><strong>Return</strong></p>
<p>A valid pointer, or, when an error occurs, the return
value is encoded using ERR_PTR(). Use IS_ERR() to check and
PTR_ERR() to obtain the numeric return value.</p>
</div>
<dl class="function">
<dt id="c.v4l2_flash_indicator_init">
struct <a class="reference internal" href="#c.v4l2_flash" title="v4l2_flash">v4l2_flash</a> * <code class="sig-name descname">v4l2_flash_indicator_init</code><span class="sig-paren">(</span>struct <a class="reference internal" href="../infrastructure.html#c.device" title="device">device</a><em> *dev</em>, struct fwnode_handle<em> *fwn</em>, struct led_classdev<em> *iled_cdev</em>, struct <a class="reference internal" href="#c.v4l2_flash_config" title="v4l2_flash_config">v4l2_flash_config</a><em> *config</em><span class="sig-paren">)</span><a class="headerlink" href="#c.v4l2_flash_indicator_init" title="Permalink to this definition">¶</a></dt>
<dd><p>initialize V4L2 indicator sub-device</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">device</span> <span class="pre">*dev</span></code></dt><dd><p>flash device, e.g. an I2C device</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">fwnode_handle</span> <span class="pre">*fwn</span></code></dt><dd><p>fwnode_handle of the LED, may be NULL if the same as device’s</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">led_classdev</span> <span class="pre">*iled_cdev</span></code></dt><dd><p>LED flash class device representing the indicator LED</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">v4l2_flash_config</span> <span class="pre">*config</span></code></dt><dd><p>initialization data for V4L2 Flash sub-device</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Create V4L2 Flash sub-device wrapping given LED subsystem device.
The ops pointer is stored by the V4L2 flash framework. No
references are held to config nor its contents once this function
has returned.</p>
<p><strong>Return</strong></p>
<p>A valid pointer, or, when an error occurs, the return
value is encoded using ERR_PTR(). Use IS_ERR() to check and
PTR_ERR() to obtain the numeric return value.</p>
</div>
<dl class="function">
<dt id="c.v4l2_flash_release">
void <code class="sig-name descname">v4l2_flash_release</code><span class="sig-paren">(</span>struct <a class="reference internal" href="#c.v4l2_flash" title="v4l2_flash">v4l2_flash</a><em> *v4l2_flash</em><span class="sig-paren">)</span><a class="headerlink" href="#c.v4l2_flash_release" title="Permalink to this definition">¶</a></dt>
<dd><p>release V4L2 Flash sub-device</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">v4l2_flash</span> <span class="pre">*v4l2_flash</span></code></dt><dd><p>the V4L2 Flash sub-device to release</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Release V4L2 Flash sub-device.</p>
</div>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/driver-api/media/v4l2-flash-led-class.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/driver-api/media/v4l2-flash-led-class.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>