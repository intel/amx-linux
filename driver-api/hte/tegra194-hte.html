
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>HTE Kernel provider driver &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Kernel subsystem documentation" href="../../subsystem-apis.html" />
    <link rel="prev" title="The Linux Hardware Timestamping Engine (HTE)" href="hte.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="hte-kernel-provider-driver">
<h1>HTE Kernel provider driver<a class="headerlink" href="#hte-kernel-provider-driver" title="Permalink to this headline">¶</a></h1>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>The Nvidia tegra194 HTE provider driver implements two GTE
(Generic Timestamping Engine) instances: 1) GPIO GTE and 2) LIC
(Legacy Interrupt Controller) IRQ GTE. Both GTE instances get the
timestamp from the system counter TSC which has 31.25MHz clock rate, and the
driver converts clock tick rate to nanoseconds before storing it as timestamp
value.</p>
</section>
<section id="gpio-gte">
<h2>GPIO GTE<a class="headerlink" href="#gpio-gte" title="Permalink to this headline">¶</a></h2>
<p>This GTE instance timestamps GPIO in real time. For that to happen GPIO
needs to be configured as input. The always on (AON) GPIO controller instance
supports timestamping GPIOs in real time and it has 39 GPIO lines. The GPIO GTE
and AON GPIO controller are tightly coupled as it requires very specific bits
to be set in GPIO config register before GPIO GTE can be used, for that GPIOLIB
adds two optional APIs as below. The GPIO GTE code supports both kernel
and userspace consumers. The kernel space consumers can directly talk to HTE
subsystem while userspace consumers timestamp requests go through GPIOLIB CDEV
framework to HTE subsystem.</p>
<p>See <a class="reference internal" href="../gpio/index.html#c.gpiod_enable_hw_timestamp_ns" title="gpiod_enable_hw_timestamp_ns"><code class="xref c c-func docutils literal notranslate"><span class="pre">gpiod_enable_hw_timestamp_ns()</span></code></a> and <a class="reference internal" href="../gpio/index.html#c.gpiod_disable_hw_timestamp_ns" title="gpiod_disable_hw_timestamp_ns"><code class="xref c c-func docutils literal notranslate"><span class="pre">gpiod_disable_hw_timestamp_ns()</span></code></a>.</p>
<p>For userspace consumers, GPIO_V2_LINE_FLAG_EVENT_CLOCK_HTE flag must be
specified during IOCTL calls. Refer to <code class="docutils literal notranslate"><span class="pre">tools/gpio/gpio-event-mon.c</span></code>, which
returns the timestamp in nanoseconds.</p>
</section>
<section id="lic-legacy-interrupt-controller-irq-gte">
<h2>LIC (Legacy Interrupt Controller) IRQ GTE<a class="headerlink" href="#lic-legacy-interrupt-controller-irq-gte" title="Permalink to this headline">¶</a></h2>
<p>This GTE instance timestamps LIC IRQ lines in real time. There are 352 IRQ
lines which this instance can add timestamps to in real time. The hte
devicetree binding described at <code class="docutils literal notranslate"><span class="pre">Documentation/devicetree/bindings/timestamp</span></code>
provides an example of how a consumer can request an IRQ line. Since it is a
one-to-one mapping with IRQ GTE provider, consumers can simply specify the IRQ
number that they are interested in. There is no userspace consumer support for
this GTE instance in the HTE framework.</p>
<p>The provider source code of both IRQ and GPIO GTE instances is located at
<code class="docutils literal notranslate"><span class="pre">drivers/hte/hte-tegra194.c</span></code>. The test driver
<code class="docutils literal notranslate"><span class="pre">drivers/hte/hte-tegra194-test.c</span></code> demonstrates HTE API usage for both IRQ
and GPIO GTE.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">HTE Kernel provider driver</a><ul>
<li><a class="reference internal" href="#description">Description</a></li>
<li><a class="reference internal" href="#gpio-gte">GPIO GTE</a></li>
<li><a class="reference internal" href="#lic-legacy-interrupt-controller-irq-gte">LIC (Legacy Interrupt Controller) IRQ GTE</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/driver-api/hte/tegra194-hte.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/driver-api/hte/tegra194-hte.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>