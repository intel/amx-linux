
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Introduction &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Using GPIO Lines in Linux" href="using-gpio.html" />
    <link rel="prev" title="General Purpose Input/Output (GPIO)" href="index.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<section id="gpio-interfaces">
<h2>GPIO Interfaces<a class="headerlink" href="#gpio-interfaces" title="Permalink to this headline">¶</a></h2>
<p>The documents in this directory give detailed instructions on how to access
GPIOs in drivers, and how to write a driver for a device that provides GPIOs
itself.</p>
<p>Due to the history of GPIO interfaces in the kernel, there are two different
ways to obtain and use GPIOs:</p>
<blockquote>
<div><ul class="simple">
<li><p>The descriptor-based interface is the preferred way to manipulate GPIOs,
and is described by all the files in this directory excepted <a class="reference internal" href="legacy.html"><span class="doc">Legacy GPIO Interfaces</span></a>.</p></li>
<li><p>The legacy integer-based interface which is considered deprecated (but still
usable for compatibility reasons) is documented in <a class="reference internal" href="legacy.html"><span class="doc">Legacy GPIO Interfaces</span></a>.</p></li>
</ul>
</div></blockquote>
<p>The remainder of this document applies to the new descriptor-based interface.
<a class="reference internal" href="legacy.html"><span class="doc">Legacy GPIO Interfaces</span></a> contains the same information applied to the legacy
integer-based interface.</p>
</section>
<section id="what-is-a-gpio">
<h2>What is a GPIO?<a class="headerlink" href="#what-is-a-gpio" title="Permalink to this headline">¶</a></h2>
<p>A “General Purpose Input/Output” (GPIO) is a flexible software-controlled
digital signal. They are provided from many kinds of chips, and are familiar
to Linux developers working with embedded and custom hardware. Each GPIO
represents a bit connected to a particular pin, or “ball” on Ball Grid Array
(BGA) packages. Board schematics show which external hardware connects to
which GPIOs. Drivers can be written generically, so that board setup code
passes such pin configuration data to drivers.</p>
<p>System-on-Chip (SOC) processors heavily rely on GPIOs. In some cases, every
non-dedicated pin can be configured as a GPIO; and most chips have at least
several dozen of them. Programmable logic devices (like FPGAs) can easily
provide GPIOs; multifunction chips like power managers, and audio codecs
often have a few such pins to help with pin scarcity on SOCs; and there are
also “GPIO Expander” chips that connect using the I2C or SPI serial buses.
Most PC southbridges have a few dozen GPIO-capable pins (with only the BIOS
firmware knowing how they’re used).</p>
<p>The exact capabilities of GPIOs vary between systems. Common options:</p>
<blockquote>
<div><ul class="simple">
<li><p>Output values are writable (high=1, low=0). Some chips also have
options about how that value is driven, so that for example only one
value might be driven, supporting “wire-OR” and similar schemes for the
other value (notably, “open drain” signaling).</p></li>
<li><p>Input values are likewise readable (1, 0). Some chips support readback
of pins configured as “output”, which is very useful in such “wire-OR”
cases (to support bidirectional signaling). GPIO controllers may have
input de-glitch/debounce logic, sometimes with software controls.</p></li>
<li><p>Inputs can often be used as IRQ signals, often edge triggered but
sometimes level triggered. Such IRQs may be configurable as system
wakeup events, to wake the system from a low power state.</p></li>
<li><p>Usually a GPIO will be configurable as either input or output, as needed
by different product boards; single direction ones exist too.</p></li>
<li><p>Most GPIOs can be accessed while holding spinlocks, but those accessed
through a serial bus normally can’t. Some systems support both types.</p></li>
</ul>
</div></blockquote>
<p>On a given board each GPIO is used for one specific purpose like monitoring
MMC/SD card insertion/removal, detecting card write-protect status, driving
a LED, configuring a transceiver, bit-banging a serial bus, poking a hardware
watchdog, sensing a switch, and so on.</p>
</section>
<section id="common-gpio-properties">
<h2>Common GPIO Properties<a class="headerlink" href="#common-gpio-properties" title="Permalink to this headline">¶</a></h2>
<p>These properties are met through all the other documents of the GPIO interface
and it is useful to understand them, especially if you need to define GPIO
mappings.</p>
<section id="active-high-and-active-low">
<h3>Active-High and Active-Low<a class="headerlink" href="#active-high-and-active-low" title="Permalink to this headline">¶</a></h3>
<p>It is natural to assume that a GPIO is “active” when its output signal is 1
(“high”), and inactive when it is 0 (“low”). However in practice the signal of a
GPIO may be inverted before is reaches its destination, or a device could decide
to have different conventions about what “active” means. Such decisions should
be transparent to device drivers, therefore it is possible to define a GPIO as
being either active-high (“1” means “active”, the default) or active-low (“0”
means “active”) so that drivers only need to worry about the logical signal and
not about what happens at the line level.</p>
</section>
<section id="open-drain-and-open-source">
<h3>Open Drain and Open Source<a class="headerlink" href="#open-drain-and-open-source" title="Permalink to this headline">¶</a></h3>
<p>Sometimes shared signals need to use “open drain” (where only the low signal
level is actually driven), or “open source” (where only the high signal level is
driven) signaling. That term applies to CMOS transistors; “open collector” is
used for TTL. A pullup or pulldown resistor causes the high or low signal level.
This is sometimes called a “wire-AND”; or more practically, from the negative
logic (low=true) perspective this is a “wire-OR”.</p>
<p>One common example of an open drain signal is a shared active-low IRQ line.
Also, bidirectional data bus signals sometimes use open drain signals.</p>
<p>Some GPIO controllers directly support open drain and open source outputs; many
don’t. When you need open drain signaling but your hardware doesn’t directly
support it, there’s a common idiom you can use to emulate it with any GPIO pin
that can be used as either an input or an output:</p>
<blockquote>
<div><p><strong>LOW</strong>: <code class="docutils literal notranslate"><span class="pre">gpiod_direction_output(gpio,</span> <span class="pre">0)</span></code> … this drives the signal and
overrides the pullup.</p>
<p><strong>HIGH</strong>: <code class="docutils literal notranslate"><span class="pre">gpiod_direction_input(gpio)</span></code> … this turns off the output, so
the pullup (or some other device) controls the signal.</p>
</div></blockquote>
<p>The same logic can be applied to emulate open source signaling, by driving the
high signal and configuring the GPIO as input for low. This open drain/open
source emulation can be handled transparently by the GPIO framework.</p>
<p>If you are “driving” the signal high but gpiod_get_value(gpio) reports a low
value (after the appropriate rise time passes), you know some other component is
driving the shared signal low. That’s not necessarily an error. As one common
example, that’s how I2C clocks are stretched:  a slave that needs a slower clock
delays the rising edge of SCK, and the I2C master adjusts its signaling rate
accordingly.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction</a><ul>
<li><a class="reference internal" href="#gpio-interfaces">GPIO Interfaces</a></li>
<li><a class="reference internal" href="#what-is-a-gpio">What is a GPIO?</a></li>
<li><a class="reference internal" href="#common-gpio-properties">Common GPIO Properties</a><ul>
<li><a class="reference internal" href="#active-high-and-active-low">Active-High and Active-Low</a></li>
<li><a class="reference internal" href="#open-drain-and-open-source">Open Drain and Open Source</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/driver-api/gpio/intro.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/driver-api/gpio/intro.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>