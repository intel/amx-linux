
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>ACPI video extensions &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Probing devices in other D states than 0" href="non-d0-probe.html" />
    <link rel="prev" title="Low Power Idle Table (LPIT)" href="lpit.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="acpi-video-extensions">
<h1>ACPI video extensions<a class="headerlink" href="#acpi-video-extensions" title="Permalink to this headline">¶</a></h1>
<p>This driver implement the ACPI Extensions For Display Adapters for
integrated graphics devices on motherboard, as specified in ACPI 2.0
Specification, Appendix B, allowing to perform some basic control like
defining the video POST device, retrieving EDID information or to
setup a video output, etc.  Note that this is an ref. implementation
only.  It may or may not work for your integrated video device.</p>
<p>The ACPI video driver does 3 things regarding backlight control.</p>
<section id="export-a-sysfs-interface-for-user-space-to-control-backlight-level">
<h2>Export a sysfs interface for user space to control backlight level<a class="headerlink" href="#export-a-sysfs-interface-for-user-space-to-control-backlight-level" title="Permalink to this headline">¶</a></h2>
<p>If the ACPI table has a video device, and acpi_backlight=vendor kernel
command line is not present, the driver will register a backlight device
and set the required backlight operation structure for it for the sysfs
interface control. For every registered class device, there will be a
directory named acpi_videoX under /sys/class/backlight.</p>
<p>The backlight sysfs interface has a standard definition here:
Documentation/ABI/stable/sysfs-class-backlight.</p>
<p>And what ACPI video driver does is:</p>
<dl class="simple">
<dt>actual_brightness:</dt><dd><p>on read, control method _BQC will be evaluated to
get the brightness level the firmware thinks it is at;</p>
</dd>
<dt>bl_power:</dt><dd><p>not implemented, will set the current brightness instead;</p>
</dd>
<dt>brightness:</dt><dd><p>on write, control method _BCM will run to set the requested brightness level;</p>
</dd>
<dt>max_brightness:</dt><dd><p>Derived from the _BCL package(see below);</p>
</dd>
<dt>type:</dt><dd><p>firmware</p>
</dd>
</dl>
<p>Note that ACPI video backlight driver will always use index for
brightness, actual_brightness and max_brightness. So if we have
the following _BCL package:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Method (_BCL, 0, NotSerialized)
{
        Return (Package (0x0C)
        {
                0x64,
                0x32,
                0x0A,
                0x14,
                0x1E,
                0x28,
                0x32,
                0x3C,
                0x46,
                0x50,
                0x5A,
                0x64
        })
}
</pre></div>
</div>
<p>The first two levels are for when laptop are on AC or on battery and are
not used by Linux currently. The remaining 10 levels are supported levels
that we can choose from. The applicable index values are from 0 (that
corresponds to the 0x0A brightness value) to 9 (that corresponds to the
0x64 brightness value) inclusive. Each of those index values is regarded
as a “brightness level” indicator. Thus from the user space perspective
the range of available brightness levels is from 0 to 9 (max_brightness)
inclusive.</p>
</section>
<section id="notify-user-space-about-hotkey-event">
<h2>Notify user space about hotkey event<a class="headerlink" href="#notify-user-space-about-hotkey-event" title="Permalink to this headline">¶</a></h2>
<p>There are generally two cases for hotkey event reporting:</p>
<ol class="lowerroman">
<li><p>For some laptops, when user presses the hotkey, a scancode will be
generated and sent to user space through the input device created by
the keyboard driver as a key type input event, with proper remap, the
following key code will appear to user space:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>EV_KEY, KEY_BRIGHTNESSUP
EV_KEY, KEY_BRIGHTNESSDOWN
etc.
</pre></div>
</div>
</li>
</ol>
<p>For this case, ACPI video driver does not need to do anything(actually,
it doesn’t even know this happened).</p>
<ol class="lowerroman" start="2">
<li><p>For some laptops, the press of the hotkey will not generate the
scancode, instead, firmware will notify the video device ACPI node
about the event. The event value is defined in the ACPI spec. ACPI
video driver will generate an key type input event according to the
notify value it received and send the event to user space through the
input device it created:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>event</p></th>
<th class="head"><p>keycode</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x86</p></td>
<td><p>KEY_BRIGHTNESSUP</p></td>
</tr>
<tr class="row-odd"><td><p>0x87</p></td>
<td><p>KEY_BRIGHTNESSDOWN</p></td>
</tr>
<tr class="row-even"><td><p>etc.</p></td>
<td></td>
</tr>
</tbody>
</table>
</div></blockquote>
</li>
</ol>
<p>so this would lead to the same effect as case i) now.</p>
<p>Once user space tool receives this event, it can modify the backlight
level through the sysfs interface.</p>
</section>
<section id="change-backlight-level-in-the-kernel">
<h2>Change backlight level in the kernel<a class="headerlink" href="#change-backlight-level-in-the-kernel" title="Permalink to this headline">¶</a></h2>
<p>This works for machines covered by case ii) in Section 2. Once the driver
received a notification, it will set the backlight level accordingly. This does
not affect the sending of event to user space, they are always sent to user
space regardless of whether or not the video module controls the backlight level
directly. This behaviour can be controlled through the brightness_switch_enabled
module parameter as documented in admin-guide/kernel-parameters.rst. It is
recommended to disable this behaviour once a GUI environment starts up and
wants to have full control of the backlight level.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">ACPI video extensions</a><ul>
<li><a class="reference internal" href="#export-a-sysfs-interface-for-user-space-to-control-backlight-level">Export a sysfs interface for user space to control backlight level</a></li>
<li><a class="reference internal" href="#notify-user-space-about-hotkey-event">Notify user space about hotkey event</a></li>
<li><a class="reference internal" href="#change-backlight-level-in-the-kernel">Change backlight level in the kernel</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/firmware-guide/acpi/video_extension.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/firmware-guide/acpi/video_extension.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>