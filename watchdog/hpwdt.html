
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>HPE iLO NMI Watchdog Driver &#8212; The Linux Kernel 6.2.0-rc4+ documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Mellanox watchdog drivers" href="mlx-wdt.html" />
    <link rel="prev" title="Linux Watchdog Support" href="index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="hpe-ilo-nmi-watchdog-driver">
<h1>HPE iLO NMI Watchdog Driver<a class="headerlink" href="#hpe-ilo-nmi-watchdog-driver" title="Permalink to this headline">¶</a></h1>
<section id="for-ilo-based-proliant-servers">
<h2>for iLO based ProLiant Servers<a class="headerlink" href="#for-ilo-based-proliant-servers" title="Permalink to this headline">¶</a></h2>
<p>Last reviewed: 08/20/2018</p>
<blockquote>
<div><p>The HPE iLO NMI Watchdog driver is a kernel module that provides basic
watchdog functionality and handler for the iLO “Generate NMI to System”
virtual button.</p>
<p>All references to iLO in this document imply it also works on iLO2 and all
subsequent generations.</p>
<p>Watchdog functionality is enabled like any other common watchdog driver. That
is, an application needs to be started that kicks off the watchdog timer. A
basic application exists in tools/testing/selftests/watchdog/ named
watchdog-test.c. Simply compile the C file and kick it off. If the system
gets into a bad state and hangs, the HPE ProLiant iLO timer register will
not be updated in a timely fashion and a hardware system reset (also known as
an Automatic Server Recovery (ASR)) event will occur.</p>
<p>The hpwdt driver also has the following module parameters:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 84%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>soft_margin</p></td>
<td><p>allows the user to set the watchdog timer value.
Default value is 30 seconds.</p></td>
</tr>
<tr class="row-even"><td><p>timeout</p></td>
<td><p>an alias of soft_margin.</p></td>
</tr>
<tr class="row-odd"><td><p>pretimeout</p></td>
<td><p>allows the user to set the watchdog pretimeout value.
This is the number of seconds before timeout when an
NMI is delivered to the system. Setting the value to
zero disables the pretimeout NMI.
Default value is 9 seconds.</p></td>
</tr>
<tr class="row-even"><td><p>nowayout</p></td>
<td><p>basic watchdog parameter that does not allow the timer to
be restarted or an impending ASR to be escaped.
Default value is set when compiling the kernel. If it is set
to “Y”, then there is no way of disabling the watchdog once
it has been started.</p></td>
</tr>
<tr class="row-odd"><td><p>kdumptimeout</p></td>
<td><p>Minimum timeout in seconds to apply upon receipt of an NMI
before calling panic. (-1) disables the watchdog.  When value
is &gt; 0, the timer is reprogrammed with the greater of
value or current timeout value.</p></td>
</tr>
</tbody>
</table>
<dl class="simple">
<dt>NOTE:</dt><dd><p>More information about watchdog drivers in general, including the ioctl
interface to /dev/watchdog can be found in
<a class="reference internal" href="watchdog-api.html"><span class="doc">The Linux Watchdog driver API</span></a> and Documentation/IPMI.txt.</p>
</dd>
</dl>
<p>Due to limitations in the iLO hardware, the NMI pretimeout if enabled,
can only be set to 9 seconds.  Attempts to set pretimeout to other
non-zero values will be rounded, possibly to zero.  Users should verify
the pretimeout value after attempting to set pretimeout or timeout.</p>
<p>Upon receipt of an NMI from the iLO, the hpwdt driver will initiate a
panic. This is to allow for a crash dump to be collected.  It is incumbent
upon the user to have properly configured the system for kdump.</p>
<p>The default Linux kernel behavior upon panic is to print a kernel tombstone
and loop forever.  This is generally not what a watchdog user wants.</p>
<dl class="simple">
<dt>For those wishing to learn more please see:</dt><dd><p><a class="reference internal" href="../admin-guide/kdump/kdump.html"><span class="doc">Documentation for Kdump - The kexec-based Crash Dumping Solution</span></a>
<a class="reference internal" href="../admin-guide/kernel-parameters.html"><span class="doc">The kernel’s command-line parameters</span></a> (panic=)
Your Linux Distribution specific documentation.</p>
</dd>
</dl>
<p>If the hpwdt does not receive the NMI associated with an expiring timer,
the iLO will proceed to reset the system at timeout if the timer hasn’t
been updated.</p>
</div></blockquote>
<p>–</p>
<blockquote>
<div><p>The HPE iLO NMI Watchdog Driver and documentation were originally developed
by Tom Mingarelli.</p>
</div></blockquote>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.2.0-rc4-6.2.0-rc4+</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">HPE iLO NMI Watchdog Driver</a><ul>
<li><a class="reference internal" href="#for-ilo-based-proliant-servers">for iLO based ProLiant Servers</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/watchdog/hpwdt.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/watchdog/hpwdt.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>